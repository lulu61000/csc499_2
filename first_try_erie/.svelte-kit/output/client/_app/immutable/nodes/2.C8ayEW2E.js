import{s as $1,o as j1}from"../chunks/scheduler.BvLojk_z.js";import{S as z1,i as q1}from"../chunks/index.3yJoD6ZP.js";let Ii={};async function sc(t,e){return new Promise((n,r)=>{var s=window.speechSynthesis,a=new SpeechSynthesisUtterance(t.speech);(e==null?void 0:e.speechRate)!==void 0?a.rate=e==null?void 0:e.speechRate:(t==null?void 0:t.speechRate)!==void 0&&(a.rate=t==null?void 0:t.speechRate),s.speak(a),a.onend=()=>{n()}})}async function vp(t){await sc({speech:"Stopped.",speechRate:t==null?void 0:t.speechRate})}async function W1(t){await sc({speech:"Paused.",speechRate:t==null?void 0:t.speechRate})}async function H1(t){await sc({speech:"Resumeing",speechRate:t==null?void 0:t.speechRate})}const Y1=["piano","pianoElec","violin","metal","guitar","hithat","snare","highKick","lowKick","clap"],_p=["piano","pianoElec","violin","metal","guitar"],bp=["hithat","snare","highKick","lowKick","clap"],Ps=[{octave:0,c:16.35,cs:17.32,d:18.35,ds:19.45,e:20.6,f:21.83,fs:23.12},{octave:1,gf:23.12,g:24.5,af:25.96,a:27.5,bf:29.14,b:30.87,c:32.7,cs:34.65,d:36.71,ds:38.89,e:41.2,f:43.65,fs:46.25},{octave:2,gf:46.25,g:49,af:51.91,a:55,bf:58.27,b:61.74,c:65.41,cs:69.3,d:73.42,ds:77.78,e:82.41,f:87.31,fs:92.5},{octave:3,gf:92.5,g:98,af:103.83,a:110,bf:116.54,b:123.47,c:130.81,cs:138.59,d:146.83,ds:155.56,e:164.81,f:174.61,fs:185},{octave:4,gf:185,g:196,af:207.65,a:220,bf:233.08,b:246.94,c:261.63,cs:277.18,d:293.66,ds:311.13,e:329.63,f:349.23,fs:369.99},{octave:5,gf:369.99,g:392,af:415.3,a:440,bf:466.16,b:493.88,c:523.25,cs:554.37,d:587.33,ds:622.25,e:659.25,f:698.46,fs:739.99},{octave:6,gf:739.99,g:783.99,af:830.61,a:880,bf:932.33,b:987.77,c:1046.5,cs:1108.73,d:1174.66,ds:1244.51,e:1318.51,f:1396.91,fs:1479.98},{octave:7,gf:1479.98,g:1567.98,af:1661.22,a:1760,bf:1864.66,b:1975.53,c:2093,cs:2217.46,d:2349.32,ds:2489.02,e:2637.02,f:2793.83,fs:2959.96}],ws=["gf","g","af","a","bf","b","c","cs","d","ds","e","f","fs"],G1={gf:-600,g:-500,af:-400,a:-300,bf:-200,b:-100,c:0,cs:100,d:200,ds:300,e:400,f:500,fs:600};function wp(t,e){let n=5e3,r;for(const s of ws){let a=Math.abs(e[s]-t);a<n&&(n=a,r=s)}return{note_name:r,prev_note:ws[ws.indexOf(r)-1],next_note:ws[ws.indexOf(r)+1],note_freq:e[r],detune:G1[r]}}function K1(t){let e;for(const n of Ps)(n.octave==0&&n.c<=t&&t<n.fs||n.octave==7&&n.gf<=t&&t<=n.fs||n.gf<=t&&t<n.fs)&&(e=n);return e!==void 0?wp(t,e).note_freq:(console.warn("Frequence out of scope. Max possible frequency is 2959.96 and min possible frequency is 16.35."),null)}function tf(t,e){var r,s;let n;for(const a of Ps)(a.octave==0&&a.c<=t&&t<a.fs||a.octave==7&&a.gf<=t&&t<=a.fs||a.gf<=t&&t<a.fs)&&(n=a);if(n!==void 0){let a=wp(t,n);if(e!=null&&e.round)return{octave:n.octave,original_freq:t,freq:a.note_freq,note:a.note_name,detune:a.detune};{let o=a.detune,u=a.note_freq-t,l=0;if(u<0){let c=n[a.prev_note];a.prev_note||(c=(r=Ps[n.octave-1])==null?void 0:r.f),l=Math.round(-100*Math.abs(u/(c-a.note_freq)))+o,c||(l=o)}else if(u>0){let c=n[a.next_note];a.next_note||(c=(s=Ps[n.octave+1])==null?void 0:s.g),l=Math.round(100*Math.abs(u/(c-a.note_freq)))+o,c||(l=o)}else l=o;return{octave:n.octave,freq:t,detune:l}}}else return console.warn("Frequence out of scope. Max possible frequency is 2959.96 and min possible frequency is 16.35."),null}async function Oa(t,e,n,r){var a;let s={};if(_p.includes(e)){for(const o of Ps){let l=await(await fetch(`${r||""}audio_sample/${e}_c${o.octave}.mp3`)).arrayBuffer(),c=await t.decodeAudioData(l);s[`C${o.octave}`]=c}s.multiNote=!0}else if(bp.includes(e))s=await ef(t,`${r||""}audio_sample/${e}.mp3`),s.multiNote=!1;else if(n[e])if((a=n[e].sample)!=null&&a.mono)try{s=await ef(t,n[e].sample.mono),s.multiNote=!1}catch(o){console.error(o)}else try{s=await Q1(t,n[e].sample),s.multiNote=!0}catch(o){console.error(o)}else console.warn(`The instrument "${e}" is not supported or sampled.`);return s}async function Q1(t,e){let n={},r=Object.keys(e);r.every(J1)||console.error("A sampling note must be 'C' in octave 0 to 7");for(const s of r){let o=await(await fetch(e[s])).arrayBuffer(),u=await t.decodeAudioData(o);n[s]=u}return n}async function ef(t,e){let n={},s=await(await fetch(e)).arrayBuffer(),a=await t.decodeAudioData(s);return n.mono=a,n}function J1(t){return t.match(/^[C][0-7]$/)}function ln(t){return Array.from(new Set(t))}function P(t){return JSON.parse(JSON.stringify(t))}function Vr(...t){for(let e of t)if(e!==void 0)return e;return t[t.length-1]}function yr(t,e,n){let r=[];n&&(e=e+1);for(let s=t;s<e;s++)r.push(s);return r}function ge(t,e){let n=Math.pow(10,-e);return Math.round(t*n)/n}const xp="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),X1=xp.length-1;function ti(t){t||(t=6);let e=[];for(let n=0;n<t;n++){let r=Math.round(Math.random()*X1);e.push(xp[r])}return e.join("")}function Z1(...t){for(const e of t)if(e!==void 0)return e;return t[t.length-1]}function qs(t,e){return typeof t=="number"&&typeof e=="number"||(t==null?void 0:t.constructor.name)===Date.name&&(e==null?void 0:e.constructor.name)===Date.name?t-e:t!=null&&t.localeCompare?t.localeCompare(e):t>e||0}function tv(t,e){return typeof t=="number"&&typeof e=="number"||(t==null?void 0:t.constructor.name)===Date.name&&(e==null?void 0:e.constructor.name)===Date.name?e-t:e!=null&&e.localeCompare?e.localeCompare(t):e>t||0}const ev=.5,nv=2,iv=.1,rv=.5,sv=.4;function Sp(t,e,n){if(e){if(n){let r=[],s=ge(e.interval,-2),a=e.band;a=ge(a,-2);let o=s-a,u=Math.floor(n/s),l=0;e.playAtTime0===void 0&&(e.playAtTime0=!0),e.playAtTime0&&(r.push({tick:a}),l+=a);for(let d=0;d<u;d++)r.push({pause:o}),r.push({tick:a}),l+=o+a;n>l&&r.push({pause:n-l});let c=nu(t,"default");c.frequency.value=150,e.pitch&&(c.frequency.value=e.pitch),e.oscType&&(c.type=e.oscType);let h=t.createGain();c.connect(h),h.connect(t.destination),h.gain.setValueAtTime(0,t.currentTime);let f=0;for(const d of r)d.tick?(h.gain.setTargetAtTime(e.loudness||sv,t.currentTime+f,.015),f+=d.tick):d.pause&&(h.gain.setTargetAtTime(0,t.currentTime+f,.015),f+=d.pause);return c}}else return}const Ws="FM",io="AM",nf=220,rf=440,av=1,ov=100;function uv(t,e){let n=new Vs(t,e.type||Ws);return n.generate(e),n}class Vs{constructor(e,n){this.ctx=e,this.frequency=new lv(this),this.onended,this.type=n}generate(e){this.type===Ws?this.generateFM(e):this.type===io&&this.generateAM(e)}generateFM(e){this.initDef=e,this.carrier=this.ctx.createOscillator(),this.carrierPitch=e.carrierPitch!==void 0?e.carrierPitch:nf,this.carrier.frequency.value=this.carrierPitch,this.carrier.type=e.carrierType||"sine",this.carrierType=e.carrierType||"sine",e.carrierDetune&&(this.carrierDetune=e.carrierDetune,this.carrier.detune.value=e.carrierDetune),this.modulator=this.ctx.createOscillator(),this.modulator.type=e.modulatorType||"sine",this.modulatorType=e.modulatorType||"sine",this.modulatorGain=this.ctx.createGain(),this.modulatorVolume=e.modulatorVolume!==void 0?e.modulatorVolume:ov,this.modulatorGain.gain.value=this.modulatorVolume,e.modulatorPitch!==void 0?this.modulatorPitch=e.modulatorPitch:e.modulation!==void 0?(this.modulation=e.modulation,this.modulatorPitch=this.modulatorVolume/this.modulation):e.harmonicity!==void 0?this.modulatorPitch=e.harmonicity*this.carrierPitch:this.carrierPitch!==void 0?this.modulatorPitch=this.carrierPitch:this.modulatorPitch=rf,this.modulator.frequency.value=this.modulatorPitch,this.envelope=this.ctx.createGain(),this.attackTime=e.attackTime||.1,this.releaseTime=e.releaseTime||.1,this.sustain=e.sustain||.8,this.decayTime=e.decayTime||.2,this.modulator.connect(this.modulatorGain),this.modulatorGain.connect(this.carrier.frequency),this.carrier.connect(this.envelope)}generateAM(e){this.initDef=e,this.carrier=this.ctx.createOscillator(),this.carrierPitch=e.carrierPitch!==void 0?e.carrierPitch:nf,this.carrier.frequency.value=this.carrierPitch,this.carrier.type=e.carrierType||"sine",this.carrierType=e.carrierType||"sine",e.carrierDetune&&(this.carrierDetune=e.carrierDetune,this.carrier.detune.value=e.carrierDetune),this.carrierVolume=e.carrierVolume||1,this.modulator=this.ctx.createOscillator(),this.modulator.type=e.modulatorType||"sine",this.modulatorType=e.modulatorType||"sine",this.modulatorGain=this.ctx.createGain(),e.modulation!==void 0?(this.modulation=e.modulation,this.modulatorVolume=(this.carrierVolume||1)*this.modulation):this.modulatorVolume=e.modulatorVolume!==void 0?e.modulatorVolume:av,this.modulatorGain.gain.value=this.modulatorVolume,e.modulatorPitch!==void 0?this.modulatorPitch=e.modulatorPitch:e.harmonicity!==void 0?this.modulatorPitch=e.harmonicity*this.carrierPitch:this.carrierPitch!==void 0?this.modulatorPitch=this.carrierPitch:this.modulatorPitch=rf,this.modulator.frequency.value=this.modulatorPitch,this.envelope=this.ctx.createGain(),this.attackTime=e.attackTime||.1,this.releaseTime=e.releaseTime||.05,this.sustain=e.sustain||.8,this.decayTime=e.decayTime||.1,this.modulator.connect(this.modulatorGain),this.modulatorGain.connect(this.carrier.frequency),this.carrier.connect(this.envelope)}connect(e){this.envelope.connect(e)}start(e){this.carrier.start(e),this.modulator.start(e)}stop(e){this.carrier.onended=this.onended,this.carrier.stop(e+this.attackTime+this.releaseTime),this.modulator.stop(e+this.attackTime+this.releaseTime)}}class lv{constructor(e){this.value=440,this.automationRate="a-rate",this.maxValue=22050,this.minValue=-22055,this.synther=e}setValueAtTime(e,n){this.synther.carrier.frequency.setValueAtTime(e,n)}setTargetAtTime(e,n){this.synther.carrier.frequency.setTargetAtTime(e,n)}}const cv="whiteNoise",Ip="pinkNoise",Tp="brownNoise",hv=[cv,Ip,Tp];function fv(t,e,n,r){const s=t.sampleRate*n,a=new AudioBuffer({length:s,sampleRate:t.sampleRate}),o=a.getChannelData(0);let u={p0:0,p1:0,p2:0,p3:0,p4:0,p5:0,p6:0,o:0};for(let c=0;c<s;c++)e===Ip?(dv(u),o[c]=u.o):e===Tp?(pv(u),o[c]=u.o):o[c]=ac();const l=t.createBufferSource();return l.buffer=a,l}function ac(){return Math.random()*2-1}function dv(t){let e=ac();t.p0=.99886*t.p0+e*.0555179,t.p1=.99332*t.p1+e*.0750759,t.p2=.969*t.p2+e*.153852,t.p3=.8665*t.p3+e*.3104856,t.p4=.55*t.p4+e*.5329522,t.p5=-.7616*t.p5-e*.016898,t.o=t.p0+t.p1+t.p2+t.p3+t.p4+t.p5+t.p6+e*.5362,t.o*=.11,t.p6=e*.115926}function pv(t){let e=ac();t.o=(t.p0+.02*e)/1.02,t.p0=t.o,t.o*=3.5}class Ui{constructor(e){this.ctx=e,this.filter=e.createBiquadFilter(),this.destination=this.filter}initialize(e){this.filter.gain.setValueAtTime(1,e)}connect(e){this.filter.connect(e)}disconnect(e){this.filter.disconnect(e)}}class mv extends Ui{constructor(e){super(e),this.filter.type="lowpass",this.destination=this.filter}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class yv extends Ui{constructor(e){super(e),this.filter.type="highpass",this.destination=this.filter}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class gv extends Ui{constructor(e){super(e),this.filter.type="bandpass",this.destination=this.filter}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class vv extends Ui{constructor(e){super(e),this.filter.type="lowshelf",this.destination=this.filter,this.useGain=!0}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class _v extends Ui{constructor(e){super(e),this.filter.type="highshelf",this.destination=this.filter,this.useGain=!0}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class bv extends Ui{constructor(e){super(e),this.filter.type="peaking",this.destination=this.filter,this.useGain=!0}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class wv extends Ui{constructor(e){super(e),this.filter.type="notch",this.destination=this.filter}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}class xv extends Ui{constructor(e){super(e),this.filter.type="allpass",this.destination=this.filter}connect(e){this.destination.connect(e)}disconnect(e){this.destination.disconnect(e)}}function gi(t,e,n){var r,s,a,o,u;t.useGain&&(n>0?t.filter.gain.linearRampToValueAtTime(((r=e==null?void 0:e.others)==null?void 0:r.biquadGain)||1,n):t.filter.gain.setValueAtTime(((s=e==null?void 0:e.others)==null?void 0:s.biquadGain)||1,n)),((a=e==null?void 0:e.others)==null?void 0:a.biquadPitch)!==void 0&&(n>0?t.filter.frequency.linearRampToValueAtTime(e.others.biquadPitch||1,n):t.filter.frequency.setValueAtTime(e.others.biquadPitch||1,n)),((o=e==null?void 0:e.others)==null?void 0:o.biquadQ)!==void 0&&(n>0?t.filter.Q.linearRampToValueAtTime(e.others.biquadQ||1,n):t.filter.Q.setValueAtTime(e.others.biquadQ||1,n)),((u=e==null?void 0:e.others)==null?void 0:u.biquadDetune)!==void 0&&(n>0?t.filter.detune.linearRampToValueAtTime(e.others.biquadDetune||1,n):t.filter.detune.setValueAtTime(e.others.biquadDetune||1,n))}function vi(t,e,n,r){var s,a,o;t.useGain&&t.filter.gain.setValueAtTime((e==null?void 0:e.others.biquadGain)||1,n+r),((s=e==null?void 0:e.others)==null?void 0:s.biquadPitch)!==void 0&&t.filter.frequency.setValueAtTime(e.others.biquadPitch||1,n+r),((a=e==null?void 0:e.others)==null?void 0:a.biquadQ)!==void 0&&t.filter.Q.setValueAtTime(e.others.biquadQ||1,n+r),((o=e==null?void 0:e.others)==null?void 0:o.biquadDetune)!==void 0&&t.filter.detune.setValueAtTime(e.others.biquadDetune||1,n+r)}class Sv{constructor(e){this.ctx=e,this.compressor=e.createDynamicsCompressor(),this.destination=this.compressor}initialize(){this.compressor.attack.value=20,this.compressor.knee.value=40,this.compressor.ratio.value=18,this.compressor.release.value=.25,this.compressor.threshold.value=-50}finisher(){}connect(e){this.compressor.connect(e)}disconnect(e){this.compressor.disconnect(e)}}function Iv(t,e,n){e.others.dcAttack!==void 0&&t.compressor.attack.linearRampToValueAtTime(e.others.dcAttack||1,n),e.others.dcKnee!==void 0&&t.compressor.knee.linearRampToValueAtTime(e.others.dcKnee||1,n),e.others.dcRatio!==void 0&&t.compressor.ratio.linearRampToValueAtTime(e.others.dcRatio||1,n),e.others.dcReduction!==void 0&&t.compressor.release.linearRampToValueAtTime(e.others.dcReduction||1,n),e.others.dcThreshold!==void 0&&t.compressor.threshold.linearRampToValueAtTime(e.others.dcThreshold||1,n)}function Tv(t,e,n,r){}class Av{constructor(e){this.ctx=e,this.distortion=e.createWaveShaper(),this.destination=this.distortion}initialize(e,n){this.distortion.curve=oc(n)}finisher(){}connect(e){this.distortion.connect(e)}disconnect(e){this.distortion.disconnect(e)}}function oc(t){const e=typeof t=="number"?t:50,n=44100,r=new Float32Array(n),s=Math.PI/180;for(let a=0;a<n;a++){const o=a*2/n-1;r[a]=(3+e)*o*10*s/(Math.PI+e*Math.abs(o))}return r}function Cv(t,e,n){e.others.distortion!==void 0&&(t.distortion.curve=oc(e.others.distortion))}function kv(t,e,n,r){t.distortion.curve=oc(50)}class Mv{constructor(e){this.ctx=e,this.attackTime=.1,this.releaseTime=.1,this.gainer=e.createGain(),this.destination=this.gainer}initialize(e){this.gainer.gain.cancelScheduledValues(e),this.gainer.gain.setValueAtTime(0,e)}finisher(e,n){this.gainer.gain.linearRampToValueAtTime(0,(e||0)+(n||1)-this.releaseTime)}connect(e){this.gainer.connect(e)}disconnect(e){this.gainer.disconnect(e)}}function Nv(t,e,n){var r;t.gainer.gain.linearRampToValueAtTime(((r=e.others)==null?void 0:r.gain2)||1,n+t.attackTime)}function Ev(t,e,n,r){t.gainer.gain.linearRampToValueAtTime(0,(n||0)+(r||1)-t.releaseTime)}const Ur="nominal",as="ordinal",rr="quantitative",os="temporal",Mi="static",uc="positive",lc="negative",at="time",Ti="time2",hr="duration",De="tapCount",Fe="tapSpeed",us="postReverb",Zt="pitch",ha="detune",fr="loudness",on="pan",Ap="speech",oe="speechBefore",tn="speechAfter",ue="timbre",ve="repeat",Cp="modulation",kp="harmonicity",Ov=0,Dv=207.65,Fv=1600,Bv=3e3,Mp=-1200,Np=1200,Rv=0,Lv=10,Ep=-1,Op=1,Dp=0,Pv=20,Vv=.5,Uv=4,$v=25,Fp=0,jv=5,zv=7,qv=1.75,Ye={[at]:{min:0},[Zt]:{max:Fv,min:Dv},[ha]:{max:Mp,min:Np},[fr]:{max:Lv,min:Rv},[on]:{max:Op,min:Ep},[hr]:{max:Pv,min:Dp},[us]:{max:Uv,min:0},[De]:{max:$v,min:0},[Fe]:{max:jv,min:Fp}},ie={[at]:{max:1/0,min:Ov},[Zt]:{max:Bv,min:0},[ha]:{max:Mp,min:Np},[fr]:{max:1/0,min:-1/0},[on]:{max:Op,min:Ep},[hr]:{max:1/0,min:Dp},[us]:{max:1/0,min:0},[De]:{max:1/0,min:0},[Fe]:{max:zv,min:Fp}},sf=[at,Ti],Wv=[Ap,oe,tn],Bp=[De,Fe],Rp=[at,Ti,Zt,ha,fr,on,hr,Ap,oe,tn,us,De,Fe,Cp,kp],Hv="sqrt",Yv="pow",Gv="log",Kv="symlog",Us="relative",pl="simultaneous",ml=.4,Qv=.3,af=.2,yl=1,Lp=2,Pp=4,Vp="middle",of="start",Jv=[ve,at,ue,hr,De,Fe,Zt,ha,fr,on,Cp,kp,us],uf="skip",Xv="nonskip",ro="sequence",Mr="overlay",Zv=[!0,!1,"abrupt","linear","exponential"],Ai={gainer:{filter:Mv,encoder:Nv,finisher:Ev},lowpass:{filter:mv,encoder:gi,finisher:vi},highpass:{filter:yv,encoder:gi,finisher:vi},bandpass:{filter:gv,encoder:gi,finisher:vi},lowshelf:{filter:vv,encoder:gi,finisher:vi},highshelf:{filter:_v,encoder:gi,finisher:vi},peaking:{filter:bv,encoder:gi,finisher:vi},notch:{filter:wv,encoder:gi,finisher:vi},allpass:{filter:xv,encoder:gi,finisher:vi},defaultCompressor:{filter:Sv,encoder:Iv,finisher:Tv},distortion:{filter:Av,encoder:Cv,finisher:kv}},tu={gain2:{type:fr},biquadDetune:{type:ha},biquadPitch:{type:Zt}};function eu(t){let e=new CustomEvent("erieOnPlayTone",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"tone-started"}});document.body.dispatchEvent(n)}function Nr(t){let e=new CustomEvent("erieOnFinishTone",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"tone-finished"}});document.body.dispatchEvent(n)}function Up(t){let e=new CustomEvent("erieOnPlaySpeech",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"speech-started"}});document.body.dispatchEvent(n)}function $p(t){let e=new CustomEvent("erieOnFinishSpeech",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"speech-finished"}});document.body.dispatchEvent(n)}function t_(t){let e=new CustomEvent("erieOnPlayQueue",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"started"}});document.body.dispatchEvent(n)}function e_(t){let e=new CustomEvent("erieOnFinishQueue",{detail:t});document.body.dispatchEvent(e);let n=new CustomEvent("erieOnStatusChange",{detail:{status:"finished"}});document.body.dispatchEvent(n)}function so(t,e){typeof document=="object"&&document.body.dispatchEvent(new CustomEvent("erieOnNotePlay",{detail:{type:t,note:e}}))}function ao(t,e){typeof document=="object"&&document.body.dispatchEvent(new CustomEvent("erieOnNoteStop",{detail:{type:t,note:e}}))}let Da;function Fa(){return new AudioContext}function oo(t){return t.currentTime}function nu(t,e,n,r,s,a,o){var u,l,c;if(!e||e==="default")return t.createOscillator();if(hv.includes(e)){let h=o||a.duration;return a.detune>0&&(h+=h*(a.detune/600)),fv(t,e,h*1.1)}else if(_p.includes(e)){let h=tf(a.pitch||ae,{}),f=n[e]["C"+h.octave],d=t.createBufferSource();return d.buffer=f,d.detune.value=h.detune,d}else if(bp.includes(e)){let h=n[e].mono,f=t.createBufferSource();return f.buffer=h,f}else if((u=Object.keys(s||{}))!=null&&u.includes(e)){let h=new Float32Array(s[e].real),f=new Float32Array(s[e].imag);const d=t.createPeriodicWave(h,f,{disableNormalization:s[e].disableNormalization||!1});let m=t.createOscillator();return m.setPeriodicWave(d),m}else if((l=Object.keys(n||{}))!=null&&l.includes(e)){let h;if(n[e].multiNote){let d=tf(a.pitch,{});h=n[e]["C"+(d==null?void 0:d.octave)]}else h=n[e].mono;let f=t.createBufferSource();return f.buffer=h,n[e].multiNote&&(f.detune.value=note.detune),f}else if((c=Object.keys(r||{}))!=null&&c.includes(e))return uv(t,r[e])}const ae=523.25,$r="stopped",fa="tone",iu="speech";let yt,Ie;const n_={abrupt:"setValueAtTime",linear:"linearRampToValueAtTime",linear:"exponentialRampToValueAtTime"};async function lf(t,e,n,r,s,a,o){Ie=void 0,yt={type:fa,player:t};const u=t.createGain();u.connect(t.destination),u.gain.value=0;let l=e.sort((f,d)=>f.time+f.duration-(d.time+d.duration));l[0].isFirst=!0,l[l.length-1].isLast=!0,n.subpart=!0;let c=l[l.length-1].time+l[l.length-1].duration,h=ti();return eu({sid:h}),n!=null&&n.isRecorded&&await rn(300),new Promise((f,d)=>{let m=(n==null?void 0:n.context_time)!==void 0?n.context_time:oo(t);const p=Sp(t,n.tick,c);for(let g of l){if(Ie===$r){f();break}const y=nu(t);y.connect(u),y.start(m+g.time),y.stop(m+g.time+.01),y.onended=async()=>{var _;n!=null&&n.falseTiming&&(yt==null?void 0:yt.type)===iu&&((_=yt==null?void 0:yt.player)==null||_.cancel()),await cc(t,g,n,r,s,a,o),g.isLast&&(n!=null&&n.isRecorded&&await rn(300),Nr({sid:h}),f())}}p&&(p.start(m+.01),p.stop(m+c+.01))})}async function cf(t,e,n,r,s,a){Ie=void 0,yt={type:fa,player:t};let o={};n.ramp&&Object.keys(n.ramp||{}).forEach(y=>{let _=n_[n.ramp[y]];y===De||y===Fe?o.tap=_:o[y]=_});let u=e.sort((y,_)=>y.time+y.duration-(_.time+_.duration));u[0].isFirst=!0,u[u.length-1].isLast=!0;let l=u[u.length-1].time+u[u.length-1].duration,c={},h={},f={};for(const y of a)Ai[y]?(f[y]=new Ai[y].filter(t),c[y]=Ai[y].encoder,h[y]=Ai[y].finisher):Ii[y]&&(f[y]=new Ii[y].filter(t),c[y]=Ii[y].encoder,h[y]=Ii[y].finisher);let d=t.destination;for(const y of a){let _=f[y];_&&(_.connect(d),_.initialize(t.currentTime,l),d=_.destination)}const m=t.createGain();m.connect(d);const p=t.createStereoPanner();p.connect(m);let g=ti();return eu({sid:g}),n!=null&&n.isRecorded&&await rn(300),new Promise((y,_)=>{const b=nu(t,n==null?void 0:n.instrument_type,null,r,s,null,l);b.connect(p);let A,S=(n==null?void 0:n.context_time)!==void 0?n.context_time:oo(t);for(let x of u){x.isFirst?((b==null?void 0:b.constructor.name)===OscillatorNode.name?b.frequency.setValueAtTime(x.pitch||ae,S+x.time):(b==null?void 0:b.constructor.name)===Vs.name&&(b.frequency.setValueAtTime(x.pitch||ae,S+x.time),b.type===Ws&&x.modulation!==void 0?b.modulator.frequency.setValueAtTime(b.modulatorVolume/x.modulation,S+x.time):b.type===io&&x.modulation!==void 0&&b.modulatorGain.gain.setValueAtTime((x.loudness||1)*x.modulation,S+x.time),x.harmonicity!==void 0&&x.harmonicity>0&&b.modulator.frequency.setValueAtTime((x.pitch||b.carrierPitch||ae)*x.harmonicity,S+x.time),b.envelope.gain.cancelScheduledValues(S+x.time),b.envelope.gain.setValueAtTime(0,S+x.time),b.envelope.gain.linearRampToValueAtTime(1,S+x.time+(b.attackTime||0)),b.decayTime&&b.envelope.gain.linearRampToValueAtTime(b.sustain||1,S+x.time+(b.attackTime||0)+(b.decayTime||0))),x.detune&&b.detune&&b.detune.setValueAtTime(x.detune||0,S+x.time),x.loudness!==void 0&&m.gain.setValueAtTime(x.loudness,S+x.time),x.pan!==void 0&&p.pan.setTargetAtTime(x.pan,S+x.time,.35),A=S+x.time):((b==null?void 0:b.constructor.name)===OscillatorNode.name?o.pitch?b.frequency[o.pitch](x.pitch||ae,S+x.time):b.frequency.linearRampToValueAtTime(x.pitch||ae,S+x.time):(b==null?void 0:b.constructor.name)===Vs.name&&(o.pitch?b.frequency[o.pitch](x.pitch||ae,S+x.time):b.frequency.linearRampToValueAtTime(x.pitch||ae,S+x.time),b.type===Ws&&x.modulation!==void 0?o.modulation?b.modulator.frequency[o.modulation](b.modulatorVolume/x.modulation,S+x.time):b.modulator.frequency.linearRampToValueAtTime(b.modulatorVolume/x.modulation,S+x.time):b.type===io&&x.modulation!==void 0&&(o.modulation?b.modulatorGain.gain[o.modulation]((x.loudness||1)*x.modulation,S+x.time):b.modulatorGain.gain.linearRampToValueAtTime((x.loudness||1)*x.modulation,S+x.time)),x.harmonicity!==void 0&&x.harmonicity>0&&(o.harmonicity?b.modulator.frequency[o.harmonicity]((x.pitch||b.carrierPitch||ae)*x.harmonicity,S+x.time):b.modulator.frequency.linearRampToValueAtTime((x.pitch||b.carrierPitch||ae)*x.harmonicity,S+x.time))),x.loudness!==void 0&&(o.loudness?m.gain[o.loudness](x.loudness<=0?1e-10:x.loudness,S+x.time):m.gain.linearRampToValueAtTime(x.loudness,S+x.time)),x.pan!==void 0&&p.pan.linearRampToValueAtTime(x.pan,S+x.time),x.isLast&&(m.gain.linearRampToValueAtTime(0,S+x.time+.15),(b==null?void 0:b.constructor.name)===Vs.name&&(b.envelope.gain.cancelScheduledValues(S+x.time),b.envelope.gain.setValueAtTime(1,S+x.time+x.duration),b.envelope.gain.linearRampToValueAtTime(0,S+x.time+(x.duration||0)+(b.attackTime||0)+(b.releaseTime||0)))),x.detune&&b.detune&&(o.detune?b.detune[o.detune](x.detune||0,S+x.time):b.detune.linearRampToValueAtTime(x.detune||0,S+x.time)));for(const C of a){let T=c[C],N=h[C];T&&T(f[C],x,S+x.time,o),N&&N(f[C],x,S+x.time,x.duration+x.postReverb+(b.attackTime||0)+(b.releaseTime||0),o)}}const I=Sp(t,n.tick,l);I&&(I.start(A),I.stop(S+l)),so("tone",u[0]),b.start(A),n!=null&&n.isRecorded?(m.gain.setValueAtTime(0,S+l+.3),b.stop(S+l+.3)):b.stop(S+l),b.onended=x=>{yt=void 0,Ie=void 0,ao("tone",u[0]),Nr({sid:g}),y()}})}async function cc(t,e,n,r,s,a,o){var l,c;if(n!=null&&n.subpart&&Ie===$r)return;n!=null&&n.subpart||(Ie=void 0),Ie=void 0,yt={type:fa,player:t};let u;if(n.subpart||(u=ti(),eu({sid:u}),n!=null&&n.isRecorded&&await rn(300)),e.tap!==void 0&&((c=(l=e.tap)==null?void 0:l.pattern)==null?void 0:c.constructor.name)==="Array"){let h=(n==null?void 0:n.context_time)!==void 0?n.context_time:oo(t),f=P(e),d=1,m=0,p=0;e.tap.pattern.length==0&&(await rn((e.duration||.2)*1e3),n!=null&&n.isRecorded&&await rn(300),Nr({sid:u})),so("tone",e);for(const g of e.tap.pattern)if(d===1?(f.duration=g,g>0&&await hf(t,h+m,f,n,r,s,a,o),d=0):(await rn(g*1e3),d=1),m+=g,p++,p==e.tap.pattern.length){n.subpart||(n!=null&&n.isRecorded&&await rn(300),Nr({sid:u}));return}ao("tone",e)}else{let h=(n==null?void 0:n.context_time)!==void 0?n.context_time:oo(t);so("tone",e),await hf(t,h,e,n,r,s,a,o),ao("tone",e),n.subpart||Nr({sid:u});return}}async function hf(t,e,n,r,s,a,o,u){let l={},c={},h={};for(const p of u)Ai[p]?(h[p]=new Ai[p].filter(t),l[p]=Ai[p].encoder,c[p]=Ai[p].finisher):Ii[p]&&(h[p]=new Ii[p].filter(t),l[p]=Ii[p].encoder,c[p]=Ii[p].finisher);let f=t.destination;for(const p of u){let g=h[p];g&&(g.connect(f),g.initialize(e,n.duration),f=g.destination)}const d=t.createGain();d.connect(f);const m=t.createStereoPanner();return m.connect(d),new Promise((p,g)=>{let y=n.timbre||(r==null?void 0:r.instrument_type);const _=nu(t,y,s,a,o,n);_.connect(m),(_==null?void 0:_.constructor.name)===OscillatorNode.name?_.frequency.setValueAtTime(n.pitch||_.carrierPitch||ae,e):(_==null?void 0:_.constructor.name)===Vs.name&&(_.frequency.setValueAtTime(n.pitch||_.carrierPitch||ae,e),_.type===Ws&&n.modulation!==void 0&&n.modulation>0?_.modulator.frequency.setValueAtTime(_.modulatorVolume/n.modulation,e):_.type===io&&n.modulation!==void 0&&n.modulation>0&&_.modulatorGain.gain.setValueAtTime((n.loudness||1)*n.modulation,e),n.harmonicity!==void 0&&n.harmonicity>0&&(_.modulator.frequency.cancelScheduledValues(e),_.modulator.frequency.setValueAtTime((n.pitch||_.carrierPitch||ae)*n.harmonicity,e)),_.envelope.gain.cancelScheduledValues(e),_.envelope.gain.setValueAtTime(0,e),_.envelope.gain.linearRampToValueAtTime(1,e+(_.attackTime||0)),_.decayTime&&_.envelope.gain.linearRampToValueAtTime(_.sustain||1,e+n.time+(_.attackTime||0)+(_.decayTime||0)),_.envelope.gain.setValueAtTime(_.sustain||1,e+n.duration),_.envelope.gain.linearRampToValueAtTime(0,e+n.duration+(_.attackTime||0)+(_.releaseTime||0))),n.detune&&_.detune&&_.detune.setValueAtTime(n.detune||0,e),n.loudness!==void 0&&d.gain.setValueAtTime(n.loudness,e),n.postReverb?(d.gain.setTargetAtTime(0,e+n.duration*.95,.015),d.gain.setTargetAtTime(.45,e+n.duration,.015),d.gain.exponentialRampToValueAtTime(.02,e+(n.duration+n.postReverb)*.95)):n.postReverb=0;for(const b of u){let A=l[b],S=c[b];A&&A(h[b],n,e),S&&S(h[b],n,e+n.time,e+(n.duration+n.postReverb+(_.attackTime||0)+(_.releaseTime||0)))}d.gain.setTargetAtTime(0,e+(n.duration+n.postReverb+(_.attackTime||0)+(_.releaseTime||0))*.95,.015),n.pan!==void 0&&m.pan.setValueAtTime(n.pan,e),_.onended=b=>{p()},_.start(e),_.stop(e+n.duration+n.postReverb)})}async function jp(t,e){if(e!=null&&e.subpart&&Ie===$r)return;e!=null&&e.subpart||(Ie=void 0);let n=ti();return e.subpart||Up({sound:t,sid:n}),new Promise((r,s)=>{var o;Da||(Da=window.speechSynthesis);var a=new SpeechSynthesisUtterance(t.speech);(e==null?void 0:e.speechRate)!==void 0?a.rate=e==null?void 0:e.speechRate:(t==null?void 0:t.speechRate)!==void 0&&(a.rate=t==null?void 0:t.speechRate),(t==null?void 0:t.pitch)!==void 0&&(a.pitch=t.pitch),(t==null?void 0:t.loudness)!==void 0&&(a.volume=t.loudness),t!=null&&t.language?a.lang=r_.includes(t.language)?t.language:(o=document==null?void 0:document.documentElement)==null?void 0:o.lang:a.lang=document.documentElement.lang,so("speech",t),Da.speak(a),yt={type:iu,player:Da},a.onend=()=>{window.removeEventListener("keypress",stop),yt=void 0,Ie=void 0,ao("speech",t),e.subpart||$p({sid:n}),r()}})}async function Nu(t,e,n,r,s,a,o){Ie=void 0;let u=P(n);u.subpart=!0;for(const l of e){if(Ie===$r)break;let c=ti();l.speech?(Up({sound:l,sid:c}),await jp(l,u),$p({sid:c})):(eu({sid:c}),u!=null&&u.isRecorded&&await rn(300),await cc(t,l,u,r,s,a,o),u!=null&&u.isRecorded&&await rn(300),Nr({sid:c}))}Ie=void 0}let gl=new Map;function i_(t,e){if(typeof window<"u"){let n=function(r){r.key=="x"&&(Ie=$r,t.state=$r,(yt==null?void 0:yt.type)===fa?yt.player.close():(yt==null?void 0:yt.type)===iu&&yt.player.cancel(),vp(e))};window.addEventListener("keypress",n),gl.set("stop-event",n)}}function Eu(){if(typeof window<"u"){let t=gl.get("stop-event");window.removeEventListener("keypress",t),gl.delete("stop-event")}}function rn(t,e){return new Promise(n=>{setTimeout(n,t)})}const r_=["ar-SA","bn-BD","bn-IN","cs-CZ","da-DK","de-AT","de-CH","de-DE","el-GR","en-AU","en-CA","en-GB","en-IE","en-IN","en-NZ","en-US","en-ZA","es-AR","es-CL","es-CO","es-ES","es-MX","es-US","fi-FI","fr-BE","fr-CA","fr-CH","fr-FR","he-IL","hi-IN","hu-HU","id-ID","it-CH","it-IT","ja-JP","ko-KR","nl-BE","nl-NL","no-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sv-SE","ta-IN","ta-LK","th-TH","tr-TR","zh-CN","zh-HK","zh-TW"];function s_(t){try{return JSON.parse(t),!0}catch{return!1}}const a_=/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^\t'"\s\\]*(?:\s+[^\t'"\s\\]+)*)\s*(?:\t\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^\t\'"\s\\]*(?:\s+[^\t'"\s\\]+)*)\s*)*$/gi;function o_(t){return t.match(a_)}const u_=/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/gi;function l_(t){return t.match(u_)}function ot(t){return t==null?void 0:t.constructor.name}function vl(t){return t.every(e=>(e==null?void 0:e.constructor.name)==="Number")?rr:as}function c_(t){return ot(t)!=="String"?null:(t.includes("datum.")?"datum":"d")==="datum"?Function("datum","return ("+t+");"):Function("d","return ("+t+");")}const _i=.1;function Ou(t,e,n,r,s,a,o){if(t!==void 0&&e===De){!n&&!o?n=af:!n&&o&&o.converter&&(n=yl);let u;n=ge(n,-2),(r==null?void 0:r.length)!==void 0?u=r==null?void 0:r.length:(r==null?void 0:r.rate)!==void 0?u=n*(r==null?void 0:r.rate):u=n*ml,u=ge(u,-2);let l=[],c=0,h=`[${n}, ${u}] x ${t} `;for(let f=0;f<t;f++)l.push(n),c+=n,f<t-1?(c+=u,l.push(u)):(c+=_i,l.push(_i));return o!=null&&o.converter&&(l=l.map(o==null?void 0:o.converter)),{pattern:l,totalLength:c,patternString:h}}else if(t!==void 0&&e===Fe){!n&&!o?n=Lp:!n&&o&&o.converter&&(n=Pp);let u=ge(t*n,0),l=u*s,c,h=[],f=0;if(u==0)c=n,h=[0,c],f+=c;else if(u==1)!a||a===Vp?(c=(n-s)/2,c=ge(c,-2),h=[0,c,s,c],f+=c+s+c):(c=n-s,c=ge(c,-2),a===of?(h=[s,c],f+=c+s):a===of&&(h=[0,c,s,_i],f+=c+s+_i));else{c=(n-l)/(u-1),c=ge(c,-2);for(let m=0;m<u;m++)h.push(s),f+=s,m<u-1?(f+=c,h.push(c)):(f+=_i,h.push(_i))}let d=`[${s}, ${c}] x ${u}`;return o!=null&&o.converter&&(h=h.map(o==null?void 0:o.converter)),{pattern:h,totalLength:f,patternString:d}}else if(t!==void 0&&e==="both"){let u=ge(t.count,0),l=t.speed;!n&&!o?n=af:!n&&o&&o.converter&&(n=yl);let c=ge(1/l,-2);o||(c<.12&&(c=.12),n>c&&(n=ge(c*.85,-2)));let h=ge(c-n,-2),f=[],d=0,m=`[${n}, ${h}] x ${u} `;for(let p=0;p<u;p++)f.push(n),d+=n,p<u-1?(d+=h,f.push(h)):(d+=_i,f.push(_i));return o!=null&&o.converter&&(f=f.map(o==null?void 0:o.converter)),{pattern:f,totalLength:d,patternString:m}}else return{pattern:[],totalLength:0,patternString:"[0, 0] x 0"}}function zp(t,e){return t&&e?Ou({count:t==null?void 0:t.value,speed:e==null?void 0:e.value},"both",t.tapLength,void 0,e.tappingUnit,e.singleTappingPosition,t.beat):t?Ou(t==null?void 0:t.value,De,t.tapLength,t.pause,void 0,void 0,t.beat):e?Ou(e==null?void 0:e.value,Fe,e.tapDuration,void 0,e.tappingUnit,e.singleTappingPosition,e.beat):void 0}const h_=[{c:16.35,cs:17.32,d:18.35,ds:19.45,e:20.6,f:21.83,fs:23.12,g:24.5,gs:25.96,a:27.5,as:29.14,b:30.87},{c:32.7,cs:34.65,d:36.71,ds:38.89,e:41.2,f:43.65,fs:46.25,g:49,gs:51.91,a:55,as:58.27,b:61.74},{c:65.41,cs:69.3,d:73.42,ds:77.78,e:82.41,f:87.31,fs:92.5,g:98,gs:103.83,a:110,as:116.54,b:123.47},{c:130.81,cs:138.59,d:146.83,ds:155.56,e:164.81,f:174.61,fs:185,g:196,gs:207.65,a:220,as:233.08,b:246.94},{c:261.63,cs:277.18,d:293.66,ds:311.13,e:329.63,f:349.23,fs:369.99,g:392,gs:415.3,a:440,as:466.16,b:493.88},{c:523.25,cs:554.37,d:587.33,ds:622.25,e:659.25,f:698.46,fs:739.99,g:783.99,gs:830.61,a:880,as:932.33,b:987.77},{c:1046.5,cs:1108.73,d:1174.66,ds:1244.51,e:1318.51,f:1396.91,fs:1479.98,g:1567.98,gs:1661.22,a:1760,as:1864.66,b:1975.53},{c:2093,cs:2217.46,d:2349.32,ds:2489.02,e:2637.02,f:2793.83,fs:2959.96,g:3135.96,gs:3322.44,a:3520,as:3729.31,b:3951.07},{c:4186.01,cs:4434.92,d:4698.63,ds:4978.03,e:5274.04,f:5587.65,fs:5919.91,g:6271.93,gs:6644.88,a:7040,as:7458.62,b:7902.13}],f_={bb:"as",ab:"gs",gb:"fs",fb:"e",eb:"ds",db:"cs",cb:"b"};function da(t){var s,a;if(ot(t)==="Number")return t;if(ot(t)!=="String")return null;let e=(s=t[0])==null?void 0:s.toLowerCase(),n=t[1],r=(a=t[2])==null?void 0:a.toLowerCase();if(r==="#"?r="s":r==="♭"&&(r="b"),n>8)return null;if(r==="b"){let o=f_[e+r];e=o[0],r=o[1],o=="b"&&(n=n-1)}return e+r==="bs"?(e="c",r=void 0):e+r==="es"&&(e="f",r=void 0),n<0?null:h_[n][e+(r||"")]}const mt="text",Hs="tone",Ys="tone-series",qp="legend",_l="tone-speech-series",bl="pause",uo="tone-overlay-series",Ba="stopped",ff="paused",Du="playing",df="finished",d_=[mt,Hs,Ys,uo,bl,_l,qp];class xn{constructor(){this.queue=[],this.state=df,this.playAt,this.config={},this.stopEvents={},this.sampledInstruments=[],this.sampledInstrumentSources={},this.chunks,this.export=[],this.samplings={},this.synths={},this.waves={},this.playId}setConfig(e,n){this.config[e]=n}setSampling(e){this.samplings=P(e)}setSynths(e){this.synths=P(e)}setWaves(e){this.waves=P(e)}isSupportedInst(e){return Y1.includes(e)}isSampling(e){var n;return((n=this.samplings)==null?void 0:n[e])!==void 0}isSynth(e){var n;return((n=this.synths)==null?void 0:n[e])!==void 0}isWave(e){var n;return((n=this.waves)==null?void 0:n[e])!==void 0}add(e,n,r,s){var u,l,c,h,f,d,m,p,g,y,_,b,A,S;let a=new Set,o=new Set;if(d_.includes(e)){let I={type:e,config:r};if(e===mt)I.text=(n==null?void 0:n.text)||n||"",n!=null&&n.speechRate&&(I.speechRate=n==null?void 0:n.speechRate);else if(e===Hs){I.instrument_type=n.instrument_type,this.isSupportedInst(I.instrument_type)?a.add(I.instrument_type):this.isSampling(I.instrument_type)&&o.add(I.instrument_type),I.time=((u=n.sound)==null?void 0:u.start)||n.start||0,I.end=((l=n.sound)==null?void 0:l.end)||I.time+(((c=I.sound)==null?void 0:c.duration)||.2),I.duration=((h=n.sound)==null?void 0:h.duration)||I.end-I.time||.2,I.pitch=((f=n.sound)==null?void 0:f.pitch)||n.pitch||ae,I.detune=((d=n.sound)==null?void 0:d.detune)||n.detune,I.loudness=Z1((m=n.sound)==null?void 0:m.loudness,n.loudness,1),I.pan=((p=n.sound)==null?void 0:p.pan)||n.pan,I.postReverb=((g=n.sound)==null?void 0:g.postReverb)||n.postReverb||0,I.timbre=((y=n.sound)==null?void 0:y.timbre)||n.timbre||n.instrument_type;let x=((_=n.sound)==null?void 0:_.tapCount)||n.tapCount,C=((b=n.sound)==null?void 0:b.tapSpeed)||n.tapSpeed;(x||C)&&(I.tap=zp(x,C),I.duration=I.tap.totalLength),I.modulation=((A=n.sound)==null?void 0:A.modulation)||n.modulation||0,I.harmonicity=((S=n.sound)==null?void 0:S.harmonicity)||n.harmonicity||0,I.others={},Object.keys(n.sound||n||{}).forEach(T=>{var N;Rp.includes(T)||(I.others[T]=((N=n.sound)==null?void 0:N[T])||n[T])}),I.filters=n.filters||[],this.isSupportedInst(I.timbre)?a.add(I.timbre):this.isSampling(I.timbre)&&o.add(I.timbre)}else e===Ys?(I.instrument_type=n.instrument_type,this.isSupportedInst(I.instrument_type)?a.add(I.instrument_type):this.isSampling(I.instrument_type)&&o.add(I.instrument_type),I.sounds=pf(n.sounds),I.sounds.hasSpeech&&(I.type=_l),I.sounds[I.sounds.length-1].isLast=!0,I.continued=n.continued,I.relative=n.relative,I.filters=n.filters||[],this.isSupportedInst(I.instrument_type)?a.add(I.instrument_type):this.isSampling(I.instrument_type)&&o.add(I.instrument_type),I.sounds.forEach(x=>{this.isSupportedInst(x.timbre)?a.add(x.timbre):this.isSampling(x.timbre)&&o.add(x.timbre)})):e===uo?n.overlays.length>0?I.overlays=n.overlays.map(x=>{let C={instrument_type:x.instrument_type,sounds:pf(x.sounds),continued:x.continued,relative:x.relative,filters:x.filters||[]};return C.sounds[C.sounds.length-1].isLast=!0,this.isSupportedInst(C.instrument_type)?a.add(C.instrument_type):this.isSampling(C.instrument_type)&&o.add(C.instrument_type),C.sounds.forEach(T=>{this.isSupportedInst(T.timbre)?a.add(T.timbre):this.isSampling(T.timbre)&&o.add(T.timbre)}),C}):I.overlays=n.overlays:e===bl?I.duration=n.duration:e===qp&&Object.assign(I,n);n.ramp&&(I.ramp=P(n.ramp)),Array.from(a).forEach(x=>{this.sampledInstruments.includes(x)||this.sampledInstruments.push(x)}),Array.from(o).forEach(x=>{this.sampledInstruments.includes(x)||this.sampledInstruments.push(x)}),s!==void 0?this.queue.splice(s,0,I):this.queue.push(I)}}addMulti(e,n,r){let s=r;for(const a of e)a!=null&&a.type&&(this.add(a.type,a,n,s),s!==void 0&&(s+=1))}addQueue(e,n){n!==void 0?this.queue.splice(n,0,...e.queue):this.queue.push(...e.queue)}async play(e,n){if(this.state!==Du){i_(this,this.config);let r=this.queue;this.playAt=e||0,e!==void 0&&n!==void 0?r=this.queue.slice(e,n):e!==void 0?r=this.queue.slice(e,this.queue.length):n!==void 0&&(r=this.queue.slice(0,n)),this.state=Du,this.fireStartEvent();for(const s of r){if(console.log(s,this.state),this.state===Ba||this.state===ff)break;await this.playLine(s),this.playAt+=1}this.fireStopEvent(),Eu(),this.state=Ba,this.playAt=void 0}}async playLine(e){var r,s,a,o;let n=P(this.config);if(Object.assign(n,e.config),n.ramp=e.ramp,(e==null?void 0:e.type)===mt)await jp(e.text,n);else if((e==null?void 0:e.type)===Hs){let u=Fa();for(const l of this.sampledInstruments)l&&!this.sampledInstrumentSources[l]&&(this.sampledInstrumentSources[l]=await Oa(u,l,this.samplings,(r=this.config.options)==null?void 0:r.baseUrl));await cc(u,e,n,this.sampledInstrumentSources,this.synths,this.waves,e.filters),u.close()}else if((e==null?void 0:e.type)===bl)await rn(e.duration*1e3);else if((e==null?void 0:e.type)===Ys){let u=Fa();for(const l of this.sampledInstruments)l&&!this.sampledInstrumentSources[l]&&(this.sampledInstrumentSources[l]=await Oa(u,l,this.samplings,(s=this.config.options)==null?void 0:s.baseUrl));e.continued?await cf(u,e.sounds,n,this.synths,this.waves,e.filters):e.relative?await Nu(u,e.sounds,n,this.sampledInstrumentSources,this.synths,this.waves,e.filters):await lf(u,e.sounds,n,this.sampledInstrumentSources,this.synths,this.waves,e.filters),u.close()}else if((e==null?void 0:e.type)===_l){let u=Fa();for(const l of this.sampledInstruments)l&&!this.sampledInstrumentSources[l]&&(this.sampledInstrumentSources[l]=await Oa(u,l,this.samplings,(a=this.config.options)==null?void 0:a.baseUrl));await Nu(u,e.sounds,n,this.sampledInstrumentSources,this.synths,this.waves,e.filters),u.close()}else if((e==null?void 0:e.type)===uo){let u=[],l=Fa();for(const c of this.sampledInstruments)c&&!this.sampledInstrumentSources[c]&&(this.sampledInstrumentSources[c]=await Oa(l,c,this.samplings,(o=this.config.options)==null?void 0:o.baseUrl));for(let c of e.overlays)c.continued?u.push(cf(l,c.sounds,n,this.synths,this.waves,c.filters)):c.relative?u.push(Nu(l,c.sounds,n,this.sampledInstrumentSources,this.synths,this.waves,c.filters)):u.push(lf(l,c.sounds,n,this.sampledInstrumentSources,this.synths,this.waves,c.filters));await Promise.all(u),l.close()}}stop(){var e,n;this.state===Du&&((yt==null?void 0:yt.type)===fa||(e=yt==null?void 0:yt.player)!=null&&e.close?yt.player.close():((yt==null?void 0:yt.type)===iu||(n=yt==null?void 0:yt.player)!=null&&n.cancel)&&yt.player.cancel(),this.state!==Ba&&(this.state=Ba,vp(this.config),this.fireStopEvent(),Eu(),this.playAt=void 0))}pause(){self.state=ff,W1(this.config)}async resume(){return await H1(this.config),this.play(this.playAt)}fireStartEvent(){this.playId=ti(),t_({pid:this.playId})}fireStopEvent(){e_({pid:this.playId})}destroy(){this.state=df,this.queue=[],Eu()}}function pf(t){let e=[];for(const n of t){let r=n.start!==void 0?n.start:n.time,s=n.duration!==void 0?n.duration:n.end-r,a=zp(n.tapCount,n.tapSpeed);(n.tapCount||n.tapSpeed)&&(s=a.totalLength);let o={pitch:n.pitch,detune:n.detune,loudness:n.loudness,time:r,duration:s,pan:n.pan,speech:n.speech,language:n.language,postReverb:Math.round(n.postReverb*100)/100||0,timbre:n.timbre,tap:a,modulation:n.modulation||0,harmonicity:n.harmonicity||0,__datum:n.__datum,others:{}};n.speech&&(o.duration=void 0,e.hasSpeech=!0),Object.keys(n||{}).forEach(u=>{!Rp.includes(u)&&u!=="__datum"&&(o.others[u]=n[u])}),e.push(o)}return e=e.sort((n,r)=>n.time+n.duration-(r.time+r.duration)),e}function Er(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Wp(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hc(t){let e,n,r;t.length!==2?(e=Er,n=(u,l)=>Er(t(u),l),r=(u,l)=>t(u)-l):(e=t===Er||t===Wp?t:p_,n=t,r=t);function s(u,l,c=0,h=u.length){if(c<h){if(e(l,l)!==0)return h;do{const f=c+h>>>1;n(u[f],l)<0?c=f+1:h=f}while(c<h)}return c}function a(u,l,c=0,h=u.length){if(c<h){if(e(l,l)!==0)return h;do{const f=c+h>>>1;n(u[f],l)<=0?c=f+1:h=f}while(c<h)}return c}function o(u,l,c=0,h=u.length){const f=s(u,l,c,h-1);return f>c&&r(u[f-1],l)>-r(u[f],l)?f-1:f}return{left:s,center:o,right:a}}function p_(){return 0}function Hp(t){return t===null?NaN:+t}const m_=hc(Er),Yp=m_.right;hc(Hp).center;function y_(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let s of t)(s=e(s,++r,t))!=null&&(s=+s)>=s&&++n}return n}function g_(t,e){let n=0,r,s=0,a=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(r=o-s,s+=r/++n,a+=r*(o-s));else{let o=-1;for(let u of t)(u=e(u,++o,t))!=null&&(u=+u)>=u&&(r=u-s,s+=r/++n,a+=r*(u-s))}if(n>1)return a/(n-1)}function v_(t,e){const n=g_(t,e);return n&&Math.sqrt(n)}function Or(t,e){let n,r;if(e===void 0)for(const s of t)s!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)));else{let s=-1;for(let a of t)(a=e(a,++s,t))!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}class mf extends Map{constructor(e,n=w_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,s]of e)this.set(r,s)}get(e){return super.get(yf(this,e))}has(e){return super.has(yf(this,e))}set(e,n){return super.set(__(this,e),n)}delete(e){return super.delete(b_(this,e))}}function yf({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function __({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function b_({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function w_(t){return t!==null&&typeof t=="object"?t.valueOf():t}function x_(t){return t}var S_=Array.prototype,I_=S_.slice;function Fu(t){return()=>t}const T_=Math.sqrt(50),A_=Math.sqrt(10),C_=Math.sqrt(2);function lo(t,e,n){const r=(e-t)/Math.max(0,n),s=Math.floor(Math.log10(r)),a=r/Math.pow(10,s),o=a>=T_?10:a>=A_?5:a>=C_?2:1;let u,l,c;return s<0?(c=Math.pow(10,-s)/o,u=Math.round(t*c),l=Math.round(e*c),u/c<t&&++u,l/c>e&&--l,c=-c):(c=Math.pow(10,s)*o,u=Math.round(t/c),l=Math.round(e/c),u*c<t&&++u,l*c>e&&--l),l<u&&.5<=n&&n<2?lo(t,e,n*2):[u,l,c]}function co(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[s,a,o]=r?lo(e,t,n):lo(t,e,n);if(!(a>=s))return[];const u=a-s+1,l=new Array(u);if(r)if(o<0)for(let c=0;c<u;++c)l[c]=(a-c)/-o;else for(let c=0;c<u;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<u;++c)l[c]=(s+c)/-o;else for(let c=0;c<u;++c)l[c]=(s+c)*o;return l}function jr(t,e,n){return e=+e,t=+t,n=+n,lo(t,e,n)[2]}function wl(t,e,n){e=+e,t=+t,n=+n;const r=e<t,s=r?jr(e,t,n):jr(t,e,n);return(r?-1:1)*(s<0?1/-s:s)}function k_(t,e,n){let r;for(;;){const s=jr(t,e,n);if(s===r||s===0||!isFinite(s))return[t,e];s>0?(t=Math.floor(t/s)*s,e=Math.ceil(e/s)*s):s<0&&(t=Math.ceil(t*s)/s,e=Math.floor(e*s)/s),r=s}}function M_(t){return Math.max(1,Math.ceil(Math.log(y_(t))/Math.LN2)+1)}function N_(){var t=x_,e=Or,n=M_;function r(s){Array.isArray(s)||(s=Array.from(s));var a,o=s.length,u,l,c=new Array(o);for(a=0;a<o;++a)c[a]=t(s[a],a,s);var h=e(c),f=h[0],d=h[1],m=n(c,f,d);if(!Array.isArray(m)){const A=d,S=+m;if(e===Or&&([f,d]=k_(f,d,S)),m=co(f,d,S),m[0]<=f&&(l=jr(f,d,S)),m[m.length-1]>=d)if(A>=d&&e===Or){const I=jr(f,d,S);isFinite(I)&&(I>0?d=(Math.floor(d/I)+1)*I:I<0&&(d=(Math.ceil(d*-I)+1)/-I))}else m.pop()}for(var p=m.length,g=0,y=p;m[g]<=f;)++g;for(;m[y-1]>d;)--y;(g||y<p)&&(m=m.slice(g,y),p=y-g);var _=new Array(p+1),b;for(a=0;a<=p;++a)b=_[a]=[],b.x0=a>0?m[a-1]:f,b.x1=a<p?m[a]:d;if(isFinite(l)){if(l>0)for(a=0;a<o;++a)(u=c[a])!=null&&f<=u&&u<=d&&_[Math.min(p,Math.floor((u-f)/l))].push(s[a]);else if(l<0){for(a=0;a<o;++a)if((u=c[a])!=null&&f<=u&&u<=d){const A=Math.floor((f-u)*l);_[Math.min(p,A+(m[A]<=u))].push(s[a])}}}else for(a=0;a<o;++a)(u=c[a])!=null&&f<=u&&u<=d&&_[Yp(m,u,0,p)].push(s[a]);return _}return r.value=function(s){return arguments.length?(t=typeof s=="function"?s:Fu(s),r):t},r.domain=function(s){return arguments.length?(e=typeof s=="function"?s:Fu([s[0],s[1]]),r):e},r.thresholds=function(s){return arguments.length?(n=typeof s=="function"?s:Fu(Array.isArray(s)?I_.call(s):s),r):n},r}function E_(t,e,n=Hp){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,s=(r-1)*e,a=Math.floor(s),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(s-a)}}var O_={value:()=>{}};function Gp(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ya(n)}function Ya(t){this._=t}function D_(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ya.prototype=Gp.prototype={constructor:Ya,on:function(t,e){var n=this._,r=D_(t+"",n),s,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((s=(t=r[a]).type)&&(s=F_(n[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(s=(t=r[a]).type)n[s]=gf(n[s],t.name,e);else if(e==null)for(s in n)n[s]=gf(n[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ya(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,a;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,s=a.length;r<s;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],s=0,a=r.length;s<a;++s)r[s].value.apply(e,n)}};function F_(t,e){for(var n=0,r=t.length,s;n<r;++n)if((s=t[n]).name===e)return s.value}function gf(t,e,n){for(var r=0,s=t.length;r<s;++r)if(t[r].name===e){t[r]=O_,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var xl="http://www.w3.org/1999/xhtml";const vf={svg:"http://www.w3.org/2000/svg",xhtml:xl,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ru(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),vf.hasOwnProperty(e)?{space:vf[e],local:t}:t}function B_(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===xl&&e.documentElement.namespaceURI===xl?e.createElement(t):e.createElementNS(n,t)}}function R_(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Kp(t){var e=ru(t);return(e.local?R_:B_)(e)}function L_(){}function fc(t){return t==null?L_:function(){return this.querySelector(t)}}function P_(t){typeof t!="function"&&(t=fc(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var a=e[s],o=a.length,u=r[s]=new Array(o),l,c,h=0;h<o;++h)(l=a[h])&&(c=t.call(l,l.__data__,h,a))&&("__data__"in l&&(c.__data__=l.__data__),u[h]=c);return new Be(r,this._parents)}function V_(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function U_(){return[]}function Qp(t){return t==null?U_:function(){return this.querySelectorAll(t)}}function $_(t){return function(){return V_(t.apply(this,arguments))}}function j_(t){typeof t=="function"?t=$_(t):t=Qp(t);for(var e=this._groups,n=e.length,r=[],s=[],a=0;a<n;++a)for(var o=e[a],u=o.length,l,c=0;c<u;++c)(l=o[c])&&(r.push(t.call(l,l.__data__,c,o)),s.push(l));return new Be(r,s)}function Jp(t){return function(){return this.matches(t)}}function Xp(t){return function(e){return e.matches(t)}}var z_=Array.prototype.find;function q_(t){return function(){return z_.call(this.children,t)}}function W_(){return this.firstElementChild}function H_(t){return this.select(t==null?W_:q_(typeof t=="function"?t:Xp(t)))}var Y_=Array.prototype.filter;function G_(){return Array.from(this.children)}function K_(t){return function(){return Y_.call(this.children,t)}}function Q_(t){return this.selectAll(t==null?G_:K_(typeof t=="function"?t:Xp(t)))}function J_(t){typeof t!="function"&&(t=Jp(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var a=e[s],o=a.length,u=r[s]=[],l,c=0;c<o;++c)(l=a[c])&&t.call(l,l.__data__,c,a)&&u.push(l);return new Be(r,this._parents)}function Zp(t){return new Array(t.length)}function X_(){return new Be(this._enter||this._groups.map(Zp),this._parents)}function ho(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ho.prototype={constructor:ho,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Z_(t){return function(){return t}}function tb(t,e,n,r,s,a){for(var o=0,u,l=e.length,c=a.length;o<c;++o)(u=e[o])?(u.__data__=a[o],r[o]=u):n[o]=new ho(t,a[o]);for(;o<l;++o)(u=e[o])&&(s[o]=u)}function eb(t,e,n,r,s,a,o){var u,l,c=new Map,h=e.length,f=a.length,d=new Array(h),m;for(u=0;u<h;++u)(l=e[u])&&(d[u]=m=o.call(l,l.__data__,u,e)+"",c.has(m)?s[u]=l:c.set(m,l));for(u=0;u<f;++u)m=o.call(t,a[u],u,a)+"",(l=c.get(m))?(r[u]=l,l.__data__=a[u],c.delete(m)):n[u]=new ho(t,a[u]);for(u=0;u<h;++u)(l=e[u])&&c.get(d[u])===l&&(s[u]=l)}function nb(t){return t.__data__}function ib(t,e){if(!arguments.length)return Array.from(this,nb);var n=e?eb:tb,r=this._parents,s=this._groups;typeof t!="function"&&(t=Z_(t));for(var a=s.length,o=new Array(a),u=new Array(a),l=new Array(a),c=0;c<a;++c){var h=r[c],f=s[c],d=f.length,m=rb(t.call(h,h&&h.__data__,c,r)),p=m.length,g=u[c]=new Array(p),y=o[c]=new Array(p),_=l[c]=new Array(d);n(h,f,g,y,_,m,e);for(var b=0,A=0,S,I;b<p;++b)if(S=g[b]){for(b>=A&&(A=b+1);!(I=y[A])&&++A<p;);S._next=I||null}}return o=new Be(o,r),o._enter=u,o._exit=l,o}function rb(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function sb(){return new Be(this._exit||this._groups.map(Zp),this._parents)}function ab(t,e,n){var r=this.enter(),s=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?a.remove():n(a),r&&s?r.merge(s).order():s}function ob(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,a=r.length,o=Math.min(s,a),u=new Array(s),l=0;l<o;++l)for(var c=n[l],h=r[l],f=c.length,d=u[l]=new Array(f),m,p=0;p<f;++p)(m=c[p]||h[p])&&(d[p]=m);for(;l<s;++l)u[l]=n[l];return new Be(u,this._parents)}function ub(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,a=r[s],o;--s>=0;)(o=r[s])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function lb(t){t||(t=cb);function e(f,d){return f&&d?t(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,s=new Array(r),a=0;a<r;++a){for(var o=n[a],u=o.length,l=s[a]=new Array(u),c,h=0;h<u;++h)(c=o[h])&&(l[h]=c);l.sort(e)}return new Be(s,this._parents).order()}function cb(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function hb(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function fb(){return Array.from(this)}function db(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,a=r.length;s<a;++s){var o=r[s];if(o)return o}return null}function pb(){let t=0;for(const e of this)++t;return t}function mb(){return!this.node()}function yb(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],a=0,o=s.length,u;a<o;++a)(u=s[a])&&t.call(u,u.__data__,a,s);return this}function gb(t){return function(){this.removeAttribute(t)}}function vb(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _b(t,e){return function(){this.setAttribute(t,e)}}function bb(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function wb(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function xb(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Sb(t,e){var n=ru(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?vb:gb:typeof e=="function"?n.local?xb:wb:n.local?bb:_b)(n,e))}function tm(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ib(t){return function(){this.style.removeProperty(t)}}function Tb(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ab(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Cb(t,e,n){return arguments.length>1?this.each((e==null?Ib:typeof e=="function"?Ab:Tb)(t,e,n??"")):zr(this.node(),t)}function zr(t,e){return t.style.getPropertyValue(e)||tm(t).getComputedStyle(t,null).getPropertyValue(e)}function kb(t){return function(){delete this[t]}}function Mb(t,e){return function(){this[t]=e}}function Nb(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Eb(t,e){return arguments.length>1?this.each((e==null?kb:typeof e=="function"?Nb:Mb)(t,e)):this.node()[t]}function em(t){return t.trim().split(/^|\s+/)}function dc(t){return t.classList||new nm(t)}function nm(t){this._node=t,this._names=em(t.getAttribute("class")||"")}nm.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function im(t,e){for(var n=dc(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function rm(t,e){for(var n=dc(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function Ob(t){return function(){im(this,t)}}function Db(t){return function(){rm(this,t)}}function Fb(t,e){return function(){(e.apply(this,arguments)?im:rm)(this,t)}}function Bb(t,e){var n=em(t+"");if(arguments.length<2){for(var r=dc(this.node()),s=-1,a=n.length;++s<a;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?Fb:e?Ob:Db)(n,e))}function Rb(){this.textContent=""}function Lb(t){return function(){this.textContent=t}}function Pb(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Vb(t){return arguments.length?this.each(t==null?Rb:(typeof t=="function"?Pb:Lb)(t)):this.node().textContent}function Ub(){this.innerHTML=""}function $b(t){return function(){this.innerHTML=t}}function jb(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function zb(t){return arguments.length?this.each(t==null?Ub:(typeof t=="function"?jb:$b)(t)):this.node().innerHTML}function qb(){this.nextSibling&&this.parentNode.appendChild(this)}function Wb(){return this.each(qb)}function Hb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yb(){return this.each(Hb)}function Gb(t){var e=typeof t=="function"?t:Kp(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Kb(){return null}function Qb(t,e){var n=typeof t=="function"?t:Kp(t),r=e==null?Kb:typeof e=="function"?e:fc(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Jb(){var t=this.parentNode;t&&t.removeChild(this)}function Xb(){return this.each(Jb)}function Zb(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tw(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ew(t){return this.select(t?tw:Zb)}function nw(t){return arguments.length?this.property("__data__",t):this.node().__data__}function iw(t){return function(e){t.call(this,e,this.__data__)}}function rw(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function sw(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,a;n<s;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function aw(t,e,n){return function(){var r=this.__on,s,a=iw(e);if(r){for(var o=0,u=r.length;o<u;++o)if((s=r[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=a,s.options=n),s.value=e;return}}this.addEventListener(t.type,a,n),s={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(s):this.__on=[s]}}function ow(t,e,n){var r=rw(t+""),s,a=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,c=u.length,h;l<c;++l)for(s=0,h=u[l];s<a;++s)if((o=r[s]).type===h.type&&o.name===h.name)return h.value}return}for(u=e?aw:sw,s=0;s<a;++s)this.each(u(r[s],e,n));return this}function sm(t,e,n){var r=tm(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function uw(t,e){return function(){return sm(this,t,e)}}function lw(t,e){return function(){return sm(this,t,e.apply(this,arguments))}}function cw(t,e){return this.each((typeof e=="function"?lw:uw)(t,e))}function*hw(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,a=r.length,o;s<a;++s)(o=r[s])&&(yield o)}var am=[null];function Be(t,e){this._groups=t,this._parents=e}function pa(){return new Be([[document.documentElement]],am)}function fw(){return this}Be.prototype=pa.prototype={constructor:Be,select:P_,selectAll:j_,selectChild:H_,selectChildren:Q_,filter:J_,data:ib,enter:X_,exit:sb,join:ab,merge:ob,selection:fw,order:ub,sort:lb,call:hb,nodes:fb,node:db,size:pb,empty:mb,each:yb,attr:Sb,style:Cb,property:Eb,classed:Bb,text:Vb,html:zb,raise:Wb,lower:Yb,append:Gb,insert:Qb,remove:Xb,clone:ew,datum:nw,on:ow,dispatch:cw,[Symbol.iterator]:hw};function _f(t){return typeof t=="string"?new Be([[document.querySelector(t)]],[document.documentElement]):new Be([[t]],am)}function pc(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function om(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ma(){}var Gs=.7,fo=1/Gs,Dr="\\s*([+-]?\\d+)\\s*",Ks="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dw=/^#([0-9a-f]{3,8})$/,pw=new RegExp(`^rgb\\(${Dr},${Dr},${Dr}\\)$`),mw=new RegExp(`^rgb\\(${Fn},${Fn},${Fn}\\)$`),yw=new RegExp(`^rgba\\(${Dr},${Dr},${Dr},${Ks}\\)$`),gw=new RegExp(`^rgba\\(${Fn},${Fn},${Fn},${Ks}\\)$`),vw=new RegExp(`^hsl\\(${Ks},${Fn},${Fn}\\)$`),_w=new RegExp(`^hsla\\(${Ks},${Fn},${Fn},${Ks}\\)$`),bf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pc(ma,ar,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:wf,formatHex:wf,formatHex8:bw,formatHsl:ww,formatRgb:xf,toString:xf});function wf(){return this.rgb().formatHex()}function bw(){return this.rgb().formatHex8()}function ww(){return um(this).formatHsl()}function xf(){return this.rgb().formatRgb()}function ar(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=dw.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Sf(e):n===3?new Se(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ra(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ra(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=pw.exec(t))?new Se(e[1],e[2],e[3],1):(e=mw.exec(t))?new Se(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=yw.exec(t))?Ra(e[1],e[2],e[3],e[4]):(e=gw.exec(t))?Ra(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=vw.exec(t))?Af(e[1],e[2]/100,e[3]/100,1):(e=_w.exec(t))?Af(e[1],e[2]/100,e[3]/100,e[4]):bf.hasOwnProperty(t)?Sf(bf[t]):t==="transparent"?new Se(NaN,NaN,NaN,0):null}function Sf(t){return new Se(t>>16&255,t>>8&255,t&255,1)}function Ra(t,e,n,r){return r<=0&&(t=e=n=NaN),new Se(t,e,n,r)}function xw(t){return t instanceof ma||(t=ar(t)),t?(t=t.rgb(),new Se(t.r,t.g,t.b,t.opacity)):new Se}function Sl(t,e,n,r){return arguments.length===1?xw(t):new Se(t,e,n,r??1)}function Se(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}pc(Se,Sl,om(ma,{brighter(t){return t=t==null?fo:Math.pow(fo,t),new Se(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Gs:Math.pow(Gs,t),new Se(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Se(sr(this.r),sr(this.g),sr(this.b),po(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:If,formatHex:If,formatHex8:Sw,formatRgb:Tf,toString:Tf}));function If(){return`#${Ki(this.r)}${Ki(this.g)}${Ki(this.b)}`}function Sw(){return`#${Ki(this.r)}${Ki(this.g)}${Ki(this.b)}${Ki((isNaN(this.opacity)?1:this.opacity)*255)}`}function Tf(){const t=po(this.opacity);return`${t===1?"rgb(":"rgba("}${sr(this.r)}, ${sr(this.g)}, ${sr(this.b)}${t===1?")":`, ${t})`}`}function po(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function sr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ki(t){return t=sr(t),(t<16?"0":"")+t.toString(16)}function Af(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new sn(t,e,n,r)}function um(t){if(t instanceof sn)return new sn(t.h,t.s,t.l,t.opacity);if(t instanceof ma||(t=ar(t)),!t)return new sn;if(t instanceof sn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-s,l=(a+s)/2;return u?(e===a?o=(n-r)/u+(n<r)*6:n===a?o=(r-e)/u+2:o=(e-n)/u+4,u/=l<.5?a+s:2-a-s,o*=60):u=l>0&&l<1?0:o,new sn(o,u,l,t.opacity)}function Iw(t,e,n,r){return arguments.length===1?um(t):new sn(t,e,n,r??1)}function sn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}pc(sn,Iw,om(ma,{brighter(t){return t=t==null?fo:Math.pow(fo,t),new sn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Gs:Math.pow(Gs,t),new sn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new Se(Bu(t>=240?t-240:t+120,s,r),Bu(t,s,r),Bu(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new sn(Cf(this.h),La(this.s),La(this.l),po(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=po(this.opacity);return`${t===1?"hsl(":"hsla("}${Cf(this.h)}, ${La(this.s)*100}%, ${La(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Cf(t){return t=(t||0)%360,t<0?t+360:t}function La(t){return Math.max(0,Math.min(1,t||0))}function Bu(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const mc=t=>()=>t;function Tw(t,e){return function(n){return t+n*e}}function Aw(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Cw(t){return(t=+t)==1?lm:function(e,n){return n-e?Aw(e,n,t):mc(isNaN(e)?n:e)}}function lm(t,e){var n=e-t;return n?Tw(t,n):mc(isNaN(t)?e:t)}const mo=function t(e){var n=Cw(e);function r(s,a){var o=n((s=Sl(s)).r,(a=Sl(a)).r),u=n(s.g,a.g),l=n(s.b,a.b),c=lm(s.opacity,a.opacity);return function(h){return s.r=o(h),s.g=u(h),s.b=l(h),s.opacity=c(h),s+""}}return r.gamma=t,r}(1);function kw(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),s;return function(a){for(s=0;s<n;++s)r[s]=t[s]*(1-a)+e[s]*a;return r}}function Mw(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Nw(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,s=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)s[o]=yc(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<r;++o)a[o]=s[o](u);return a}}function Ew(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function nn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ow(t,e){var n={},r={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?n[s]=yc(t[s],e[s]):r[s]=e[s];return function(a){for(s in n)r[s]=n[s](a);return r}}var Il=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ru=new RegExp(Il.source,"g");function Dw(t){return function(){return t}}function Fw(t){return function(e){return t(e)+""}}function cm(t,e){var n=Il.lastIndex=Ru.lastIndex=0,r,s,a,o=-1,u=[],l=[];for(t=t+"",e=e+"";(r=Il.exec(t))&&(s=Ru.exec(e));)(a=s.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(s=s[0])?u[o]?u[o]+=s:u[++o]=s:(u[++o]=null,l.push({i:o,x:nn(r,s)})),n=Ru.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?l[0]?Fw(l[0].x):Dw(e):(e=l.length,function(c){for(var h=0,f;h<e;++h)u[(f=l[h]).i]=f.x(c);return u.join("")})}function yc(t,e){var n=typeof e,r;return e==null||n==="boolean"?mc(e):(n==="number"?nn:n==="string"?(r=ar(e))?(e=r,mo):cm:e instanceof ar?mo:e instanceof Date?Ew:Mw(e)?kw:Array.isArray(e)?Nw:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ow:nn)(t,e)}function Bw(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var kf=180/Math.PI,Tl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hm(t,e,n,r,s,a){var o,u,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:s,translateY:a,rotate:Math.atan2(e,t)*kf,skewX:Math.atan(l)*kf,scaleX:o,scaleY:u}}var Pa;function Rw(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Tl:hm(e.a,e.b,e.c,e.d,e.e,e.f)}function Lw(t){return t==null||(Pa||(Pa=document.createElementNS("http://www.w3.org/2000/svg","g")),Pa.setAttribute("transform",t),!(t=Pa.transform.baseVal.consolidate()))?Tl:(t=t.matrix,hm(t.a,t.b,t.c,t.d,t.e,t.f))}function fm(t,e,n,r){function s(c){return c.length?c.pop()+" ":""}function a(c,h,f,d,m,p){if(c!==f||h!==d){var g=m.push("translate(",null,e,null,n);p.push({i:g-4,x:nn(c,f)},{i:g-2,x:nn(h,d)})}else(f||d)&&m.push("translate("+f+e+d+n)}function o(c,h,f,d){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),d.push({i:f.push(s(f)+"rotate(",null,r)-2,x:nn(c,h)})):h&&f.push(s(f)+"rotate("+h+r)}function u(c,h,f,d){c!==h?d.push({i:f.push(s(f)+"skewX(",null,r)-2,x:nn(c,h)}):h&&f.push(s(f)+"skewX("+h+r)}function l(c,h,f,d,m,p){if(c!==f||h!==d){var g=m.push(s(m)+"scale(",null,",",null,")");p.push({i:g-4,x:nn(c,f)},{i:g-2,x:nn(h,d)})}else(f!==1||d!==1)&&m.push(s(m)+"scale("+f+","+d+")")}return function(c,h){var f=[],d=[];return c=t(c),h=t(h),a(c.translateX,c.translateY,h.translateX,h.translateY,f,d),o(c.rotate,h.rotate,f,d),u(c.skewX,h.skewX,f,d),l(c.scaleX,c.scaleY,h.scaleX,h.scaleY,f,d),c=h=null,function(m){for(var p=-1,g=d.length,y;++p<g;)f[(y=d[p]).i]=y.x(m);return f.join("")}}}var Pw=fm(Rw,"px, ","px)","deg)"),Vw=fm(Lw,", ",")",")"),qr=0,Ds=0,xs=0,dm=1e3,yo,Fs,go=0,or=0,su=0,Qs=typeof performance=="object"&&performance.now?performance:Date,pm=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function gc(){return or||(pm(Uw),or=Qs.now()+su)}function Uw(){or=0}function vo(){this._call=this._time=this._next=null}vo.prototype=mm.prototype={constructor:vo,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?gc():+n)+(e==null?0:+e),!this._next&&Fs!==this&&(Fs?Fs._next=this:yo=this,Fs=this),this._call=t,this._time=n,Al()},stop:function(){this._call&&(this._call=null,this._time=1/0,Al())}};function mm(t,e,n){var r=new vo;return r.restart(t,e,n),r}function $w(){gc(),++qr;for(var t=yo,e;t;)(e=or-t._time)>=0&&t._call.call(void 0,e),t=t._next;--qr}function Mf(){or=(go=Qs.now())+su,qr=Ds=0;try{$w()}finally{qr=0,zw(),or=0}}function jw(){var t=Qs.now(),e=t-go;e>dm&&(su-=e,go=t)}function zw(){for(var t,e=yo,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:yo=n);Fs=t,Al(r)}function Al(t){if(!qr){Ds&&(Ds=clearTimeout(Ds));var e=t-or;e>24?(t<1/0&&(Ds=setTimeout(Mf,t-Qs.now()-su)),xs&&(xs=clearInterval(xs))):(xs||(go=Qs.now(),xs=setInterval(jw,dm)),qr=1,pm(Mf))}}function Nf(t,e,n){var r=new vo;return e=e==null?0:+e,r.restart(s=>{r.stop(),t(s+e)},e,n),r}var qw=Gp("start","end","cancel","interrupt"),Ww=[],ym=0,Ef=1,Cl=2,Ga=3,Of=4,kl=5,Ka=6;function au(t,e,n,r,s,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Hw(t,n,{name:e,index:r,group:s,on:qw,tween:Ww,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:ym})}function vc(t,e){var n=pn(t,e);if(n.state>ym)throw new Error("too late; already scheduled");return n}function $n(t,e){var n=pn(t,e);if(n.state>Ga)throw new Error("too late; already running");return n}function pn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Hw(t,e,n){var r=t.__transition,s;r[e]=n,n.timer=mm(a,0,n.time);function a(c){n.state=Ef,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,f,d,m;if(n.state!==Ef)return l();for(h in r)if(m=r[h],m.name===n.name){if(m.state===Ga)return Nf(o);m.state===Of?(m.state=Ka,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[h]):+h<e&&(m.state=Ka,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[h])}if(Nf(function(){n.state===Ga&&(n.state=Of,n.timer.restart(u,n.delay,n.time),u(c))}),n.state=Cl,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Cl){for(n.state=Ga,s=new Array(d=n.tween.length),h=0,f=-1;h<d;++h)(m=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(s[++f]=m);s.length=f+1}}function u(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=kl,1),f=-1,d=s.length;++f<d;)s[f].call(t,h);n.state===kl&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Ka,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Yw(t,e){var n=t.__transition,r,s,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}s=r.state>Cl&&r.state<kl,r.state=Ka,r.timer.stop(),r.on.call(s?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function Gw(t){return this.each(function(){Yw(this,t)})}function Kw(t,e){var n,r;return function(){var s=$n(this,t),a=s.tween;if(a!==n){r=n=a;for(var o=0,u=r.length;o<u;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}s.tween=r}}function Qw(t,e,n){var r,s;if(typeof n!="function")throw new Error;return function(){var a=$n(this,t),o=a.tween;if(o!==r){s=(r=o).slice();for(var u={name:e,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===e){s[l]=u;break}l===c&&s.push(u)}a.tween=s}}function Jw(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=pn(this.node(),n).tween,s=0,a=r.length,o;s<a;++s)if((o=r[s]).name===t)return o.value;return null}return this.each((e==null?Kw:Qw)(n,t,e))}function _c(t,e,n){var r=t._id;return t.each(function(){var s=$n(this,r);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return pn(s,r).value[e]}}function gm(t,e){var n;return(typeof e=="number"?nn:e instanceof ar?mo:(n=ar(e))?(e=n,mo):cm)(t,e)}function Xw(t){return function(){this.removeAttribute(t)}}function Zw(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tx(t,e,n){var r,s=n+"",a;return function(){var o=this.getAttribute(t);return o===s?null:o===r?a:a=e(r=o,n)}}function ex(t,e,n){var r,s=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===r?a:a=e(r=o,n)}}function nx(t,e,n){var r,s,a;return function(){var o,u=n(this),l;return u==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=u+"",o===l?null:o===r&&l===s?a:(s=l,a=e(r=o,u)))}}function ix(t,e,n){var r,s,a;return function(){var o,u=n(this),l;return u==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=u+"",o===l?null:o===r&&l===s?a:(s=l,a=e(r=o,u)))}}function rx(t,e){var n=ru(t),r=n==="transform"?Vw:gm;return this.attrTween(t,typeof e=="function"?(n.local?ix:nx)(n,r,_c(this,"attr."+t,e)):e==null?(n.local?Zw:Xw)(n):(n.local?ex:tx)(n,r,e))}function sx(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ax(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ox(t,e){var n,r;function s(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&ax(t,a)),n}return s._value=e,s}function ux(t,e){var n,r;function s(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&sx(t,a)),n}return s._value=e,s}function lx(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ru(t);return this.tween(n,(r.local?ox:ux)(r,e))}function cx(t,e){return function(){vc(this,t).delay=+e.apply(this,arguments)}}function hx(t,e){return e=+e,function(){vc(this,t).delay=e}}function fx(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?cx:hx)(e,t)):pn(this.node(),e).delay}function dx(t,e){return function(){$n(this,t).duration=+e.apply(this,arguments)}}function px(t,e){return e=+e,function(){$n(this,t).duration=e}}function mx(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?dx:px)(e,t)):pn(this.node(),e).duration}function yx(t,e){if(typeof e!="function")throw new Error;return function(){$n(this,t).ease=e}}function gx(t){var e=this._id;return arguments.length?this.each(yx(e,t)):pn(this.node(),e).ease}function vx(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;$n(this,t).ease=n}}function _x(t){if(typeof t!="function")throw new Error;return this.each(vx(this._id,t))}function bx(t){typeof t!="function"&&(t=Jp(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var a=e[s],o=a.length,u=r[s]=[],l,c=0;c<o;++c)(l=a[c])&&t.call(l,l.__data__,c,a)&&u.push(l);return new ei(r,this._parents,this._name,this._id)}function wx(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,s=n.length,a=Math.min(r,s),o=new Array(r),u=0;u<a;++u)for(var l=e[u],c=n[u],h=l.length,f=o[u]=new Array(h),d,m=0;m<h;++m)(d=l[m]||c[m])&&(f[m]=d);for(;u<r;++u)o[u]=e[u];return new ei(o,this._parents,this._name,this._id)}function xx(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Sx(t,e,n){var r,s,a=xx(e)?vc:$n;return function(){var o=a(this,t),u=o.on;u!==r&&(s=(r=u).copy()).on(e,n),o.on=s}}function Ix(t,e){var n=this._id;return arguments.length<2?pn(this.node(),n).on.on(t):this.each(Sx(n,t,e))}function Tx(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ax(){return this.on("end.remove",Tx(this._id))}function Cx(t){var e=this._name,n=this._id;typeof t!="function"&&(t=fc(t));for(var r=this._groups,s=r.length,a=new Array(s),o=0;o<s;++o)for(var u=r[o],l=u.length,c=a[o]=new Array(l),h,f,d=0;d<l;++d)(h=u[d])&&(f=t.call(h,h.__data__,d,u))&&("__data__"in h&&(f.__data__=h.__data__),c[d]=f,au(c[d],e,n,d,c,pn(h,n)));return new ei(a,this._parents,e,n)}function kx(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Qp(t));for(var r=this._groups,s=r.length,a=[],o=[],u=0;u<s;++u)for(var l=r[u],c=l.length,h,f=0;f<c;++f)if(h=l[f]){for(var d=t.call(h,h.__data__,f,l),m,p=pn(h,n),g=0,y=d.length;g<y;++g)(m=d[g])&&au(m,e,n,g,d,p);a.push(d),o.push(h)}return new ei(a,o,e,n)}var Mx=pa.prototype.constructor;function Nx(){return new Mx(this._groups,this._parents)}function Ex(t,e){var n,r,s;return function(){var a=zr(this,t),o=(this.style.removeProperty(t),zr(this,t));return a===o?null:a===n&&o===r?s:s=e(n=a,r=o)}}function vm(t){return function(){this.style.removeProperty(t)}}function Ox(t,e,n){var r,s=n+"",a;return function(){var o=zr(this,t);return o===s?null:o===r?a:a=e(r=o,n)}}function Dx(t,e,n){var r,s,a;return function(){var o=zr(this,t),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(t),zr(this,t))),o===l?null:o===r&&l===s?a:(s=l,a=e(r=o,u))}}function Fx(t,e){var n,r,s,a="style."+e,o="end."+a,u;return function(){var l=$n(this,t),c=l.on,h=l.value[a]==null?u||(u=vm(e)):void 0;(c!==n||s!==h)&&(r=(n=c).copy()).on(o,s=h),l.on=r}}function Bx(t,e,n){var r=(t+="")=="transform"?Pw:gm;return e==null?this.styleTween(t,Ex(t,r)).on("end.style."+t,vm(t)):typeof e=="function"?this.styleTween(t,Dx(t,r,_c(this,"style."+t,e))).each(Fx(this._id,t)):this.styleTween(t,Ox(t,r,e),n).on("end.style."+t,null)}function Rx(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Lx(t,e,n){var r,s;function a(){var o=e.apply(this,arguments);return o!==s&&(r=(s=o)&&Rx(t,o,n)),r}return a._value=e,a}function Px(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Lx(t,e,n??""))}function Vx(t){return function(){this.textContent=t}}function Ux(t){return function(){var e=t(this);this.textContent=e??""}}function $x(t){return this.tween("text",typeof t=="function"?Ux(_c(this,"text",t)):Vx(t==null?"":t+""))}function jx(t){return function(e){this.textContent=t.call(this,e)}}function zx(t){var e,n;function r(){var s=t.apply(this,arguments);return s!==n&&(e=(n=s)&&jx(s)),e}return r._value=t,r}function qx(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,zx(t))}function Wx(){for(var t=this._name,e=this._id,n=_m(),r=this._groups,s=r.length,a=0;a<s;++a)for(var o=r[a],u=o.length,l,c=0;c<u;++c)if(l=o[c]){var h=pn(l,e);au(l,t,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new ei(r,this._parents,t,n)}function Hx(){var t,e,n=this,r=n._id,s=n.size();return new Promise(function(a,o){var u={value:o},l={value:function(){--s===0&&a()}};n.each(function(){var c=$n(this,r),h=c.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),c.on=e}),s===0&&a()})}var Yx=0;function ei(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function _m(){return++Yx}var qn=pa.prototype;ei.prototype={constructor:ei,select:Cx,selectAll:kx,selectChild:qn.selectChild,selectChildren:qn.selectChildren,filter:bx,merge:wx,selection:Nx,transition:Wx,call:qn.call,nodes:qn.nodes,node:qn.node,size:qn.size,empty:qn.empty,each:qn.each,on:Ix,attr:rx,attrTween:lx,style:Bx,styleTween:Px,text:$x,textTween:qx,remove:Ax,tween:Jw,delay:fx,duration:mx,ease:gx,easeVarying:_x,end:Hx,[Symbol.iterator]:qn[Symbol.iterator]};function Gx(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Kx={time:null,delay:0,duration:250,ease:Gx};function Qx(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Jx(t){var e,n;t instanceof ei?(e=t._id,t=t._name):(e=_m(),(n=Kx).time=gc(),t=t==null?null:t+"");for(var r=this._groups,s=r.length,a=0;a<s;++a)for(var o=r[a],u=o.length,l,c=0;c<u;++c)(l=o[c])&&au(l,t,e,c,o,n||Qx(l,e));return new ei(r,this._parents,t,e)}pa.prototype.interrupt=Gw;pa.prototype.transition=Jx;var Df={},Lu={},Pu=34,Ss=10,Vu=13;function bm(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function Xx(t,e){var n=bm(t);return function(r,s){return e(n(r),s,t)}}function Ff(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var s in r)s in e||n.push(e[s]=s)}),n}function ye(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Zx(t){return t<0?"-"+ye(-t,6):t>9999?"+"+ye(t,6):ye(t,4)}function tS(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),s=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Zx(t.getUTCFullYear())+"-"+ye(t.getUTCMonth()+1,2)+"-"+ye(t.getUTCDate(),2)+(s?"T"+ye(e,2)+":"+ye(n,2)+":"+ye(r,2)+"."+ye(s,3)+"Z":r?"T"+ye(e,2)+":"+ye(n,2)+":"+ye(r,2)+"Z":n||e?"T"+ye(e,2)+":"+ye(n,2)+"Z":"")}function wm(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(f,d){var m,p,g=s(f,function(y,_){if(m)return m(y,_-1);p=y,m=d?Xx(y,d):bm(y)});return g.columns=p||[],g}function s(f,d){var m=[],p=f.length,g=0,y=0,_,b=p<=0,A=!1;f.charCodeAt(p-1)===Ss&&--p,f.charCodeAt(p-1)===Vu&&--p;function S(){if(b)return Lu;if(A)return A=!1,Df;var x,C=g,T;if(f.charCodeAt(C)===Pu){for(;g++<p&&f.charCodeAt(g)!==Pu||f.charCodeAt(++g)===Pu;);return(x=g)>=p?b=!0:(T=f.charCodeAt(g++))===Ss?A=!0:T===Vu&&(A=!0,f.charCodeAt(g)===Ss&&++g),f.slice(C+1,x-1).replace(/""/g,'"')}for(;g<p;){if((T=f.charCodeAt(x=g++))===Ss)A=!0;else if(T===Vu)A=!0,f.charCodeAt(g)===Ss&&++g;else if(T!==n)continue;return f.slice(C,x)}return b=!0,f.slice(C,p)}for(;(_=S())!==Lu;){for(var I=[];_!==Df&&_!==Lu;)I.push(_),_=S();d&&(I=d(I,y++))==null||m.push(I)}return m}function a(f,d){return f.map(function(m){return d.map(function(p){return h(m[p])}).join(t)})}function o(f,d){return d==null&&(d=Ff(f)),[d.map(h).join(t)].concat(a(f,d)).join(`
`)}function u(f,d){return d==null&&(d=Ff(f)),a(f,d).join(`
`)}function l(f){return f.map(c).join(`
`)}function c(f){return f.map(h).join(t)}function h(f){return f==null?"":f instanceof Date?tS(f):e.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:s,format:o,formatBody:u,formatRows:l,formatRow:c,formatValue:h}}var eS=wm(","),Bf=eS.parse,nS=wm("	"),Rf=nS.parse;function iS(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function _o(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Wr(t){return t=_o(Math.abs(t)),t?t[1]:NaN}function rS(t,e){return function(n,r){for(var s=n.length,a=[],o=0,u=t[0],l=0;s>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),a.push(n.substring(s-=u,s+u)),!((l+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}function sS(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var aS=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Js(t){if(!(e=aS.exec(t)))throw new Error("invalid format: "+t);var e;return new bc({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Js.prototype=bc.prototype;function bc(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}bc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oS(t){t:for(var e=t.length,n=1,r=-1,s;n<e;++n)switch(t[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(s+1):t}var xm;function uS(t,e){var n=_o(t,e);if(!n)return t+"";var r=n[0],s=n[1],a=s-(xm=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+_o(t,Math.max(0,e+a-1))[0]}function Lf(t,e){var n=_o(t,e);if(!n)return t+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const Pf={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:iS,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Lf(t*100,e),r:Lf,s:uS,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Vf(t){return t}var Uf=Array.prototype.map,$f=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function lS(t){var e=t.grouping===void 0||t.thousands===void 0?Vf:rS(Uf.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Vf:sS(Uf.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(f){f=Js(f);var d=f.fill,m=f.align,p=f.sign,g=f.symbol,y=f.zero,_=f.width,b=f.comma,A=f.precision,S=f.trim,I=f.type;I==="n"?(b=!0,I="g"):Pf[I]||(A===void 0&&(A=12),S=!0,I="g"),(y||d==="0"&&m==="=")&&(y=!0,d="0",m="=");var x=g==="$"?n:g==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():"",C=g==="$"?r:/[%p]/.test(I)?o:"",T=Pf[I],N=/[defgprs%]/.test(I);A=A===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function E(k){var R=x,D=C,X,ft,Dt;if(I==="c")D=T(k)+D,k="";else{k=+k;var Pt=k<0||1/k<0;if(k=isNaN(k)?l:T(Math.abs(k),A),S&&(k=oS(k)),Pt&&+k==0&&p!=="+"&&(Pt=!1),R=(Pt?p==="("?p:u:p==="-"||p==="("?"":p)+R,D=(I==="s"?$f[8+xm/3]:"")+D+(Pt&&p==="("?")":""),N){for(X=-1,ft=k.length;++X<ft;)if(Dt=k.charCodeAt(X),48>Dt||Dt>57){D=(Dt===46?s+k.slice(X+1):k.slice(X))+D,k=k.slice(0,X);break}}}b&&!y&&(k=e(k,1/0));var Q=R.length+k.length+D.length,_t=Q<_?new Array(_-Q+1).join(d):"";switch(b&&y&&(k=e(_t+k,_t.length?_-D.length:1/0),_t=""),m){case"<":k=R+k+D+_t;break;case"=":k=R+_t+k+D;break;case"^":k=_t.slice(0,Q=_t.length>>1)+R+k+D+_t.slice(Q);break;default:k=_t+R+k+D;break}return a(k)}return E.toString=function(){return f+""},E}function h(f,d){var m=c((f=Js(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Wr(d)/3)))*3,g=Math.pow(10,-p),y=$f[8+p/3];return function(_){return m(g*_)+y}}return{format:c,formatPrefix:h}}var Va,Hr,Sm;cS({thousands:",",grouping:[3],currency:["$",""]});function cS(t){return Va=lS(t),Hr=Va.format,Sm=Va.formatPrefix,Va}function hS(t){return Math.max(0,-Wr(Math.abs(t)))}function fS(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wr(e)/3)))*3-Wr(Math.abs(t)))}function dS(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wr(e)-Wr(t))+1}function ls(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const jf=Symbol("implicit");function wc(){var t=new mf,e=[],n=[],r=jf;function s(a){let o=t.get(a);if(o===void 0){if(r!==jf)return r;t.set(a,o=e.push(a)-1)}return n[o%n.length]}return s.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new mf;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return s},s.range=function(a){return arguments.length?(n=Array.from(a),s):n.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return wc(e,n).unknown(r)},ls.apply(s,arguments),s}function pS(t){return function(){return t}}function mS(t){return+t}var zf=[0,1];function On(t){return t}function Ml(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:pS(isNaN(e)?NaN:.5)}function yS(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function gS(t,e,n){var r=t[0],s=t[1],a=e[0],o=e[1];return s<r?(r=Ml(s,r),a=n(o,a)):(r=Ml(r,s),a=n(a,o)),function(u){return a(r(u))}}function vS(t,e,n){var r=Math.min(t.length,e.length)-1,s=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)s[o]=Ml(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(u){var l=Yp(t,u,1,r)-1;return a[l](s[l](u))}}function ya(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ou(){var t=zf,e=zf,n=yc,r,s,a,o=On,u,l,c;function h(){var d=Math.min(t.length,e.length);return o!==On&&(o=yS(t[0],t[d-1])),u=d>2?vS:gS,l=c=null,f}function f(d){return d==null||isNaN(d=+d)?a:(l||(l=u(t.map(r),e,n)))(r(o(d)))}return f.invert=function(d){return o(s((c||(c=u(e,t.map(r),nn)))(d)))},f.domain=function(d){return arguments.length?(t=Array.from(d,mS),h()):t.slice()},f.range=function(d){return arguments.length?(e=Array.from(d),h()):e.slice()},f.rangeRound=function(d){return e=Array.from(d),n=Bw,h()},f.clamp=function(d){return arguments.length?(o=d?!0:On,h()):o!==On},f.interpolate=function(d){return arguments.length?(n=d,h()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,m){return r=d,s=m,h()}}function Im(){return ou()(On,On)}function _S(t,e,n,r){var s=wl(t,e,n),a;switch(r=Js(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=fS(s,o))&&(r.precision=a),Sm(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=dS(s,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=hS(s))&&(r.precision=a-(r.type==="%")*2);break}}return Hr(r)}function xc(t){var e=t.domain;return t.ticks=function(n){var r=e();return co(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var s=e();return _S(s[0],s[s.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),s=0,a=r.length-1,o=r[s],u=r[a],l,c,h=10;for(u<o&&(c=o,o=u,u=c,c=s,s=a,a=c);h-- >0;){if(c=jr(o,u,n),c===l)return r[s]=o,r[a]=u,e(r);if(c>0)o=Math.floor(o/c)*c,u=Math.ceil(u/c)*c;else if(c<0)o=Math.ceil(o*c)/c,u=Math.floor(u*c)/c;else break;l=c}return t},t}function Sc(){var t=Im();return t.copy=function(){return ya(t,Sc())},ls.apply(t,arguments),xc(t)}function Tm(t,e){t=t.slice();var n=0,r=t.length-1,s=t[n],a=t[r],o;return a<s&&(o=n,n=r,r=o,o=s,s=a,a=o),t[n]=e.floor(s),t[r]=e.ceil(a),t}function qf(t){return Math.log(t)}function Wf(t){return Math.exp(t)}function bS(t){return-Math.log(-t)}function wS(t){return-Math.exp(-t)}function xS(t){return isFinite(t)?+("1e"+t):t<0?0:t}function SS(t){return t===10?xS:t===Math.E?Math.exp:e=>Math.pow(t,e)}function IS(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Hf(t){return(e,n)=>-t(-e,n)}function TS(t){const e=t(qf,Wf),n=e.domain;let r=10,s,a;function o(){return s=IS(r),a=SS(r),n()[0]<0?(s=Hf(s),a=Hf(a),t(bS,wS)):t(qf,Wf),e}return e.base=function(u){return arguments.length?(r=+u,o()):r},e.domain=function(u){return arguments.length?(n(u),o()):n()},e.ticks=u=>{const l=n();let c=l[0],h=l[l.length-1];const f=h<c;f&&([c,h]=[h,c]);let d=s(c),m=s(h),p,g;const y=u==null?10:+u;let _=[];if(!(r%1)&&m-d<y){if(d=Math.floor(d),m=Math.ceil(m),c>0){for(;d<=m;++d)for(p=1;p<r;++p)if(g=d<0?p/a(-d):p*a(d),!(g<c)){if(g>h)break;_.push(g)}}else for(;d<=m;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/a(-d):p*a(d),!(g<c)){if(g>h)break;_.push(g)}_.length*2<y&&(_=co(c,h,y))}else _=co(d,m,Math.min(m-d,y)).map(a);return f?_.reverse():_},e.tickFormat=(u,l)=>{if(u==null&&(u=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Js(l)).precision==null&&(l.trim=!0),l=Hr(l)),u===1/0)return l;const c=Math.max(1,r*u/e.ticks().length);return h=>{let f=h/a(Math.round(s(h)));return f*r<r-.5&&(f*=r),f<=c?l(h):""}},e.nice=()=>n(Tm(n(),{floor:u=>a(Math.floor(s(u))),ceil:u=>a(Math.ceil(s(u)))})),e}function Am(){const t=TS(ou()).domain([1,10]);return t.copy=()=>ya(t,Am()).base(t.base()),ls.apply(t,arguments),t}function Yf(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Gf(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function AS(t){var e=1,n=t(Yf(e),Gf(e));return n.constant=function(r){return arguments.length?t(Yf(e=+r),Gf(e)):e},xc(n)}function Cm(){var t=AS(ou());return t.copy=function(){return ya(t,Cm()).constant(t.constant())},ls.apply(t,arguments)}function Kf(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function CS(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function kS(t){return t<0?-t*t:t*t}function MS(t){var e=t(On,On),n=1;function r(){return n===1?t(On,On):n===.5?t(CS,kS):t(Kf(n),Kf(1/n))}return e.exponent=function(s){return arguments.length?(n=+s,r()):n},xc(e)}function Ic(){var t=MS(ou());return t.copy=function(){return ya(t,Ic()).exponent(t.exponent())},ls.apply(t,arguments),t}function NS(){return Ic.apply(null,arguments).exponent(.5)}const Uu=new Date,$u=new Date;function Wt(t,e,n,r){function s(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(t(a=new Date(+a)),a),s.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),s.round=a=>{const o=s(a),u=s.ceil(a);return a-o<u-a?o:u},s.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),s.range=(a,o,u)=>{const l=[];if(a=s.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return l;let c;do l.push(c=new Date(+a)),e(a,u),t(a);while(c<a&&a<o);return l},s.filter=a=>Wt(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,u)=>{if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););}),n&&(s.count=(a,o)=>(Uu.setTime(+a),$u.setTime(+o),t(Uu),t($u),Math.floor(n(Uu,$u))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(r?o=>r(o)%a===0:o=>s.count(0,o)%a===0):s)),s}const bo=Wt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);bo.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Wt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):bo);bo.range;const Xn=1e3,Ge=Xn*60,Zn=Ge*60,ni=Zn*24,Tc=ni*7,Qf=ni*30,ju=ni*365,Ir=Wt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Xn)},(t,e)=>(e-t)/Xn,t=>t.getUTCSeconds());Ir.range;const Ac=Wt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Xn)},(t,e)=>{t.setTime(+t+e*Ge)},(t,e)=>(e-t)/Ge,t=>t.getMinutes());Ac.range;const ES=Wt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ge)},(t,e)=>(e-t)/Ge,t=>t.getUTCMinutes());ES.range;const Cc=Wt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Xn-t.getMinutes()*Ge)},(t,e)=>{t.setTime(+t+e*Zn)},(t,e)=>(e-t)/Zn,t=>t.getHours());Cc.range;const OS=Wt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Zn)},(t,e)=>(e-t)/Zn,t=>t.getUTCHours());OS.range;const ga=Wt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ge)/ni,t=>t.getDate()-1);ga.range;const kc=Wt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ni,t=>t.getUTCDate()-1);kc.range;const DS=Wt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ni,t=>Math.floor(t/ni));DS.range;function dr(t){return Wt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ge)/Tc)}const uu=dr(0),wo=dr(1),FS=dr(2),BS=dr(3),Yr=dr(4),RS=dr(5),LS=dr(6);uu.range;wo.range;FS.range;BS.range;Yr.range;RS.range;LS.range;function pr(t){return Wt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Tc)}const km=pr(0),xo=pr(1),PS=pr(2),VS=pr(3),Gr=pr(4),US=pr(5),$S=pr(6);km.range;xo.range;PS.range;VS.range;Gr.range;US.range;$S.range;const Mc=Wt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Mc.range;const jS=Wt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());jS.range;const ii=Wt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ii.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});ii.range;const ur=Wt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ur.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});ur.range;function zS(t,e,n,r,s,a){const o=[[Ir,1,Xn],[Ir,5,5*Xn],[Ir,15,15*Xn],[Ir,30,30*Xn],[a,1,Ge],[a,5,5*Ge],[a,15,15*Ge],[a,30,30*Ge],[s,1,Zn],[s,3,3*Zn],[s,6,6*Zn],[s,12,12*Zn],[r,1,ni],[r,2,2*ni],[n,1,Tc],[e,1,Qf],[e,3,3*Qf],[t,1,ju]];function u(c,h,f){const d=h<c;d&&([c,h]=[h,c]);const m=f&&typeof f.range=="function"?f:l(c,h,f),p=m?m.range(c,+h+1):[];return d?p.reverse():p}function l(c,h,f){const d=Math.abs(h-c)/f,m=hc(([,,y])=>y).right(o,d);if(m===o.length)return t.every(wl(c/ju,h/ju,f));if(m===0)return bo.every(Math.max(wl(c,h,f),1));const[p,g]=o[d/o[m-1][2]<o[m][2]/d?m-1:m];return p.every(g)}return[u,l]}const[qS,WS]=zS(ii,Mc,uu,ga,Cc,Ac);function zu(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function qu(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Is(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function HS(t){var e=t.dateTime,n=t.date,r=t.time,s=t.periods,a=t.days,o=t.shortDays,u=t.months,l=t.shortMonths,c=Ts(s),h=As(s),f=Ts(a),d=As(a),m=Ts(o),p=As(o),g=Ts(u),y=As(u),_=Ts(l),b=As(l),A={a:Pt,A:Q,b:_t,B:L,c:null,d:nd,e:nd,f:m2,g:T2,G:C2,H:f2,I:d2,j:p2,L:Mm,m:y2,M:g2,p:Kt,q:yn,Q:sd,s:ad,S:v2,u:_2,U:b2,V:w2,w:x2,W:S2,x:null,X:null,y:I2,Y:A2,Z:k2,"%":rd},S={a:Pe,A:Wi,b:yi,B:Hi,c:null,d:id,e:id,f:O2,g:j2,G:q2,H:M2,I:N2,j:E2,L:Em,m:D2,M:F2,p:Yi,q:Na,Q:sd,s:ad,S:B2,u:R2,U:L2,V:P2,w:V2,W:U2,x:null,X:null,y:$2,Y:z2,Z:W2,"%":rd},I={a:E,A:k,b:R,B:D,c:X,d:td,e:td,f:u2,g:Zf,G:Xf,H:ed,I:ed,j:r2,L:o2,m:i2,M:s2,p:N,q:n2,Q:c2,s:h2,S:a2,u:JS,U:XS,V:ZS,w:QS,W:t2,x:ft,X:Dt,y:Zf,Y:Xf,Z:e2,"%":l2};A.x=x(n,A),A.X=x(r,A),A.c=x(e,A),S.x=x(n,S),S.X=x(r,S),S.c=x(e,S);function x(F,st){return function(lt){var M=[],Qt=-1,O=0,$=F.length,U,dt,Mt;for(lt instanceof Date||(lt=new Date(+lt));++Qt<$;)F.charCodeAt(Qt)===37&&(M.push(F.slice(O,Qt)),(dt=Jf[U=F.charAt(++Qt)])!=null?U=F.charAt(++Qt):dt=U==="e"?" ":"0",(Mt=st[U])&&(U=Mt(lt,dt)),M.push(U),O=Qt+1);return M.push(F.slice(O,Qt)),M.join("")}}function C(F,st){return function(lt){var M=Is(1900,void 0,1),Qt=T(M,F,lt+="",0),O,$;if(Qt!=lt.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(st&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(O=qu(Is(M.y,0,1)),$=O.getUTCDay(),O=$>4||$===0?xo.ceil(O):xo(O),O=kc.offset(O,(M.V-1)*7),M.y=O.getUTCFullYear(),M.m=O.getUTCMonth(),M.d=O.getUTCDate()+(M.w+6)%7):(O=zu(Is(M.y,0,1)),$=O.getDay(),O=$>4||$===0?wo.ceil(O):wo(O),O=ga.offset(O,(M.V-1)*7),M.y=O.getFullYear(),M.m=O.getMonth(),M.d=O.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),$="Z"in M?qu(Is(M.y,0,1)).getUTCDay():zu(Is(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-($+5)%7:M.w+M.U*7-($+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,qu(M)):zu(M)}}function T(F,st,lt,M){for(var Qt=0,O=st.length,$=lt.length,U,dt;Qt<O;){if(M>=$)return-1;if(U=st.charCodeAt(Qt++),U===37){if(U=st.charAt(Qt++),dt=I[U in Jf?st.charAt(Qt++):U],!dt||(M=dt(F,lt,M))<0)return-1}else if(U!=lt.charCodeAt(M++))return-1}return M}function N(F,st,lt){var M=c.exec(st.slice(lt));return M?(F.p=h.get(M[0].toLowerCase()),lt+M[0].length):-1}function E(F,st,lt){var M=m.exec(st.slice(lt));return M?(F.w=p.get(M[0].toLowerCase()),lt+M[0].length):-1}function k(F,st,lt){var M=f.exec(st.slice(lt));return M?(F.w=d.get(M[0].toLowerCase()),lt+M[0].length):-1}function R(F,st,lt){var M=_.exec(st.slice(lt));return M?(F.m=b.get(M[0].toLowerCase()),lt+M[0].length):-1}function D(F,st,lt){var M=g.exec(st.slice(lt));return M?(F.m=y.get(M[0].toLowerCase()),lt+M[0].length):-1}function X(F,st,lt){return T(F,e,st,lt)}function ft(F,st,lt){return T(F,n,st,lt)}function Dt(F,st,lt){return T(F,r,st,lt)}function Pt(F){return o[F.getDay()]}function Q(F){return a[F.getDay()]}function _t(F){return l[F.getMonth()]}function L(F){return u[F.getMonth()]}function Kt(F){return s[+(F.getHours()>=12)]}function yn(F){return 1+~~(F.getMonth()/3)}function Pe(F){return o[F.getUTCDay()]}function Wi(F){return a[F.getUTCDay()]}function yi(F){return l[F.getUTCMonth()]}function Hi(F){return u[F.getUTCMonth()]}function Yi(F){return s[+(F.getUTCHours()>=12)]}function Na(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var st=x(F+="",A);return st.toString=function(){return F},st},parse:function(F){var st=C(F+="",!1);return st.toString=function(){return F},st},utcFormat:function(F){var st=x(F+="",S);return st.toString=function(){return F},st},utcParse:function(F){var st=C(F+="",!0);return st.toString=function(){return F},st}}}var Jf={"-":"",_:" ",0:"0"},Gt=/^\s*\d+/,YS=/^%/,GS=/[\\^$*+?|[\]().{}]/g;function xt(t,e,n){var r=t<0?"-":"",s=(r?-t:t)+"",a=s.length;return r+(a<n?new Array(n-a+1).join(e)+s:s)}function KS(t){return t.replace(GS,"\\$&")}function Ts(t){return new RegExp("^(?:"+t.map(KS).join("|")+")","i")}function As(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function QS(t,e,n){var r=Gt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function JS(t,e,n){var r=Gt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function XS(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function ZS(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function t2(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Xf(t,e,n){var r=Gt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Zf(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function e2(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function n2(t,e,n){var r=Gt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function i2(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function td(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function r2(t,e,n){var r=Gt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ed(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function s2(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function a2(t,e,n){var r=Gt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function o2(t,e,n){var r=Gt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function u2(t,e,n){var r=Gt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function l2(t,e,n){var r=YS.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function c2(t,e,n){var r=Gt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function h2(t,e,n){var r=Gt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function nd(t,e){return xt(t.getDate(),e,2)}function f2(t,e){return xt(t.getHours(),e,2)}function d2(t,e){return xt(t.getHours()%12||12,e,2)}function p2(t,e){return xt(1+ga.count(ii(t),t),e,3)}function Mm(t,e){return xt(t.getMilliseconds(),e,3)}function m2(t,e){return Mm(t,e)+"000"}function y2(t,e){return xt(t.getMonth()+1,e,2)}function g2(t,e){return xt(t.getMinutes(),e,2)}function v2(t,e){return xt(t.getSeconds(),e,2)}function _2(t){var e=t.getDay();return e===0?7:e}function b2(t,e){return xt(uu.count(ii(t)-1,t),e,2)}function Nm(t){var e=t.getDay();return e>=4||e===0?Yr(t):Yr.ceil(t)}function w2(t,e){return t=Nm(t),xt(Yr.count(ii(t),t)+(ii(t).getDay()===4),e,2)}function x2(t){return t.getDay()}function S2(t,e){return xt(wo.count(ii(t)-1,t),e,2)}function I2(t,e){return xt(t.getFullYear()%100,e,2)}function T2(t,e){return t=Nm(t),xt(t.getFullYear()%100,e,2)}function A2(t,e){return xt(t.getFullYear()%1e4,e,4)}function C2(t,e){var n=t.getDay();return t=n>=4||n===0?Yr(t):Yr.ceil(t),xt(t.getFullYear()%1e4,e,4)}function k2(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+xt(e/60|0,"0",2)+xt(e%60,"0",2)}function id(t,e){return xt(t.getUTCDate(),e,2)}function M2(t,e){return xt(t.getUTCHours(),e,2)}function N2(t,e){return xt(t.getUTCHours()%12||12,e,2)}function E2(t,e){return xt(1+kc.count(ur(t),t),e,3)}function Em(t,e){return xt(t.getUTCMilliseconds(),e,3)}function O2(t,e){return Em(t,e)+"000"}function D2(t,e){return xt(t.getUTCMonth()+1,e,2)}function F2(t,e){return xt(t.getUTCMinutes(),e,2)}function B2(t,e){return xt(t.getUTCSeconds(),e,2)}function R2(t){var e=t.getUTCDay();return e===0?7:e}function L2(t,e){return xt(km.count(ur(t)-1,t),e,2)}function Om(t){var e=t.getUTCDay();return e>=4||e===0?Gr(t):Gr.ceil(t)}function P2(t,e){return t=Om(t),xt(Gr.count(ur(t),t)+(ur(t).getUTCDay()===4),e,2)}function V2(t){return t.getUTCDay()}function U2(t,e){return xt(xo.count(ur(t)-1,t),e,2)}function $2(t,e){return xt(t.getUTCFullYear()%100,e,2)}function j2(t,e){return t=Om(t),xt(t.getUTCFullYear()%100,e,2)}function z2(t,e){return xt(t.getUTCFullYear()%1e4,e,4)}function q2(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Gr(t):Gr.ceil(t),xt(t.getUTCFullYear()%1e4,e,4)}function W2(){return"+0000"}function rd(){return"%"}function sd(t){return+t}function ad(t){return Math.floor(+t/1e3)}var gr,So;H2({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function H2(t){return gr=HS(t),So=gr.format,gr.parse,gr.utcFormat,gr.utcParse,gr}function Y2(t){return new Date(t)}function G2(t){return t instanceof Date?+t:+new Date(+t)}function Dm(t,e,n,r,s,a,o,u,l,c){var h=Im(),f=h.invert,d=h.domain,m=c(".%L"),p=c(":%S"),g=c("%I:%M"),y=c("%I %p"),_=c("%a %d"),b=c("%b %d"),A=c("%B"),S=c("%Y");function I(x){return(l(x)<x?m:u(x)<x?p:o(x)<x?g:a(x)<x?y:r(x)<x?s(x)<x?_:b:n(x)<x?A:S)(x)}return h.invert=function(x){return new Date(f(x))},h.domain=function(x){return arguments.length?d(Array.from(x,G2)):d().map(Y2)},h.ticks=function(x){var C=d();return t(C[0],C[C.length-1],x??10)},h.tickFormat=function(x,C){return C==null?I:c(C)},h.nice=function(x){var C=d();return(!x||typeof x.range!="function")&&(x=e(C[0],C[C.length-1],x??10)),x?d(Tm(C,x)):h},h.copy=function(){return ya(h,Dm(t,e,n,r,s,a,o,u,l,c))},h}function K2(){return ls.apply(Dm(qS,WS,ii,Mc,uu,ga,Cc,Ac,Ir,So).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Bs(t,e,n){this.k=t,this.x=e,this.y=n}Bs.prototype={constructor:Bs,scale:function(t){return t===1?this:new Bs(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Bs(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Bs.prototype;function Xs(t,e,n,r){if(t.length==0)return"";if(t.length==1)return t[0];if(t.length==2&&n)return`${t[0]} ${r||"and"} ${t[1]}`;if(t.length==2&&!n)return`${t[0]}${e||" "}${t[1]} `;if(n){let s=t[t.length-1];return t.slice(0,t.length-1).join(e)+e+`${r||"and"}`+s}else return t.join(e)}function Io(t){return["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","nineth","tenth","eleventh","twelveth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth","twentieth","twenty-first","twenty-second","twenty-third"][t]||t+"th"}function Tr(t,e,n){let r={};return t.forEach(s=>{let a={};n?a=P(s):Object.assign(a,s),r[s[e]]=a}),r}const Cs=["sound","list","domain","domain.min","domain.max","domain.length","channel","field","aggregate","title","range.length","range","timeUnit"];function Q2(t,e,n,r,s){if(t.length==0||!t)return[];let a=X2(t),o=n.properties,u=[];for(const c of a)if(c.type==="text")c.speechRate=r,u.push(c);else if(c.key==="sound"){let h={type:"sound"};ot(c.value)==="Array"?(h.continuous=!0,h.value=c.value.map(f=>od(f,e,o,s))):(h.continuous=!1,h.value=od(c.value,e,o,s)),c.duration?h.duration=c.duration:h.continuous?h.duration=(s==="beat"?1:.5)*h.value.length:h.duration=s==="beat"?1:.5,u.push(h)}else if(c.key==="list"){let h=c.item;h||(h=Nl("domain",e,o,s));let f=b=>b;o.format&&(o.formatType==="number"?f=Hr(o.format):o.formatType==="datetime"&&(f=So(o.format))),h&&(h=h.map(b=>ot(b)==="Number"?f(b):b));let d=c.first,m=c.last,p={type:"text"},g=[];d&&g.push(...h.slice(0,d)),m&&g.push(...h.slice(h.length-m,h.length));let y=c.join||", ",_=c.and;p.text=Xs(g,y,!!_,_),p.speechRate=r,u.push(p)}else{let h=Nl(c.key,e,o,s),f=d=>(d==null?void 0:d.toString())||"";o.format&&(o.formatType==="number"?f=Hr(o.format):o.formatType==="datetime"&&(f=So(o.format))),ot(h)==="Array"?h=h.map(d=>ot(d)==="Number"?f(d):d):ot(h)!=="String"&&(h=f(h)),u.push({type:"text",text:h,speechRate:r})}let l=[];for(const c of u)l.length>0&&l[l.length-1].type==="text"&&c.type==="text"?l[l.length-1].text+=(c.text.startsWith(".")?"":" ")+c.text.trim():l.push(c);return l}function od(t,e,n,r){return t!=null&&t.literal?t.literal:t!=null&&t.keyword?Nl(t.keyword,e,n,r):void 0}function Nl(t,e,n,r){if(t==="domain")return n.domain.join(", ");if(t==="domain.min")return Math.min(...n.domain);if(t==="domain.max")return Math.max(...n.domain);if(t.match(/domain\[[0-9]+\]/g)){let s=parseInt(t.match(/[0-9]+/g)[0]);return n.domain[s]}else if(t==="domain.length")return n.domain.length;if(t==="range")return n.range.join(", ");if(t==="range.length")return e===at?n.length:Math.max(...n.range)-Math.min(...n.range);if(t==="channel")return e;if(t==="field")return n.field.join(", ");if(t==="title")return n.title;if(t==="aggregate")return n.aggregate;if(t==="timeUnit")return r}const J2=/(\<[^\<\>]+\>|[^\<\>]+)/g;function X2(t){ot(t)!=="String"&&console.error("Wrong description expression type.");let e=t.trim(),n=!1;e.endsWith(".")&&(e=e.substring(0,e.length-1),n=!0);let r=e.match(J2);r||console.error(`Wrong description expression (not parsable): ${t}.`);let s=[];for(const a of r)if(a.startsWith("<")){let o=tI(a);s.push(o)}else s.push({type:"text",text:a});return s[s.length-1].type==="text"&&n&&(s[s.length-1].text+="."),s}const Z2=/(([a-zA-Z0-9\.]+=\"[^\"]+\")|[a-zA-Z\.0-9\[\]]+)/g;function tI(t){let e={},n=t.match(Z2);return n||console.error(`Wrong description keyword expression: ${t}.`),n.forEach((r,s)=>{var a;if(e.type="keyword",s==0)Cs.includes(r)||r.match(/domain\[[0-9]+\]/g)?e.key=r:console.error(`Unidentifiable keyword: ${r}.`);else{let o=r.split("="),u=o[1].replace(/\"/gi,"");if(o[0]==="duration")e.duration=parseFloat(u);else if(o[0]==="first")e.first=parseInt(u);else if(o[0]==="last")e.last=parseInt(u);else if(o[0]==="item")Cs.includes(u)?e.item={keyword:u}:u.match(/domain\[[0-9]+\]/g)?e.item={keyword:u}:e.item={literal:u.split(",").map(l=>l.trim())};else if(o[0]==="value")Cs.includes(u)?e.value={keyword:u}:u.match(/domain\[[0-9]+\]/g)?e.value={keyword:u}:e.value={literal:u};else if(((a=o[0].match(/v[0-9]+/g))==null?void 0:a.length)==1){e.value||(e.value=[]);let l=parseInt(o[0].substring(1));Cs.includes(u)?e.value[l]={keyword:u}:u.match(/domain\[[0-9]+\]/g)?e.value[l]={keyword:u}:e.value[l]={literal:u}}else Cs.includes(u)?e[o[0]]={keyword:u}:u.match(/domain\[[0-9]+\]/g)?e[o[0]]={keyword:u}:e[o[0]]={literal:u}}}),e}function eI(t,e,n,r,s,a,o){var _,b,A,S,I,x,C;let u=t.properties,l=u.channel;u.field;let c=u.encodingType,h=((_=a==null?void 0:a.timeUnit)==null?void 0:_.unit)||"seconds";if((u==null?void 0:u.descriptionDetail)===uf||(u==null?void 0:u.descriptionDetail)===null)return null;let f="",d=!1;if(ot(u==null?void 0:u.descriptionDetail)==="String"&&(u==null?void 0:u.descriptionDetail)!==Xv)return f=u==null?void 0:u.descriptionDetail,d=!0,[{type:mt,speech:u==null?void 0:u.descriptionDetail,speechRate:m}];let m=a.speechRate||qv,p=(e==null?void 0:e.scale.title)||Xs(ln(u.field),", ",!1);if(l===at)d||(f="The <title> is mapped to <channel>. "),(u.range?Math.max(...u.range):null)&&(d||(f+="The duration of the stream is <range.length> <timeUnit>. ")),u.binned&&(e.binned.equiBin?d||(f+="Each sound represents a equally sized bin bucket. "):d||(f+="The length of each sound represents the corresponding bin bucket size. ")),r!=null&&r.interval&&(r==null?void 0:r.description)!==uf&&(d||(f+=`A tick sound is played every ${r.interval} ${h}. `));else if(c===rr){if(p&&u.aggregate&&u.aggregate!=="count"?d||(f+="The <title> is mapped to <channel> and aggregated by <aggregate>. "):u.aggregate==="count"?d||(f="The count of data points is mapped to <channel>. "):d||(f="The <title> is mapped to <channel>. "),s.continued)((b=u==null?void 0:u.domain)==null?void 0:b.length)==2?d||(f+='The domains values from <domain.min> to <domain.max> are mapped to <sound v0="domain.min" v1="domain.max" duration="0.6">'):((A=u==null?void 0:u.domain)==null?void 0:A.length)>2&&(d||(f+=`The domains values from <domain.min> to <domain.max> are mapped to <sound ${u.domain.map((T,N)=>"domain["+N+"]")} duration="${u.domain*.3}">`));else if(((S=u==null?void 0:u.domain)==null?void 0:S.length)==2)d||(f+='The minimum value <domain.min> is mapped to <sound value="domain.min" duration="0.3">, and '),d||(f+='the maximum value <domain.max> is mapped to <sound value="domain.max" duration="0.3">.');else if(((I=u==null?void 0:u.domain)==null?void 0:I.length)>2&&!d){f+="<title> values are mapped as";for(let T=0;T<u.domain.length;T++)f+=`<domain[${T}]> <sound value="domain[${T}]" duration="0.3">`}}else if(c===os)p&&u.aggregate&&u.aggregate!=="count"?d||(f+="The <title> is mapped to <channel> and aggregated by <aggregate>. "):u.aggregate==="count"?d||(f+="The count of data points is mapped to <channel>. "):d||(f+="The <title> is mapped to <channel>. "),s.continued?d||(f+='The domains values from <domain.min> to <domain.max> are mapped to <sound v0="domain.min" v1="domain.max" duration="0.6">. '):(d||(f+='The minimum value <domain.min> is mapped to <sound value="domain.min" duration="0.5">, and '),d||(f+='the maximum value <domain.max> is mapped to <sound value="domain.max" duration="0.5">. '));else if(c===as||c===Ur){d||(f+="The <title> is mapped to <channel>. ");let T=u.domain.length;if(T<=6||u.playAllDescription)for(let N=0;N<T;N++)d||(f+=`The value <domain[${N}]> is <sound value="domain[${N}]" duration="0.3">. `);else d||(f+='The first value <domain[0]> is <sound value="domain[0]" duration="0.3">. '),d||(f+='The second value <domain[1]> is <sound value="domain[1]" duration="0.3">. '),d||(f+=`The second last value <domain[${T-2}]> is <sound value="domain[${T-2}]" duration="0.3">. `),d||(f+=`The last value <domain[${T-1}]> is <sound value="domain[${T-1}]" duration="0.3">. `)}else if(c===Mi&&u.conditions){for(const T of u.conditions)if(ot(T.test)==="Array")d||(f+=`The values of <list item="${T.test.join(",")}" join=", "> are mapped to <sound value="${T.test[0]}" duration="0.3>. `);else if((x=T.test)!=null&&x.not&&ot(T.test.not)==="Array")d||(f+=`The values that are not <list item="${T.test.not.join(",")}" join=", "> are mapped to <sound value="${T.test.not[0]}" duration="0.3>. `);else if(T.test&&T.name){let N=T.test[0]||((C=T.test.not)==null?void 0:C[0]);!d&&N!==void 0&&(f+=`${T.name} values are mapped to <sound value="${N}" duration="0.3>. `)}}let g=Q2(f,l,t,m,h),y=[];for(const T of g)if(T.type===mt)y.push({type:mt,speech:T.text,speechRate:T.speechRate||m});else if(T.type==="sound")if(T.continuous){let N=nI(l,T.value,t,T.duration);y.push({type:Ys,channel:l,sounds:N,instrument_type:(s==null?void 0:s.type)||"default",continued:!0})}else{let N=iI(l,T.value,t,T.duration);y.push({type:Hs,sound:N,instrument_type:(s==null?void 0:s.type)||"default"})}return y}function nI(t,e,n,r){let s=Math.min(...e),a=Math.max(...e),o=h=>(h-s)/(a-s)*r,u=Sc().domain(e).range(e.map(o)),l=[],c=0;for(const h of e)l.push({start:u(h),[t]:n(h),duration:c==e.length-1?.15:0}),c++;return l}function iI(t,e,n,r){let s={start:0,[t]:n(e)};return s.duration==null&&(s.duration=r||.2),s}const ud="forceRepeatScale",Fm="playScaleAt",Bm="beforeAll",rI="beforeThis",sI="afterAll",aI="afterThis";class oI{constructor(){this.streams=[],this.playing=!1,this.status=void 0,this.prerendered=!1,this.config={},this.synths=[],this.samplings=[]}setTitle(e){this.title=e}setDescription(e){this.description=e}addStream(e){this.streams.push(e)}addStreams(e){this.streams.push(...e)}setSampling(e){this.samplings=e}setSynths(e){this.synths=e}setWaves(e){this.waves=e}setConfig(e,n){this.config[e]=n}setIntroStream(e){this.introStream=e}async prerender(){var f,d,m,p,g,y;this.queue=new xn,this.config&&Object.keys(this.config).forEach(_=>{this.queue.setConfig(_,this.config[_])}),this.queue.setSampling(this.samplings),this.queue.setSynths(this.synths),this.queue.setWaves(this.waves),this.config.skipStartSpeech||this.queue.add(mt,{speech:"see change",speechRate:(f=this.config)==null?void 0:f.speechRate},this.config),this.introStream?this.introStream.stream.forEach(_=>{var b;this.queue.add(mt,{speech:_.speech,speechRate:(b=this.config)==null?void 0:b.speechRate},this.config)}):(this.title&&!this.config.skipTitle?this.queue.add(mt,{speech:`${this.title}. `,speechRate:(d=this.config)==null?void 0:d.speechRate},this.config):this.name&&!this.config.skipTitle&&this.queue.add(mt,{speech:`This sonification is about ${this.name}. `,speechRate:(m=this.config)==null?void 0:m.speechRate},this.config),this.description&&!this.config.skipDescription&&this.queue.add(mt,{speech:this.description,speechRate:(p=this.config)==null?void 0:p.speechRate},this.config));let e=[],n=[],r=[],s=[],a=this.streams.length>1;a&&!this.config.skipSquenceIntro&&this.queue.add(mt,{speech:`This sonification sequence consists of ${this.streams.length} parts. `,speechRate:(g=this.config)==null?void 0:g.speechRate},this.config);let o=0;for(const _ of this.streams){let b=P(this.config||{});Object.assign(b,_.config||{});let A=b.speechRate;if(a){let I=new xn;(_.title||_.name)&&!_.config.skipSequenceTitle?I.add(mt,{speech:`Stream ${o+1}. ${_.title||_.name}. `,speechRate:A},b):_.config.skipSequenceTitle||I.add(mt,{speech:`Stream ${o+1}. `,speechRate:A},b),_.description&&!_.config.skipSequenceDescription&&I.add(mt,{speech:_.description,speechRate:A},b),e.push(I)}else e.push(new xn);let S="This";if(a&&(S="The "+Io(o+1)),ot(_)!==Zs.name&&!b.skipScaleSpeech){let I=_.make_scale_text().filter(T=>T),x=[],C=b[ud];C||(C=!1);for(const T of I)T.description&&(s.includes(T.id)?(C===!0||(C==null?void 0:C[T.channel])===!0)&&x.push(...T.description):(x.push(...T.description),s.push(T.id)));if(x.length>0){let T=new xn;T.add(mt,{speech:`${S} stream has the following sound mappings. `,speechRate:A},b),T.addMulti(x,{...b,tick:null}),n.push(T)}else n.push(null)}else if(ot(_)===Zs.name){b.skipTitle||e[o].add(mt,{speech:`${S} stream has ${_.overlays.length} overlaid sounds. `,speechRate:A},b);let I=b[ud];I||(I=!1);let x=!1,C=new xn;_.overlays.forEach((T,N)=>{let E=P(b||{});Object.assign(E,T.config||{});let k=E.speechRate;E.playRepeatSequenceName!==!1&&T.title&&!E.skipOverlayTitle?e[o].add(mt,{speech:`Overlay ${N+1}. ${T.title}. `,speechRate:k},E):E.playRepeatSequenceName!==!1&&T.name&&!E.skipOverlayTitle&&e[o].add(mt,{speech:`Overlay ${N+1}. ${T.name}. `,speechRate:k},E),T.description&&!E.skipOverlayDescription&&e[o].add(mt,{speech:T.description,speechRate:k},E);let R=_.make_scale_text(N).filter(X=>X),D=[];for(const X of R)X.description&&(s.includes(X.id)?(I===!0||(I==null?void 0:I[X.channel])===!0)&&D.push(...X.description):(D.push(...X.description),s.push(X.id)));if(D.length>0){if(!I&&!x)C.add(mt,{speech:`${S} stream has the following sound mappings. `,speechRate:k},E),x=!0;else{let X="This";a&&N>1&&(X="The "+Io(N)),C.add(mt,{speech:`${X} overlay has the following sound mappings. `,speechRate:k},E)}C.addMulti(D,{...E,tick:null})}}),C.queue.length>0?n.push(C):n.push(null)}o++}for(const _ of this.streams){let b=await _.prerender(!0);r.push(b)}let u=0,l=this.queue.queue.length||0,c=[],h=[];for(const _ of this.streams){let b=P(this.config||{});Object.assign(b,_.config||{});let A=b.speechRate;e[u]&&this.queue.addQueue(e[u]);let S=b[Fm];S===Bm?n[u]&&c.push(n[u]):(S===rI||!S)&&n[u]&&this.queue.addQueue(n[u]);let I=r[u];b.skipStartPlaySpeech||this.queue.add(mt,{speech:"Start playing. ",speechRate:A},b),ot(I)===xn.name?this.queue.addMulti(I.queue,b):this.queue.add(Ys,I,b),S===sI?n[u]&&h.push(n[u]):S===aI&&n[u]&&this.queue.addQueue(n[u]),u++}if(c.length>0)for(const _ of c)this.queue.addQueue(_,l),l+=1;if(h.length>0)for(const _ of c)this.queue.addQueue(_);return this.config.skipFinishSpeech||this.queue.add(mt,{speech:"Finished.",speechRate:(y=this.config)==null?void 0:y.speechRate},this.config),this.prerendered=!0,this.queue.setConfig("options",this.config.options),this.queue}make_scale_text(e,n){var r;return e===void 0?this.streams.map(s=>s.make_scale_text(n)).flat():(r=this.streams[e])==null?void 0:r.make_scale_text(n)}async prerenderScale(e,n){let r=(this.make_scale_text(e,n)||[]).map(s=>s.description).flat();return this.scaleQueue=new xn,this.scaleQueue.addMulti(r,{...this.config,tick:null}),this.scaleQueue}async playScaleDescription(e,n){var r;await this.prerenderScale(e,n),await((r=this.scaleQueue)==null?void 0:r.play())}async stopScaleDescription(){var e;(e=this.scaleQueue)==null||e.stop()}async playQueue(){var e;this.prerendered||await this.prerender(),await((e=this.queue)==null?void 0:e.play())}async stopQueue(){var e;(e=this.queue)==null||e.stop()}destroy(){this.queue=this.queue.destroy()}}class Zs{constructor(){this.overlays=[],this.playing=!1,this.status=void 0,this.prerendered=!1,this.individual_playing=[],this.config={},this.name}setName(e){this.name=e}setTitle(e){this.title=e}setDescription(e){this.description=e}addStream(e){this.overlays.push(e)}addStreams(e){this.overlays.push(...e)}setConfig(e,n){this.config[e]=n}async prerender(e){var r,s,a,o,u,l,c;if(this.queue=new xn,e||(this.title&&!this.config.skipTitle?this.queue.add(mt,{speech:this.title,speechRate:(r=this.config)==null?void 0:r.speechRate},this.config):this.name&&!this.config.skipTitle&&this.queue.add(mt,{speech:this.name,speechRate:(s=this.config)==null?void 0:s.speechRate},this.config),this.description&&!this.config.skipDescription&&this.queue.add(mt,{speech:this.description,speechRate:(a=this.config)==null?void 0:a.speechRate},this.config)),this.overlays.length>1&&!e&&!this.config.skipStartSpeech){this.queue.add(mt,{speech:`This sonification has ${this.overlays.length} overlaid streams.`,speechRate:(o=this.config)==null?void 0:o.speechRate});let h=1,f=[],d=[],m=0;for(const p of this.overlays){let g=new xn;(p.title||p.name)&&!p.config.skipTitle&&g.add(mt,{speech:`The ${Io(h)} overlay stream is about ${p.title||p.name}. `,speechRate:(u=this.config)==null?void 0:u.speechRate},p.config),p.description&&!p.config.skipDescription&&g.add(mt,{speech:p.description,speechRate:(l=this.config)==null?void 0:l.speechRate},p.config),f.push(g);let y=p.make_scale_text().filter(_=>_);if(!p.config.skipScaleSpeech&&y.length>0){let _=new xn;_.add(mt,{speech:"This stream has the following sound mappings. ",speechRate:(c=this.config)==null?void 0:c.speechRate},p.config),_.addMulti(y,{...p.config,tick:null}),m++,d.push(_)}h++}if(m>1)for(let p=0;p<h-1;p++)f[p]&&this.queue.addQueue(f[p]),d[p]&&this.queue.addQueue(d[p]);else{for(let p=0;p<h-1;p++)f[p]&&this.queue.addQueue(f[p]);for(let p=0;p<h-1;p++)d[p]&&this.queue.addQueue(d[p])}}let n=[];return this.overlays.forEach(async(h,f)=>{n.push(await h.prerender())}),this.queue.add(uo,{overlays:n}),this.prerendered=!0,this.queue}make_scale_text(e,n){if(e!==void 0){let r=this.overlays[e];return r&&!r.config.skipScaleSpeech?r.make_scale_text(n):[]}else return this.overlays.map(r=>r.config.skipScaleSpeech?[]:r.make_scale_text(n)).flat()}async playQueue(){var e;this.prerendered||await this.prerender(),(e=this.queue)==null||e.play()}async stopQueue(){var e;(e=this.queue)==null||e.stop()}}class El{constructor(e,n,r,s){this.instrument_type=e,this.stream=n,this.option=s||{},this.instrument,this.scales=r,this.config={},this.name,this.ramp={}}setTitle(e){this.title=e}setDescription(e){this.description=e}setName(e){this.name=e}setConfig(e,n){this.config[e]=n}setFilters(e){this.audioFilters=e}setRamp(e){this.ramp=P(e)}make_tone_text(e){var s,a;let n=[],r=e!==void 0?`The ${Io(e+1)}`:"This";return this.name?n.push({type:mt,speech:`${r} stream is for ${this.name} layer and has a tone of`,speechRate:(s=this.config)==null?void 0:s.speechRate}):n.push({type:mt,speech:`${r} stream has a tone of`,speechRate:(a=this.config)==null?void 0:a.speechRate}),n.push({type:Hs,sound:{pitch:ae,duration:.2,start:0},instrument_type:this.instrument_type}),n}make_scale_text(e){let n=this.scales;return Object.keys(n).filter(s=>!e&&!lI.includes(s)||s===e).map(s=>{var a,o;return{id:(a=n[s])==null?void 0:a.scaleId,channel:s,description:(o=n[s])==null?void 0:o.description}}).flat()}async prerender(){var e,n;return{instrument_type:this.instrument_type,sounds:this.stream,continued:(e=this.option)==null?void 0:e.is_continued,relative:(n=this.option)==null?void 0:n.relative,filters:this.audioFilters,ramp:this.ramp}}}class uI{constructor(e){this.stream=e,this.config={}}setConfig(e,n){this.config[e]=n}make_scale_text(){return[]}async prerender(){var n;let e=[];for(const r of this.stream)r.speech&&e.push({type:mt,speech:r.speech,speechRate:(n=this.config)==null?void 0:n.speechRate});return e}}const lI=["time2"];function Rm(t,e,n){let r={};if(t===void 0&&(t=0),n.length<=t)return{direction:"leaf",node:[]};let s=e.map(l=>l.membership[t]),a=[],o=n[t];r.direction=o,r.nodes=[],r.field=s[0].key;let u=[];for(const l of s)if(!u.includes(l.value)&&(u.push(l.value),!a.includes(l.value))){let c=e.filter(h=>h[t]===l.value);if(c.length>0){let h=Rm(t+1,c,n);h.parent_value=l.value,r.nodes.push(h),a.push(l.value)}}return r}function cI(t){let e=Ol(t);return e=e.nodes.map(n=>{if(ot(n)===El.name)return n;if(n.length==1)return n[0];if(n.length>1){let r=new Zs;return r.addStreams(n),r}}),e}function Ol(t){if(t.direction==="leaf")return{nodes:t.node,dir:"leaf"};if(t.direction===Mr){let e=[];return t.nodes.forEach(n=>{let{nodes:r,dir:s}=Ol(n);e.push(...r)}),{nodes:e.filter(n=>n!==void 0),dir:Mr}}else if(t.direction===ro){let e=[];return t.nodes.forEach(n=>{let{nodes:r,dir:s}=Ol(n);s===Mr?e.push(r):e.push(...r)}),{nodes:e.filter(n=>n!==void 0),dir:ro}}}async function Lm(t){var m,p,g,y,_,b,A,S,I,x;let e=P(t),n=[],r=P(e.datasets||[]),s=P(e.synth||[]),a=P(e.sampling||[]),o=P(e.tick||[]),u=P(e.wave||[]),l=[],c,h=[];if(Wu(e)){if(e.data){let N="data__"+(r.length+1);r.push({name:N,...P(e.data)}),e.data={name:N}}let{normalized:C,scaleDefinitions:T}=Gu(e,null);n.push({stream:C}),l.push(...T),h.push(...Object.keys(C.encoding))}else{let C;if(e.data&&!e.data.name&&(C="data__"+(r.length+1),r.push({name:C,...P(e.data)})),ld(e)){let T=[],N,E;e.data&&!e.data.name?(N=P(e.data),E=`data__${r.length+1}`,r.push({name:E,...N})):(m=e.data)!=null&&m.name&&(N=P(e.data));for(const R of e.overlay){let D=P(R);if(N&&!D.data)E?D.data={name:E}:D.data||(D.data=N);else if(D.data&&!D.data.name){let ft=`data__${r.length+1}`;r.push({name:ft,...D.data}),D.data={name:ft}}if((p=D.encoding)!=null&&p.time.tick&&(!((g=D.encoding)!=null&&g.time.tick.name)||!o.filter(ft=>{var Dt;return ft.name===((Dt=D.encoding)==null?void 0:Dt.time.tick.name)}))){let ft=((y=D.encoding)==null?void 0:y.time.tick.name)||"tick_"+(o.length+1);o.push({...(_=D.encoding)==null?void 0:_.time.tick,name:ft}),D.encoding.time.tick={name:ft}}D.data||(D.data={name:C}),D.common_transform=P(e.transform||[]),D.transform=P(R.transform||[]),Wu(R)||console.error("An overlay of multi-stream sequences is not supported!");let X=Gu(D,Mr);h.push(...Object.keys(X.normalized.encoding)),T.push(X.normalized),l.push(...X.scaleDefinitions)}let k={};Object.assign(k,e.config),Ku(k,ln(h)),delete k.sequenceScaleConsistency,delete k.forceSequenceScaleConsistency,n.push({overlay:T,name:e.name,title:e.title,description:e.description,config:k})}else if(cd(e)){let T=[],N={};c={},Object.assign(c,e.config),e.title&&(N.title=e.title),e.description&&(N.description=e.description),Object.keys(N).length>0&&T.push({intro:N});for(const E of e.sequence){let k=P(E);if(cd(E)&&console.error("A sequence of sequence is not supported!"),Wu(k)){if((b=k.encoding)!=null&&b.time.tick&&(!((A=k.encoding)!=null&&A.time.tick.name)||!o.filter(D=>{var X;return D.name===((X=k.encoding)==null?void 0:X.time.tick.name)}))){let D=((S=k.encoding)==null?void 0:S.time.tick.name)||"tick_"+(o.length+1);o.push({...(I=k.encoding)==null?void 0:I.time.tick,name:D}),k.encoding.time.tick={name:D}}if(!k.data)k.data={name:C};else if((x=k.data)!=null&&x.values){let D="data__"+(r.length+1);r.push({name:D,values:P(k.data.values)}),k.data={name:D}}k.common_transform=P(e.transform||[]),k.transform=P(E.transform||[]);let R=Gu(k,ro);l.push(...R.scaleDefinitions),T.push(R.normalized),h.push(...Object.keys(R.normalized.encoding))}else if(ld(k)){k.id="overlay-"+ti();let R=await Lm(k),D=R.normalized[0];D.id=k.id,T.push(D),R.scaleDefinitions.forEach(X=>{X.parentId=D.id}),R.normalized[0].overlay.forEach(X=>{h.push(...Object.keys(X.encoding))}),l.push(...R.scaleDefinitions),Object.assign(r,R.datasets),Object.assign(o,R.tick)}}Ku(c,ln(h)),delete c.overlayScaleConsistency,delete c.forceOverlayScaleConsistency,n.push(...T.map(E=>E.intro?{intro:E.intro}:E.overlay?{overlay:E.overlay||E,id:E.overlay.id||E.id,name:E.overlay.name||E.name,title:E.overlay.title||E.title,description:E.overlay.description||E.description,config:E.config}:{stream:E}))}}let f=Tr(r,"name",!0),d=Tr(o,"name",!0);return c||(c={},Object.assign(c,e.config),Ku(c,ln(h)),delete c.overlayScaleConsistency,delete c.forceOverlayScaleConsistency),{normalized:n,datasets:f,tick:d,scaleDefinitions:l,sequenceConfig:c,synths:s,samplings:a,waves:u}}function hI(t){var e;return!!(t&&t.encoding&&((e=t.encoding)!=null&&e.repeat))}function Wu(t){return!!(t&&t.encoding&&t.tone&&!t.overlay&&!t.sequence)}function ld(t){return!!(t&&!t.encoding&&!t.tone&&t.overlay&&!t.sequence)}function cd(t){return!!(t&&!t.encoding&&!t.tone&&!t.overlay&&t.sequence)}const Hu="__bin",Yu="__bin_end",hd="__count",Pm="default",Dl="auto";function Gu(t,e){var u,l,c,h,f;let n=[];if(!t)return null;let r=e===Mr,s={};t.title&&(s.title=t.title),t.name&&(s.name=t.name),s.id="stream-"+ti(),t.description&&(s.description=t.description),t.data&&(s.data=P(t.data)),t.tone&&(s.tone={},ot(t.tone)==="String"?s.tone.type=t.tone:ot(t.tone)==="Object"&&(s.tone=P(t.tone),s.tone.type===void 0&&(s.tone.type=Pm)),ot((u=t.tone)==null?void 0:u.filter)==="Array"&&(s.filter=[...t.tone.filter]));let a=[],o=[];if(t.encoding){s.encoding={},((c=(l=t.encoding[at])==null?void 0:l.scale)==null?void 0:c.timing)===pl&&(t.encoding[oe]&&t.encoding[tn]?(console.warn(`Speech channels cannot be used for simultaneous timing. ${oe} and ${tn} are dropped.`),delete t.encoding[oe],delete t.encoding[tn]):t.encoding[oe]?(console.warn(`Speech channels cannot be used for simultaneous timing. ${oe} is dropped.`),delete t.encoding[oe]):t.encoding[tn]&&(console.warn(`Speech channels cannot be used for simultaneous timing. ${tn} is dropped.`),delete t.encoding[tn]));let d=!1;for(const p of Object.keys(t.encoding)){let g=t.encoding[p],y={};g.field&&(y.field=g.field),g.type&&(y.type=g.type),g.by&&(ot(g.by)==="Array"&&!g.by.join("X").match(/(^(sequence|sequenceX)*(overlay|overlayX)*$)/gi)&&console.error("Wrong repeat-by form. Overlay cannot preceed sequence!"),y.by=g.by,d=y.by.includes(Mr),d&&r&&console.error("Overlay composition + overlay repet is not supported.")),g.ramp&&Zv.includes(g.ramp)?g.ramp.constructor.name==="String"?y.ramp=g.ramp:y.ramp=g.ramp?"linear":"exponential":y.ramp="linear",g.speech&&(y.speech=g.speech),g.value!==void 0&&(y.value=g.value),p===at&&g.tick&&(y.tick=P(g.tick)),g.scale?y.scale=P(g.scale):y.scale={},g.format&&(y.format=g.format),g.formatType&&(y.formatType=g.formatType),g.bin&&(ot(g.bin)==="Object"?a.push({bin:g.field,step:g.bin.step,maxbins:g.bin.maxbins,nice:g.bin.nice,as:g.field+Hu,exact:g.bin.exact,end:g.field+Yu}):ot(g.bin)==="Boolean"&&a.push({bin:g.field,auto:!0,as:g.field+Hu,end:g.field+Yu}),y.field=g.field+Hu,y.original_field=g.field,y.type=rr,p===at&&(s.encoding[p+"2"]={field:g.field+Yu}),y.scale||(y.scale={}),y.scale.title=g.field+" (binned)",y.binned=!0),g.aggregate&&(!g.field&&g.aggregate==="count"?(o.push({op:"count",as:hd}),y.field=hd,y.scale||(y.scale={}),y.scale.title="Count",y.type=rr):(o.push({op:g.aggregate,field:g.field,as:g.field+"__"+g.aggregate,p:g.p}),y.field=g.field+"__"+g.aggregate,y.original_field=g.field,y.scale||(y.scale={}),y.scale.title=g.aggregate+" "+g.field,y.type=g.type||rr),y.aggregate=g.aggregate),g.condition&&(y.condtion=P(g.condition)),p===De&&t.encoding[Fe]?y.hasTapSpeed=!0:p===Fe&&t.encoding[De]&&(y.hasTapCount=!0);let _="scale-"+ti(),b={id:_,channel:p,type:y.type,dataName:s.data.name,field:[y.field],scale:P(y.scale),streamID:[s.id],parentType:e};y.scale.id=_,n.push(b),s.encoding[p]=y}s.encoding[Ti]&&(s.encoding[Ti].scale={id:(f=(h=s.encoding[at])==null?void 0:h.scale)==null?void 0:f.id},n.forEach(p=>{var g,y;p.channel===at&&p.id===((y=(g=s.encoding[at])==null?void 0:g.scale)==null?void 0:y.id)&&(p.hasTime2||(p.hasTime2=[]),p.hasTime2.push(s.id))})),s.encoding[ve]&&n.forEach(p=>{p.isRepeated||(p.isRepeated=[]),p.isRepeated.push(s.id)});let m=Object.keys(s.encoding);(d||r)&&(m.includes(tn)||m.includes(oe))&&console.warn("Using speechAfter/Before channels for an overlaid stream is not recommended.")}if(t.common_transform&&(s.common_transform=P(t.common_transform)),t.transform&&(s.transform=P(t.transform)),a.length>0&&(s.transform||(s.transform=[]),s.transform.push(...a)),o.length>0&&(s.encoding_aggregates=o,s.transform||(s.transform=[]),s.transform.push({aggregate:o,groupby:Dl})),t.config){let d={};Object.assign(d,t.config),s.config=d}return{normalized:s,scaleDefinitions:n}}function Ku(t,e){var o,u,l,c;let n={},r={},s={},a={};for(const h of e)((o=t.overlayScaleConsistency)==null?void 0:o[h])!==void 0?n[h]=t.overlayScaleConsistency[h]:ot(t.overlayScaleConsistency)==="Boolean"?n[h]=t.overlayScaleConsistency:n[h]=!0,((u=t.forceOverlayScaleConsistency)==null?void 0:u[h])!==void 0?r[h]=t.forceOverlayScaleConsistency[h]:ot(t.overlayScaleConsistency)==="Boolean"?r[h]=t.forceOverlayScaleConsistency:r[h]=!1,((l=t.sequenceScaleConsistency)==null?void 0:l[h])!==void 0?s[h]=t.sequenceScaleConsistency[h]:ot(t.sequenceScaleConsistency)==="Boolean"?s[h]=t.sequenceScaleConsistency:s[h]=!0,((c=t.forceSequenceScaleConsistency)==null?void 0:c[h])!==void 0?a[h]=t.forceSequenceScaleConsistency[h]:ot(t.overlayScaleConsistency)==="Boolean"?a[h]=t.forceSequenceScaleConsistency:a[h]=!1;t.overlayScaleConsistency=n,t.forceOverlayScaleConsistency=r,t.sequenceScaleConsistency=s,t.forceSequenceScaleConsistency=a}const bt=Array.isArray;function Te(t){return t!=null?bt(t)?t:[t]:[]}function fI(t=0,e=1/0){return`${fd(t)} < row_number() && row_number() <= ${fd(e)}`}function fd(t){return t<0?`count() + ${t}`:t}class Vm{constructor(e){e&&(this._params=e)}params(e){return arguments.length?(e&&(this._params={...this._params,...e}),this):this._params}reify(e){return this.__reify(this,e)}count(e){return this.__count(this,e)}derive(e,n){return this.__derive(this,e,n)}filter(e){return this.__filter(this,e)}slice(e,n){return this.filter(fI(e,n)).reify()}groupby(...e){return this.__groupby(this,e.flat())}orderby(...e){return this.__orderby(this,e.flat())}relocate(e,n){return this.__relocate(this,Te(e),n)}rename(...e){return this.__rename(this,e.flat())}rollup(e){return this.__rollup(this,e)}sample(e,n){return this.__sample(this,e,n)}select(...e){return this.__select(this,e.flat())}ungroup(){return this.__ungroup(this)}unorder(){return this.__unorder(this)}dedupe(...e){return this.__dedupe(this,e.flat())}impute(e,n){return this.__impute(this,e,n)}fold(e,n){return this.__fold(this,e,n)}pivot(e,n,r){return this.__pivot(this,e,n,r)}spread(e,n){return this.__spread(this,e,n)}unroll(e,n){return this.__unroll(this,e,n)}lookup(e,n,...r){return this.__lookup(this,e,n,r.flat())}join(e,n,r,s){return this.__join(this,e,n,r,s)}join_left(e,n,r,s){const a={...s,left:!0,right:!1};return this.__join(this,e,n,r,a)}join_right(e,n,r,s){const a={...s,left:!1,right:!0};return this.__join(this,e,n,r,a)}join_full(e,n,r,s){const a={...s,left:!0,right:!0};return this.__join(this,e,n,r,a)}cross(e,n,r){return this.__cross(this,e,n,r)}semijoin(e,n){return this.__semijoin(this,e,n)}antijoin(e,n){return this.__antijoin(this,e,n)}concat(...e){return this.__concat(this,e.flat())}union(...e){return this.__union(this,e.flat())}intersect(...e){return this.__intersect(this,e.flat())}except(...e){return this.__except(this,e.flat())}}function it(t){throw Error(t)}function ce(t){return typeof t=="number"}function Ot(t){return typeof t=="function"}function lu(t,e){const n=Array(t);if(Ot(e))for(let r=0;r<t;++r)n[r]=e(r);else n.fill(e);return n}let dI=class extends Vm{constructor(e,n,r,s,a,o,u){super(u),this._names=Object.freeze(e),this._data=r,this._total=n,this._nrows=s?s.count():n,this._mask=n!==this._nrows&&s||null,this._group=a||null,this._order=o||null}create(e){it("Not implemented")}get[Symbol.toStringTag](){if(!this._names)return"Object";const e=this.numRows()+" row"+(this.numRows()!==1?"s":"");return`Table: ${this.numCols()+" col"+(this.numCols()!==1?"s":"")} x ${e}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(e){return e?this._names.filter(e):this._names.slice()}columnName(e){return this._names[e]}columnIndex(e){return this._names.indexOf(e)}columnArray(e,n){return this.array(e,n)}array(e,n){it("Not implemented")}*values(e){const n=this.getter(e),r=this.numRows();for(let s=0;s<r;++s)yield n(s)}get(e,n=0){it("Not implemented")}getter(e){it("Not implemented")}objects(e){it("Not implemented")}object(e){it("Not implemented")}[Symbol.iterator](){it("Not implemented")}print(e={}){ce(e)?e={limit:e}:e.limit==null&&(e.limit=10);const n=this.objects({...e,grouped:!1}),r=`${this[Symbol.toStringTag]}. Showing ${n.length} rows.`;return console.log(r),console.table(n),this}indices(e=!0){if(this._index)return this._index;const n=this.numRows(),r=new Uint32Array(n),s=this.isOrdered(),a=this.mask();let o=-1;if(a)for(let u=a.next(0);u>=0;u=a.next(u+1))r[++o]=u;else for(let u=0;u<n;++u)r[++o]=u;if(e&&s){const u=this._order,l=this._data;r.sort((c,h)=>u(c,h,l))}return(e||!s)&&(this._index=r),r}partitions(e=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(e)];const{keys:n,size:r}=this._group,s=lu(r,()=>[]),a=this._index,o=this.mask(),u=this.numRows();if(a&&this.isOrdered())for(let l=0,c;l<u;++l)c=a[l],s[n[c]].push(c);else if(o)for(let l=o.next(0);l>=0;l=o.next(l+1))s[n[l]].push(l);else for(let l=0;l<u;++l)s[n[l]].push(l);if(e&&!a&&this.isOrdered()){const l=this._order,c=this._data;for(let h=0;h<r;++h)s[h].sort((f,d)=>l(f,d,c))}return(e||!this.isOrdered())&&(this._partitions=s),s}scan(e,n,r=1/0,s=0){const a=this._mask,o=this._nrows,u=this._data;let l=s||0;if(l>o)return;const c=Math.min(o,l+r),h=()=>l=this._total;if(n&&this.isOrdered()||a&&this._index){const f=this.indices(),d=this._data;for(;l<c;++l)e(f[l],d,h)}else if(a){let f=c-l+1;for(l=a.nth(l);--f&&l>-1;l=a.next(l+1))e(l,u,h)}else for(;l<c;++l)e(l,u,h)}slice(e=0,n=1/0){if(this.isGrouped())return super.slice(e,n);const r=[],s=this.numRows();return e=Math.max(0,e+(e<0?s:0)),n=Math.min(s,Math.max(0,n+(n<0?s:0))),this.scan(a=>r.push(a),!0,n-e,e),this.reify(r)}reduce(e){return this.__reduce(this,e)}},pI=class{constructor(e){this.data=e}get length(){return this.data.length}get(e){return this.data[e]}[Symbol.iterator](){return this.data[Symbol.iterator]()}},mI=function(t){return t&&Ot(t.get)?t:new pI(t)};function ri(t){return t instanceof Date}function re(t){return t===Object(t)}function To(t){return t instanceof RegExp}function te(t){return typeof t=="string"}function yI(t,e){const n=r=>it(`Illegal argument type: ${r||typeof t}`);return t instanceof Map?dd(t.entries(),e):ri(t)?n("Date"):To(t)?n("RegExp"):te(t)?n():bt(t)?gI(t,e):Ot(t[Symbol.iterator])?vI(t,e):re(t)?dd(Object.entries(t),e):n()}function dd(t,e=["key","value"]){const n=[],r=[];for(const[a,o]of t)n.push(a),r.push(o);const s={};return e[0]&&(s[e[0]]=n),e[1]&&(s[e[1]]=r),s}function gI(t,e){const n=t.length,r={},s=a=>r[a]=Array(n);if(n){e=e||Object.keys(t[0]);const a=e.map(s),o=a.length;for(let u=0;u<n;++u){const l=t[u];for(let c=0;c<o;++c)a[c][u]=l[e[c]]}}else e&&e.forEach(s);return r}function vI(t,e){const n={},r=o=>n[o]=[];let s,a;for(const o of t){s||(e=e||Object.keys(o),s=e.map(r),a=s.length);for(let u=0;u<a;++u)s[u].push(o[e[u]])}return!s&&e&&e.forEach(r),n}const{hasOwnProperty:_I}=Object.prototype;function hn(t,e){return _I.call(t,e)}function Le(t){return t?new pd({...t.data()},t.columnNames()):new pd}class pd{constructor(e,n){this.data=e||{},this.names=n||[]}add(e,n){return this.has(e)||this.names.push(e+""),this.data[e]=n}has(e){return hn(this.data,e)}new(){return this.filter=null,this.groups=this.groups||null,this.order=null,this}groupby(e){return this.groups=e,this}}const vt=void 0,bI=Object.getPrototypeOf(Int8Array);function va(t){return t instanceof bI}function Qi(t){return bt(t)||va(t)}function un(t){return t!=null&&t===t}const ks=t=>Qi(t)||te(t),wI={compact:t=>Qi(t)?t.filter(e=>un(e)):t,concat:(...t)=>[].concat(...t),includes:(t,e,n)=>ks(t)?t.includes(e,n):!1,indexof:(t,e)=>ks(t)?t.indexOf(e):-1,join:(t,e)=>Qi(t)?t.join(e):vt,lastindexof:(t,e)=>ks(t)?t.lastIndexOf(e):-1,length:t=>ks(t)?t.length:0,pluck:(t,e)=>Qi(t)?t.map(n=>un(n)?n[e]:vt):vt,reverse:t=>Qi(t)?t.slice().reverse():te(t)?t.split("").reverse().join(""):vt,slice:(t,e,n)=>ks(t)?t.slice(e,n):vt};function xI(t,e,n,r,s){return t==null?null:t<e?-1/0:t>n?1/0:(t=Math.max(e,Math.min(t,n)),e+r*Math.floor(1e-14+(t-e)/r+(s||0)))}function Qa(t,e,n="0"){const r=t+"",s=r.length;return s<e?Array(e-s+1).join(n)+r:r}const gn=t=>(t<10?"0":"")+t,SI=t=>t<0?"-"+Qa(-t,6):t>9999?"+"+Qa(t,6):Qa(t,4);function Um(t,e,n,r,s,a,o,u,l){const c=u?"Z":"";return SI(t)+"-"+gn(e+1)+"-"+gn(n)+(!l||o?"T"+gn(r)+":"+gn(s)+":"+gn(a)+"."+Qa(o,3)+c:a?"T"+gn(r)+":"+gn(s)+":"+gn(a)+c:s||r||!u?"T"+gn(r)+":"+gn(s)+c:"")}function $m(t,e){return isNaN(t)?"Invalid Date":Um(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),!1,e)}function cu(t,e){return isNaN(t)?"Invalid Date":Um(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds(),!0,e)}const II=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function TI(t){return t.match(II)&&!isNaN(Date.parse(t))}function AI(t,e=Date.parse){return TI(t)?e(t):t}const jm=6e4,zm=864e5,qm=6048e5,Rt=new Date,Lt=new Date,Vt=t=>(Rt.setTime(typeof t=="string"?AI(t):t),Rt);function CI(t,e,n,r,s,a,o){return arguments.length?new Date(t,e||0,n??1,r||0,s||0,a||0,o||0):new Date(Date.now())}function kI(t,e,n,r,s,a,o){return arguments.length?new Date(Date.UTC(t,e||0,n??1,r||0,s||0,a||0,o||0)):new Date(Date.now())}function MI(t){Lt.setTime(+t),Lt.setHours(0,0,0,0),Rt.setTime(+Lt),Rt.setMonth(0),Rt.setDate(1);const e=(Lt.getTimezoneOffset()-Rt.getTimezoneOffset())*jm;return Math.floor(1+(Lt-Rt-e)/zm)}function NI(t){Lt.setTime(+t),Lt.setUTCHours(0,0,0,0);const e=Date.UTC(Lt.getUTCFullYear(),0,1);return Math.floor(1+(Lt-e)/zm)}function EI(t,e){const n=e||0;Lt.setTime(+t),Lt.setDate(Lt.getDate()-(Lt.getDay()+7-n)%7),Lt.setHours(0,0,0,0),Rt.setTime(+t),Rt.setMonth(0),Rt.setDate(1),Rt.setDate(1-(Rt.getDay()+7-n)%7),Rt.setHours(0,0,0,0);const r=(Lt.getTimezoneOffset()-Rt.getTimezoneOffset())*jm;return Math.floor((1+(Lt-Rt)-r)/qm)}function OI(t,e){const n=e||0;return Lt.setTime(+t),Lt.setUTCDate(Lt.getUTCDate()-(Lt.getUTCDay()+7-n)%7),Lt.setUTCHours(0,0,0,0),Rt.setTime(+t),Rt.setUTCMonth(0),Rt.setUTCDate(1),Rt.setUTCDate(1-(Rt.getUTCDay()+7-n)%7),Rt.setUTCHours(0,0,0,0),Math.floor((1+(Lt-Rt))/qm)}const DI={format_date:(t,e)=>$m(Vt(t),!e),format_utcdate:(t,e)=>cu(Vt(t),!e),timestamp:t=>+Vt(t),year:t=>Vt(t).getFullYear(),quarter:t=>Math.floor(Vt(t).getMonth()/3),month:t=>Vt(t).getMonth(),date:t=>Vt(t).getDate(),dayofweek:t=>Vt(t).getDay(),hours:t=>Vt(t).getHours(),minutes:t=>Vt(t).getMinutes(),seconds:t=>Vt(t).getSeconds(),milliseconds:t=>Vt(t).getMilliseconds(),utcyear:t=>Vt(t).getUTCFullYear(),utcquarter:t=>Math.floor(Vt(t).getUTCMonth()/3),utcmonth:t=>Vt(t).getUTCMonth(),utcdate:t=>Vt(t).getUTCDate(),utcdayofweek:t=>Vt(t).getUTCDay(),utchours:t=>Vt(t).getUTCHours(),utcminutes:t=>Vt(t).getUTCMinutes(),utcseconds:t=>Vt(t).getUTCSeconds(),utcmilliseconds:t=>Vt(t).getUTCMilliseconds(),datetime:CI,dayofyear:MI,week:EI,utcdatetime:kI,utcdayofyear:NI,utcweek:OI,now:Date.now};function Nc(t,e){return t==null||e==null||t!==t||e!==e?!1:t===e?!0:ri(t)||ri(e)?+t==+e:To(t)&&To(e)?t+""==e+"":re(t)&&re(e)?FI(t,e):!1}function FI(t,e){if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;if(t.length||e.length)return md(t,e);const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length||(n.sort(),r.sort(),!md(n,r,(a,o)=>a===o)))return!1;const s=n.length;for(let a=0;a<s;++a){const o=n[a];if(!Nc(t[o],e[o]))return!1}return!0}function md(t,e,n=Nc){const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;++s)if(!n(t[s],e[s]))return!1;return!0}const BI={parse_json:t=>JSON.parse(t),to_json:t=>JSON.stringify(t)};let RI=Math.random;function cs(){return RI()}const LI={random:cs,is_nan:Number.isNaN,is_finite:Number.isFinite,abs:Math.abs,cbrt:Math.cbrt,ceil:Math.ceil,clz32:Math.clz32,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,fround:Math.fround,greatest:Math.max,least:Math.min,log:Math.log,log10:Math.log10,log1p:Math.log1p,log2:Math.log2,pow:Math.pow,round:Math.round,sign:Math.sign,sqrt:Math.sqrt,trunc:Math.trunc,degrees:t=>180*t/Math.PI,radians:t=>Math.PI*t/180,acos:Math.acos,acosh:Math.acosh,asin:Math.asin,asinh:Math.asinh,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,cos:Math.cos,cosh:Math.cosh,sin:Math.sin,sinh:Math.sinh,tan:Math.tan,tanh:Math.tanh};function Ec(t){return t instanceof Map}function PI(t){return t instanceof Set}function Ja(t){return Ec(t)||PI(t)}function Qu(t){return Array.from(t)}const VI={has:(t,e)=>Ja(t)?t.has(e):t!=null?hn(t,e):!1,keys:t=>Ec(t)?Qu(t.keys()):t!=null?Object.keys(t):[],values:t=>Ja(t)?Qu(t.values()):t!=null?Object.values(t):[],entries:t=>Ja(t)?Qu(t.entries()):t!=null?Object.entries(t):[],object:t=>t?Object.fromEntries(t):vt};function UI(t,e,n){if(e instanceof Map){if(e.has(t))return e.get(t)}else if(hn(e,t))return e[t];return n!==void 0?n:t}function $I(t,e,n){let r=arguments.length;t=+t,e=+e,n=r<2?(e=t,t=0,1):r<3?1:+n,r=Math.max(0,Math.ceil((e-t)/n))|0;const s=new Array(r);for(let a=0;a<r;++a)s[a]=t+a*n;return s}const jI={parse_date:t=>t==null?t:new Date(t),parse_float:t=>t==null?t:Number.parseFloat(t),parse_int:(t,e)=>t==null?t:Number.parseInt(t,e),endswith:(t,e,n)=>t==null?!1:String(t).endsWith(e,n),match:(t,e,n)=>{const r=t==null?t:String(t).match(e);return n==null||r==null?r:typeof n=="number"?r[n]:r.groups?r.groups[n]:null},normalize:(t,e)=>t==null?t:String(t).normalize(e),padend:(t,e,n)=>t==null?t:String(t).padEnd(e,n),padstart:(t,e,n)=>t==null?t:String(t).padStart(e,n),upper:t=>t==null?t:String(t).toUpperCase(),lower:t=>t==null?t:String(t).toLowerCase(),repeat:(t,e)=>t==null?t:String(t).repeat(e),replace:(t,e,n)=>t==null?t:String(t).replace(e,String(n)),substring:(t,e,n)=>t==null?t:String(t).substring(e,n),split:(t,e,n)=>t==null?[]:String(t).split(e,n),startswith:(t,e,n)=>t==null?!1:String(t).startsWith(e,n),trim:t=>t==null?t:String(t).trim()},Ar={bin:xI,equal:Nc,recode:UI,sequence:$I,...wI,...DI,...BI,...LI,...VI,...jI};function ta(t){return typeof t=="bigint"}function Bn(t){return t===void 0?t+"":ta(t)?t+"n":JSON.stringify(t)}function nt(t,e=[],n=[]){return new zI(t,Te(e),Te(n))}let zI=class{constructor(e,n,r){this.name=e,this.fields=n,this.params=r}toString(){const e=[...this.fields.map(n=>`d[${Bn(n)}]`),...this.params.map(Bn)];return`d => op.${this.name}(${e})`}toObject(){return{expr:this.toString(),func:!0}}};const Wm=t=>nt("any",t),Hm=()=>nt("count"),Ym=t=>nt("array_agg",t),Gm=t=>nt("array_agg_distinct",t),Km=(t,e)=>nt("map_agg",[t,e]),Qm=(t,e)=>nt("object_agg",[t,e]),Jm=(t,e)=>nt("entries_agg",[t,e]);({...Ar});function qI(t,e){t=Ja(t)?t:new Set(t);let n=e,r=0;for(;t.has(n);)n=e+ ++r;return n}function WI(t,e){if(!t||!e)return t;const{keys:n,rows:r,size:s}=t,a=new Int32Array(s);e.scan(h=>a[n[h]]=1);const o=a.reduce((h,f)=>h+f,0);if(o===s)return t;const u=Array(o);let l=0;for(let h=0;h<s;++h)a[h]&&(u[a[h]=l++]=r[h]);const c=new Uint32Array(n.length);return e.scan(h=>c[h]=a[n[h]]),{...t,keys:c,rows:u,size:l}}function HI(t,e,n,r){const{keys:s,rows:a,size:o}=t;let u=a,l=o,c=null;if(n){c=new Int32Array(o),e(p=>c[s[p]]=1);const m=c.reduce((p,g)=>p+g,0);if(m!==o){u=Array(m),l=0;for(let p=0;p<o;++p)c[p]&&(u[c[p]=l++]=a[p])}}let h=-1;const f=new Uint32Array(r);return e(l!==o?m=>f[++h]=c[s[m]]:m=>f[++h]=s[m]),{...t,keys:f,rows:u,size:l}}function YI(t,e,n,r){const s=r==="map"||r===!0?Km:r==="entries"?Jm:r==="object"?Qm:it('groups option must be "map", "entries", or "object".'),{names:a}=t.groups(),o=qI(t.columnNames(),"_");let u=t.select().reify(e).create({data:{[o]:n}}).rollup({[o]:Ym(o)});for(let l=a.length;--l>=0;)u=u.groupby(a.slice(0,l)).rollup({[o]:s(a[l],o)});return u.get(o)}const GI="ArrayPattern",KI="ArrowFunctionExpression",QI="FunctionExpression",ki="Identifier",hs="Literal",Xm="MemberExpression",JI="ObjectExpression",Zm="ObjectPattern",t0="Property",_a="Column",XI="Constant",ZI="Dictionary",tT="Function",eT="Parameter",e0="Op",Nt=(t,e)=>{const n=nT[t.type];return n?n(t,e):it(`Unsupported expression construct: ${t.type}`)},Ju=(t,e)=>"("+Nt(t.left,e)+" "+t.operator+" "+Nt(t.right,e)+")",Xu=(t,e)=>"("+_n(t.params,e)+")=>"+Nt(t.body,e),yd=(t,e)=>Nt(t.callee,e)+"("+_n(t.arguments,e)+")",_n=(t,e,n=",")=>t.map(r=>Nt(r,e)).join(n),n0=t=>t.computed?`[${Bn(t.name)}]`:`.${t.name}`,gd=(t,e,n)=>{const r=t.table||"";return`data${r}${n0(t)}.${n}(${e.index}${r})`},nT={Constant:t=>t.raw,Column:(t,e)=>gd(t,e,"get"),Dictionary:(t,e)=>gd(t,e,"key"),Function:t=>`fn.${t.name}`,Parameter:t=>`$${n0(t)}`,Op:(t,e)=>`op(${Bn(t.name)},${e.op||e.index})`,Literal:t=>t.raw,Identifier:t=>t.name,TemplateLiteral:(t,e)=>{const{quasis:n,expressions:r}=t,s=r.length;let a=n[0].value.raw;for(let o=0;o<s;)a+="${"+Nt(r[o],e)+"}"+n[++o].value.raw;return"`"+a+"`"},MemberExpression:(t,e)=>{const n=!t.computed,r=Nt(t.object,e),s=Nt(t.property,e);return r+(n?"."+s:"["+s+"]")},CallExpression:yd,NewExpression:(t,e)=>"new "+yd(t,e),ArrayExpression:(t,e)=>"["+_n(t.elements,e)+"]",AssignmentExpression:Ju,BinaryExpression:Ju,LogicalExpression:Ju,UnaryExpression:(t,e)=>"("+t.operator+Nt(t.argument,e)+")",ConditionalExpression:(t,e)=>"("+Nt(t.test,e)+"?"+Nt(t.consequent,e)+":"+Nt(t.alternate,e)+")",ObjectExpression:(t,e)=>"({"+_n(t.properties,e)+"})",Property:(t,e)=>{const n=Nt(t.key,e);return(t.computed?`[${n}]`:n)+":"+Nt(t.value,e)},ArrowFunctionExpression:Xu,FunctionExpression:Xu,FunctionDeclaration:Xu,ArrayPattern:(t,e)=>"["+_n(t.elements,e)+"]",ObjectPattern:(t,e)=>"{"+_n(t.properties,e)+"}",VariableDeclaration:(t,e)=>t.kind+" "+_n(t.declarations,e,","),VariableDeclarator:(t,e)=>Nt(t.id,e)+"="+Nt(t.init,e),SpreadElement:(t,e)=>"..."+Nt(t.argument,e),BlockStatement:(t,e)=>"{"+_n(t.body,e,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(t,e)=>Nt(t.expression,e),IfStatement:(t,e)=>"if ("+Nt(t.test,e)+")"+Nt(t.consequent,e)+(t.alternate?" else "+Nt(t.alternate,e):""),SwitchStatement:(t,e)=>"switch ("+Nt(t.discriminant,e)+") {"+_n(t.cases,e,"")+"}",SwitchCase:(t,e)=>(t.test?"case "+Nt(t.test,e):"default")+": "+_n(t.consequent,e,";")+";",ReturnStatement:(t,e)=>"return "+Nt(t.argument,e),Program:(t,e)=>Nt(t.body[0],e)};function Ao(t,e={index:"row"}){return Nt(t,e)}function iT(t,e,n=15,r=!0,s=0,a){const u=Math.LN10;if(a==null){const l=Math.ceil(Math.log(n)/u),c=e-t||Math.abs(t)||1,h=[5,2];for(a=Math.max(s,Math.pow(10,Math.round(Math.log(c)/u)-l));Math.ceil(c/a)>n;)a*=10;const f=h.length;for(let d=0;d<f;++d){const m=a/h[d];m>=s&&c/m<=n&&(a=m)}}if(r){let l=Math.log(a);const c=l>=0?0:~~(-l/u)+1,h=Math.pow(10,-c-1);l=Math.floor(t/a+h)*a,t=t<l?l-a:l,e=Math.ceil(e/a)*a}return[t,e===t?t+a:e,a]}function Kr(t){const e=typeof t;return e==="string"?`"${t}"`:e!=="object"||!t?t:ri(t)?+t:bt(t)||va(t)?`[${t.map(Kr)}]`:To(t)?t+"":rT(t)}function rT(t){let e="{",n=-1;for(const r in t)++n>0&&(e+=","),e+=`"${r}":${Kr(t[r])}`;return e+="}",e}function Co(t,e){const n=t.length;return n===1?(r,s)=>Kr(t[0](r,s)):(r,s)=>{let a="";for(let o=0;o<n;++o){o>0&&(a+="|");const u=t[o](r,s);if(e&&(u==null||u!==u))return null;a+=Kr(u)}return a}}function sT(){const t=new Map;return{count(){return t.size},values(){return Array.from(t.values(),e=>e.v)},increment(e){const n=Kr(e),r=t.get(n);r?++r.n:t.set(n,{v:e,n:1})},decrement(e){const n=Kr(e),r=t.get(n);r.n===1?t.delete(n):--r.n},forEach(e){t.forEach(({v:n,n:r})=>e(n,r))}}}function Gn(){}function aT(t,e=0,n=t.length){let r=t[e++];for(let s=e;s<n;++s)r*=t[s];return r}function $t(t){return t.init=t.init||Gn,t.add=t.add||Gn,t.rem=t.rem||Gn,t}function vd(t,e){return t.product_v=!1,t.product=e}const i0={count:{create:()=>$t({value:t=>t.count}),param:[]},array_agg:{create:()=>$t({init:t=>t.values=!0,value:t=>t.list.values(t.stream)}),param:[1]},object_agg:{create:()=>$t({init:t=>t.values=!0,value:t=>Object.fromEntries(t.list.values())}),param:[2]},map_agg:{create:()=>$t({init:t=>t.values=!0,value:t=>new Map(t.list.values())}),param:[2]},entries_agg:{create:()=>$t({init:t=>t.values=!0,value:t=>t.list.values(t.stream)}),param:[2]},any:{create:()=>$t({add:(t,e)=>{t.any==null&&(t.any=e)},value:t=>t.valid?t.any:vt}),param:[1]},valid:{create:()=>$t({value:t=>t.valid}),param:[1]},invalid:{create:()=>$t({value:t=>t.count-t.valid}),param:[1]},distinct:{create:()=>({init:t=>t.distinct=sT(),value:t=>t.distinct.count()+(t.valid===t.count?0:1),add:(t,e)=>t.distinct.increment(e),rem:(t,e)=>t.distinct.decrement(e)}),param:[1]},array_agg_distinct:{create:()=>$t({value:t=>t.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>$t({value:t=>{let e=vt,n=0;return t.distinct.forEach((r,s)=>{s>n&&(n=s,e=r)}),e}}),param:[1],req:["distinct"]},sum:{create:()=>({init:t=>t.sum=0,value:t=>t.valid?t.sum:vt,add:(t,e)=>ta(e)?t.sum===0?t.sum=e:t.sum+=e:t.sum+=+e,rem:(t,e)=>t.sum-=e}),param:[1]},product:{create:()=>({init:t=>vd(t,1),value:t=>t.valid?t.product_v?vd(t,aT(t.list.values())):t.product:void 0,add:(t,e)=>ta(e)&&t.product===1?t.product=e:t.product*=e,rem:(t,e)=>e==0||e===1/0||e===-1/0?t.product_v=!0:t.product/=e}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:t=>t.mean=0,value:t=>t.valid?t.mean:vt,add:(t,e)=>{t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid},rem:(t,e)=>{t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean}}),param:[1]},average:{create:()=>$t({value:t=>t.valid?t.mean:vt}),param:[1],req:["mean"]},variance:{create:()=>({init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):vt,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean)}),param:[1],req:["mean"]},variancep:{create:()=>$t({value:t=>t.valid>1?t.dev/t.valid:vt}),param:[1],req:["variance"]},stdev:{create:()=>$t({value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):vt}),param:[1],req:["variance"]},stdevp:{create:()=>$t({value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):vt}),param:[1],req:["variance"]},min:{create:()=>({init:t=>t.min=vt,value:t=>t.min=Number.isNaN(t.min)?t.list.min():t.min,add:(t,e)=>{(e<t.min||t.min===vt)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:t=>t.max=vt,value:t=>t.max=Number.isNaN(t.max)?t.list.max():t.max,add:(t,e)=>{(e>t.max||t.max===vt)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:t=>$t({value:e=>e.list.quantile(t)}),param:[1,1],req:["array_agg"]},median:{create:()=>$t({value:t=>t.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:t=>{t.cov=t.mean_x=t.mean_y=t.dev_x=t.dev_y=0},value:t=>t.valid>1?t.cov/(t.valid-1):vt,add:(t,e,n)=>{const r=e-t.mean_x,s=n-t.mean_y;t.mean_x+=r/t.valid,t.mean_y+=s/t.valid;const a=n-t.mean_y;t.dev_x+=r*(e-t.mean_x),t.dev_y+=s*a,t.cov+=r*a},rem:(t,e,n)=>{const r=e-t.mean_x,s=n-t.mean_y;t.mean_x-=t.valid?r/t.valid:t.mean_x,t.mean_y-=t.valid?s/t.valid:t.mean_y;const a=n-t.mean_y;t.dev_x-=r*(e-t.mean_x),t.dev_y-=s*a,t.cov-=r*a}}),param:[2]},covariancep:{create:()=>$t({value:t=>t.valid>1?t.cov/t.valid:vt}),param:[2],req:["covariance"]},corr:{create:()=>$t({value:t=>t.valid>1?t.cov/(Math.sqrt(t.dev_x)*Math.sqrt(t.dev_y)):vt}),param:[2],req:["covariance"]},bins:{create:(t,e,n,r)=>$t({value:s=>iT(s.min,s.max,t,e,n,r)}),param:[1,4],req:["min","max"]}},_d={create(){let t;return{init:()=>t=1,value:e=>{const n=e.index;return n&&!e.peer(n)?t=n+1:t}}},param:[]},bd={create(){let t;return{init:()=>t=0,value:e=>{const{index:n,peer:r,size:s}=e;let a=n;if(t<a){for(;a+1<s&&r(a+1);)++a;t=a}return(1+t)/s}}},param:[]},r0={row_number:{create(){return{init:Gn,value:t=>t.index+1}},param:[]},rank:_d,avg_rank:{create(){let t,e;return{init:()=>(t=-1,e=1),value:n=>{const r=n.index;if(r>=t){for(e=t=r+1;n.peer(t);e+=++t);e/=t-r}return e}}},param:[]},dense_rank:{create(){let t;return{init:()=>t=1,value:e=>{const n=e.index;return n&&!e.peer(n)?++t:t}}},param:[]},percent_rank:{create(){const{init:t,value:e}=_d.create();return{init:t,value:n=>(e(n)-1)/(n.size-1)}},param:[]},cume_dist:bd,ntile:{create(t){t=+t,t>0||it("ntile num must be greater than zero.");const{init:e,value:n}=bd.create();return{init:e,value:r=>Math.ceil(t*n(r))}},param:[0,1]},lag:{create(t,e=vt){return t=+t||1,{init:Gn,value:(n,r)=>{const s=n.index-t;return s>=0?n.value(s,r):e}}},param:[1,2]},lead:{create(t,e=vt){return t=+t||1,{init:Gn,value:(n,r)=>{const s=n.index+t;return s<n.size?n.value(s,r):e}}},param:[1,2]},first_value:{create(){return{init:Gn,value:(t,e)=>t.value(t.i0,e)}},param:[1]},last_value:{create(){return{init:Gn,value:(t,e)=>t.value(t.i1-1,e)}},param:[1]},nth_value:{create(t){return t=+t,t>0||it("nth_value nth must be greater than zero."),{init:Gn,value:(e,n)=>{const r=e.i0+(t-1);return r<e.i1?e.value(r,n):vt}}},param:[1,1]},fill_down:{create(t=vt){let e;return{init:()=>e=t,value:(n,r)=>{const s=n.value(n.index,r);return un(s)?e=s:e}}},param:[1,1]},fill_up:{create(t=vt){let e,n;return{init:()=>(e=t,n=-1),value:(r,s)=>r.index<=n?e:(n=oT(r,s,r.index))>=0?e=r.value(n,s):(n=r.size,e=t)}},param:[1,1]}};function oT(t,e,n){for(const r=t.size;n<r;++n)if(un(t.value(n,e)))return n;return-1}function Oc(t){return hn(i0,t)}function Dc(t){return hn(r0,t)}function s0(t){return hn(Ar,t)||t==="row_object"}function a0(t){return Oc(t)&&i0[t]}function o0(t){return Dc(t)&&r0[t]}function Ms(t,e,n){return t=`"use strict"; return ${t};`,Function("fn","$",t)(e,n)}const Fc={escape:(t,e,n)=>Ms(t,e,n),expr:(t,e)=>Ms(`(row,data,op)=>${t}`,Ar,e),expr2:(t,e)=>Ms(`(row0,data0,row,data)=>${t}`,Ar,e),join:(t,e)=>Ms(`(row1,data1,row2,data2)=>${t}`,Ar,e),param:(t,e)=>Ms(t,Ar,e)},uT={"==":1,"!=":1,"===":1,"!==":1};function u0(t,e,n=0,r,s){if(t.type=_a,t.name=e,t.table=n,s&&r&&Ot(r.keyFor)){const a=uT[s.operator]?s.left===t?s.right:s.left:s.callee&&s.callee.name==="equal"?s.arguments[s.arguments[0]===t?1:0]:null;a&&a.type===hs&&lT(s,t,a,r.keyFor(a.value))}return t}function lT(t,e,n,r){return r<0?(t.type=hs,t.value=!1,t.raw="false"):(e.type=ZI,n.value=r,n.raw=r+""),!0}function hu(t){return bt(t)?t:Ec(t)?t.entries():t?Object.entries(t):[]}const l0="row_object";function c0(t,e){t.type=JI;const n=t.properties=[];for(const r of hu(e)){const[s,a]=bt(r)?r:[r,r];n.push({type:t0,key:{type:hs,raw:Bn(a)},value:u0({computed:!0},s)})}return t}function h0(t){return Ao(c0({},t))}function f0(t){return Fc.expr(h0(t))}function Kn(t,e,n,r){function s(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function u(h){try{c(r.next(h))}catch(f){o(f)}}function l(h){try{c(r.throw(h))}catch(f){o(f)}}function c(h){h.done?a(h.value):s(h.value).then(u,l)}c((r=r.apply(t,e||[])).next())})}function wd(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ht(t){return this instanceof ht?(this.v=t,this):new ht(t)}function Ji(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,a=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){r[d]&&(s[d]=function(m){return new Promise(function(p,g){a.push([d,m,p,g])>1||u(d,m)})})}function u(d,m){try{l(r[d](m))}catch(p){f(a[0][3],p)}}function l(d){d.value instanceof ht?Promise.resolve(d.value.v).then(c,h):f(a[0][2],d)}function c(d){u("next",d)}function h(d){u("throw",d)}function f(d,m){d(m),a.shift(),a.length&&u(a[0][0],a[0][1])}}function Zu(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=t[s]?function(o){return(n=!n)?{value:ht(t[s](o)),done:!1}:a?a(o):o}:a}}function $s(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof wd=="function"?wd(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(o){return new Promise(function(u,l){o=t[a](o),s(u,l,o.done,o.value)})}}function s(a,o,u,l){Promise.resolve(l).then(function(c){a({value:c,done:u})},o)}}const cT=new TextDecoder("utf-8"),Fl=t=>cT.decode(t),hT=new TextEncoder,Bc=t=>hT.encode(t),fT=t=>typeof t=="boolean",_e=t=>typeof t=="function",$i=t=>t!=null&&Object(t)===t,fu=t=>$i(t)&&_e(t.then),Rc=t=>$i(t)&&_e(t[Symbol.iterator]),du=t=>$i(t)&&_e(t[Symbol.asyncIterator]),dT=t=>$i(t)&&"done"in t&&"value"in t,d0=t=>"_getDOMStream"in t&&"_getNodeStream"in t,pT=t=>$i(t)&&_e(t.abort)&&_e(t.getWriter)&&!d0(t),mT=t=>$i(t)&&_e(t.end)&&_e(t.write)&&fT(t.writable)&&!d0(t),yT=t=>$i(t)&&_e(t.clear)&&_e(t.bytes)&&_e(t.position)&&_e(t.setPosition)&&_e(t.capacity)&&_e(t.getBufferIdentifier)&&_e(t.createLong),Lc=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function gT(t){const e=t[0]?[t[0]]:[];let n,r,s,a;for(let o,u,l=0,c=0,h=t.length;++l<h;){if(o=e[c],u=t[l],!o||!u||o.buffer!==u.buffer||u.byteOffset<o.byteOffset){u&&(e[++c]=u);continue}if({byteOffset:n,byteLength:s}=o,{byteOffset:r,byteLength:a}=u,n+s<r||r+a<n){u&&(e[++c]=u);continue}e[c]=new Uint8Array(o.buffer,n,r-n+a)}return e}function ko(t,e,n=0,r=e.byteLength){const s=t.byteLength,a=new Uint8Array(t.buffer,t.byteOffset,s),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(r,s));return a.set(o,n),t}function Rn(t,e){const n=gT(t),r=n.reduce((h,f)=>h+f.byteLength,0);let s,a,o,u=0,l=-1;const c=Math.min(e||Number.POSITIVE_INFINITY,r);for(const h=n.length;++l<h;){if(s=n[l],a=s.subarray(0,Math.min(s.length,c-u)),c<=u+a.length){a.length<s.length?n[l]=s.subarray(a.length):a.length===s.length&&l++,o?ko(o,a,u):o=a;break}ko(o||(o=new Uint8Array(c)),a,u),u+=a.length}return[o||new Uint8Array(0),n.slice(l),r-(o?o.byteLength:0)]}function Ht(t,e){let n=dT(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=Bc(n)),n instanceof ArrayBuffer?new t(n):n instanceof Lc?new t(n):yT(n)?Ht(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0)}const Ns=t=>Ht(Int32Array,t),At=t=>Ht(Uint8Array,t),Bl=t=>(t.next(),t);function*vT(t,e){const n=function*(s){yield s},r=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Lc?n(e):Rc(e)?e:n(e);return yield*Bl(function*(s){let a=null;do a=s.next(yield Ht(t,a));while(!a.done)}(r[Symbol.iterator]())),new t}const _T=t=>vT(Uint8Array,t);function p0(t,e){return Ji(this,arguments,function*(){if(fu(e))return yield ht(yield ht(yield*Zu($s(p0(t,yield ht(e))))));const r=function(o){return Ji(this,arguments,function*(){yield yield ht(yield ht(o))})},s=function(o){return Ji(this,arguments,function*(){yield ht(yield*Zu($s(Bl(function*(u){let l=null;do l=u.next(yield l==null?void 0:l.value);while(!l.done)}(o[Symbol.iterator]())))))})},a=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Lc?r(e):Rc(e)?s(e):du(e)?e:r(e);return yield ht(yield*Zu($s(Bl(function(o){return Ji(this,arguments,function*(){let u=null;do u=yield ht(o.next(yield yield ht(Ht(t,u))));while(!u.done)})}(a[Symbol.asyncIterator]()))))),yield ht(new t)})}const bT=t=>p0(Uint8Array,t);function m0(t,e,n){if(t!==0){n=n.slice(0,e);for(let r=-1,s=n.length;++r<s;)n[r]+=t}return n.subarray(0,e)}function wT(t,e){let n=0;const r=t.length;if(r!==e.length)return!1;if(r>0)do if(t[n]!==e[n])return!1;while(++n<r);return!0}const xd={fromIterable(t){return Ua(xT(t))},fromAsyncIterable(t){return Ua(ST(t))},fromDOMStream(t){return Ua(IT(t))},fromNodeStream(t){return Ua(AT(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},Ua=t=>(t.next(),t);function*xT(t){let e,n=!1,r=[],s,a,o,u=0;function l(){return a==="peek"?Rn(r,o)[0]:([s,r,u]=Rn(r,o),s)}({cmd:a,size:o}=yield null);const c=_T(t)[Symbol.iterator]();try{do if({done:e,value:s}=Number.isNaN(o-u)?c.next():c.next(o-u),!e&&s.byteLength>0&&(r.push(s),u+=s.byteLength),e||o<=u)do({cmd:a,size:o}=yield l());while(o<u);while(!e)}catch(h){(n=!0)&&typeof c.throw=="function"&&c.throw(h)}finally{n===!1&&typeof c.return=="function"&&c.return(null)}return null}function ST(t){return Ji(this,arguments,function*(){let n,r=!1,s=[],a,o,u,l=0;function c(){return o==="peek"?Rn(s,u)[0]:([a,s,l]=Rn(s,u),a)}({cmd:o,size:u}=yield yield ht(null));const h=bT(t)[Symbol.asyncIterator]();try{do if({done:n,value:a}=Number.isNaN(u-l)?yield ht(h.next()):yield ht(h.next(u-l)),!n&&a.byteLength>0&&(s.push(a),l+=a.byteLength),n||u<=l)do({cmd:o,size:u}=yield yield ht(c()));while(u<l);while(!n)}catch(f){(r=!0)&&typeof h.throw=="function"&&(yield ht(h.throw(f)))}finally{r===!1&&typeof h.return=="function"&&(yield ht(h.return(new Uint8Array(0))))}return yield ht(null)})}function IT(t){return Ji(this,arguments,function*(){let n=!1,r=!1,s=[],a,o,u,l=0;function c(){return o==="peek"?Rn(s,u)[0]:([a,s,l]=Rn(s,u),a)}({cmd:o,size:u}=yield yield ht(null));const h=new TT(t);try{do if({done:n,value:a}=Number.isNaN(u-l)?yield ht(h.read()):yield ht(h.read(u-l)),!n&&a.byteLength>0&&(s.push(At(a)),l+=a.byteLength),n||u<=l)do({cmd:o,size:u}=yield yield ht(c()));while(u<l);while(!n)}catch(f){(r=!0)&&(yield ht(h.cancel(f)))}finally{r===!1?yield ht(h.cancel()):t.locked&&h.releaseLock()}return yield ht(null)})}class TT{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return Kn(this,void 0,void 0,function*(){const{reader:n,source:r}=this;n&&(yield n.cancel(e).catch(()=>{})),r&&r.locked&&this.releaseLock()})}read(e){return Kn(this,void 0,void 0,function*(){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};const n=yield this.reader.read();return!n.done&&(n.value=At(n)),n})}}const tl=(t,e)=>{const n=s=>r([e,s]);let r;return[e,n,new Promise(s=>(r=s)&&t.once(e,n))]};function AT(t){return Ji(this,arguments,function*(){const n=[];let r="error",s=!1,a=null,o,u,l=0,c=[],h;function f(){return o==="peek"?Rn(c,u)[0]:([h,c,l]=Rn(c,u),h)}if({cmd:o,size:u}=yield yield ht(null),t.isTTY)return yield yield ht(new Uint8Array(0)),yield ht(null);try{n[0]=tl(t,"end"),n[1]=tl(t,"error");do{if(n[2]=tl(t,"readable"),[r,a]=yield ht(Promise.race(n.map(m=>m[2]))),r==="error")break;if((s=r==="end")||(Number.isFinite(u-l)?(h=At(t.read(u-l)),h.byteLength<u-l&&(h=At(t.read()))):h=At(t.read()),h.byteLength>0&&(c.push(h),l+=h.byteLength)),s||u<=l)do({cmd:o,size:u}=yield yield ht(f()));while(u<l)}while(!s)}finally{yield ht(d(n,r==="error"?a:null))}return yield ht(null);function d(m,p){return h=c=null,new Promise((g,y)=>{for(const[_,b]of m)t.off(_,b);try{const _=t.destroy;_&&_.call(t,p),p=void 0}catch(_){p=_||p}finally{p!=null?y(p):g()}})}})}var le;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(le||(le={}));var Ae;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})(Ae||(Ae={}));var Xt;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(Xt||(Xt={}));var Ln;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Ln||(Ln={}));var j;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(j||(j={}));var Pn;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Pn||(Pn={}));var Yt;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(Yt||(Yt={}));var w;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t[t.DurationSecond=-27]="DurationSecond",t[t.DurationMillisecond=-28]="DurationMillisecond",t[t.DurationMicrosecond=-29]="DurationMicrosecond",t[t.DurationNanosecond=-30]="DurationNanosecond"})(w||(w={}));var Hn;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(Hn||(Hn={}));const CT=void 0;function lr(t){if(t===null)return"null";if(t===CT)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map(e=>lr(e))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,(e,n)=>typeof n=="bigint"?`${n}`:n)}const kT=Symbol.for("isArrowBigNum");function mn(t,...e){return e.length===0?Object.setPrototypeOf(Ht(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}mn.prototype[kT]=!0;mn.prototype.toJSON=function(){return`"${na(this)}"`};mn.prototype.valueOf=function(){return y0(this)};mn.prototype.toString=function(){return na(this)};mn.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return y0(this);case"string":return na(this);case"default":return MT(this)}return na(this)};function Fr(...t){return mn.apply(this,t)}function Br(...t){return mn.apply(this,t)}function ea(...t){return mn.apply(this,t)}Object.setPrototypeOf(Fr.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Br.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(ea.prototype,Object.create(Uint32Array.prototype));Object.assign(Fr.prototype,mn.prototype,{constructor:Fr,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(Br.prototype,mn.prototype,{constructor:Br,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(ea.prototype,mn.prototype,{constructor:ea,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function y0(t){const{buffer:e,byteOffset:n,length:r,signed:s}=t,a=new BigUint64Array(e,n,r),o=s&&a.at(-1)&BigInt(1)<<BigInt(63);let u=BigInt(o?1:0),l=BigInt(0);if(o){for(const c of a)u+=~c*(BigInt(1)<<BigInt(32)*l++);u*=BigInt(-1)}else for(const c of a)u+=c*(BigInt(1)<<BigInt(32)*l++);return u}const na=t=>{if(t.byteLength===8)return`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`;if(!t.signed)return el(t);let e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);if(new Int16Array([e.at(-1)])[0]>=0)return el(t);e=e.slice();let r=1;for(let a=0;a<e.length;a++){const o=e[a],u=~o+r;e[a]=u,r&=o===0?1:0}return`-${el(e)}`},MT=t=>t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:na(t);function el(t){let e="";const n=new Uint32Array(2);let r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const s=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let a=-1;const o=r.length-1;do{for(n[0]=r[a=0];a<o;)r[a++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+r[a];r[a]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,e=`${n[0]}${e}`}while(s[0]||s[1]||s[2]||s[3]);return e??"0"}class Pc{static new(e,n){switch(n){case!0:return new Fr(e);case!1:return new Br(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Fr(e)}return e.byteLength===16?new ea(e):new Br(e)}static signed(e){return new Fr(e)}static unsigned(e){return new Br(e)}static decimal(e){return new ea(e)}constructor(e,n){return Pc.new(e,n)}}function fn(t){if(typeof t=="bigint"&&(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER))throw new TypeError(`${t} is not safe to convert to a number.`);return Number(t)}var g0,v0,_0,b0,w0,x0,S0,I0,T0,A0,C0,k0,M0,N0,E0,O0,D0,F0,B0,R0;class et{static isNull(e){return(e==null?void 0:e.typeId)===w.Null}static isInt(e){return(e==null?void 0:e.typeId)===w.Int}static isFloat(e){return(e==null?void 0:e.typeId)===w.Float}static isBinary(e){return(e==null?void 0:e.typeId)===w.Binary}static isUtf8(e){return(e==null?void 0:e.typeId)===w.Utf8}static isBool(e){return(e==null?void 0:e.typeId)===w.Bool}static isDecimal(e){return(e==null?void 0:e.typeId)===w.Decimal}static isDate(e){return(e==null?void 0:e.typeId)===w.Date}static isTime(e){return(e==null?void 0:e.typeId)===w.Time}static isTimestamp(e){return(e==null?void 0:e.typeId)===w.Timestamp}static isInterval(e){return(e==null?void 0:e.typeId)===w.Interval}static isDuration(e){return(e==null?void 0:e.typeId)===w.Duration}static isList(e){return(e==null?void 0:e.typeId)===w.List}static isStruct(e){return(e==null?void 0:e.typeId)===w.Struct}static isUnion(e){return(e==null?void 0:e.typeId)===w.Union}static isFixedSizeBinary(e){return(e==null?void 0:e.typeId)===w.FixedSizeBinary}static isFixedSizeList(e){return(e==null?void 0:e.typeId)===w.FixedSizeList}static isMap(e){return(e==null?void 0:e.typeId)===w.Map}static isDictionary(e){return(e==null?void 0:e.typeId)===w.Dictionary}static isDenseUnion(e){return et.isUnion(e)&&e.mode===Ae.Dense}static isSparseUnion(e){return et.isUnion(e)&&e.mode===Ae.Sparse}get typeId(){return w.NONE}}g0=Symbol.toStringTag;et[g0]=(t=>(t.children=null,t.ArrayType=Array,t[Symbol.toStringTag]="DataType"))(et.prototype);let si=class extends et{toString(){return"Null"}get typeId(){return w.Null}};v0=Symbol.toStringTag;si[v0]=(t=>t[Symbol.toStringTag]="Null")(si.prototype);class he extends et{constructor(e,n){super(),this.isSigned=e,this.bitWidth=n}get typeId(){return w.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}_0=Symbol.toStringTag;he[_0]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(he.prototype);class Vc extends he{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Uc extends he{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class Ni extends he{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class $c extends he{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class jc extends he{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class zc extends he{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class qc extends he{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class Wc extends he{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(Vc.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Uc.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Ni.prototype,"ArrayType",{value:Int32Array});Object.defineProperty($c.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(jc.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(zc.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(qc.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Wc.prototype,"ArrayType",{value:BigUint64Array});class Ei extends et{constructor(e){super(),this.precision=e}get typeId(){return w.Float}get ArrayType(){switch(this.precision){case Xt.HALF:return Uint16Array;case Xt.SINGLE:return Float32Array;case Xt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}b0=Symbol.toStringTag;Ei[b0]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Ei.prototype);class L0 extends Ei{constructor(){super(Xt.HALF)}}class Hc extends Ei{constructor(){super(Xt.SINGLE)}}class Yc extends Ei{constructor(){super(Xt.DOUBLE)}}Object.defineProperty(L0.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Hc.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Yc.prototype,"ArrayType",{value:Float64Array});let ia=class extends et{constructor(){super()}get typeId(){return w.Binary}toString(){return"Binary"}};w0=Symbol.toStringTag;ia[w0]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(ia.prototype);let Qr=class extends et{constructor(){super()}get typeId(){return w.Utf8}toString(){return"Utf8"}};x0=Symbol.toStringTag;Qr[x0]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Qr.prototype);let ra=class extends et{constructor(){super()}get typeId(){return w.Bool}toString(){return"Bool"}};S0=Symbol.toStringTag;ra[S0]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(ra.prototype);let Mo=class extends et{constructor(e,n,r=128){super(),this.scale=e,this.precision=n,this.bitWidth=r}get typeId(){return w.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};I0=Symbol.toStringTag;Mo[I0]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Mo.prototype);class Jr extends et{constructor(e){super(),this.unit=e}get typeId(){return w.Date}toString(){return`Date${(this.unit+1)*32}<${Ln[this.unit]}>`}}T0=Symbol.toStringTag;Jr[T0]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Jr.prototype);class NT extends Jr{constructor(){super(Ln.DAY)}}class ET extends Jr{constructor(){super(Ln.MILLISECOND)}}class ai extends et{constructor(e,n){super(),this.unit=e,this.bitWidth=n}get typeId(){return w.Time}toString(){return`Time${this.bitWidth}<${j[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}A0=Symbol.toStringTag;ai[A0]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(ai.prototype);class OT extends ai{constructor(){super(j.SECOND,32)}}class DT extends ai{constructor(){super(j.MILLISECOND,32)}}class FT extends ai{constructor(){super(j.MICROSECOND,64)}}class BT extends ai{constructor(){super(j.NANOSECOND,64)}}class No extends et{constructor(e,n){super(),this.unit=e,this.timezone=n}get typeId(){return w.Timestamp}toString(){return`Timestamp<${j[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}C0=Symbol.toStringTag;No[C0]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(No.prototype);class Xr extends et{constructor(e){super(),this.unit=e}get typeId(){return w.Interval}toString(){return`Interval<${Pn[this.unit]}>`}}k0=Symbol.toStringTag;Xr[k0]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Xr.prototype);class RT extends Xr{constructor(){super(Pn.DAY_TIME)}}class LT extends Xr{constructor(){super(Pn.YEAR_MONTH)}}let Eo=class extends et{constructor(e){super(),this.unit=e}get typeId(){return w.Duration}toString(){return`Duration<${j[this.unit]}>`}};M0=Symbol.toStringTag;Eo[M0]=(t=>(t.unit=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Duration"))(Eo.prototype);let Zr=class extends et{constructor(e){super(),this.children=[e]}get typeId(){return w.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};N0=Symbol.toStringTag;Zr[N0]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Zr.prototype);class ne extends et{constructor(e){super(),this.children=e}get typeId(){return w.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}E0=Symbol.toStringTag;ne[E0]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(ne.prototype);class sa extends et{constructor(e,n,r){super(),this.mode=e,this.children=r,this.typeIds=n=Int32Array.from(n),this.typeIdToChildIndex=n.reduce((s,a,o)=>(s[a]=o)&&s||s,Object.create(null))}get typeId(){return w.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}}O0=Symbol.toStringTag;sa[O0]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(sa.prototype);let Oo=class extends et{constructor(e){super(),this.byteWidth=e}get typeId(){return w.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};D0=Symbol.toStringTag;Oo[D0]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Oo.prototype);let ts=class extends et{constructor(e,n){super(),this.listSize=e,this.children=[n]}get typeId(){return w.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};F0=Symbol.toStringTag;ts[F0]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(ts.prototype);class aa extends et{constructor(e,n=!1){var r,s,a;if(super(),this.children=[e],this.keysSorted=n,e&&(e.name="entries",!((r=e==null?void 0:e.type)===null||r===void 0)&&r.children)){const o=(s=e==null?void 0:e.type)===null||s===void 0?void 0:s.children[0];o&&(o.name="key");const u=(a=e==null?void 0:e.type)===null||a===void 0?void 0:a.children[1];u&&(u.name="value")}}get typeId(){return w.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}B0=Symbol.toStringTag;aa[B0]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(aa.prototype);const PT=(t=>()=>++t)(-1);class Oi extends et{constructor(e,n,r,s){super(),this.indices=n,this.dictionary=e,this.isOrdered=s||!1,this.id=r==null?PT():fn(r)}get typeId(){return w.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}R0=Symbol.toStringTag;Oi[R0]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Oi.prototype);function Sn(t){const e=t;switch(t.typeId){case w.Decimal:return t.bitWidth/32;case w.Timestamp:return 2;case w.Date:return 1+e.unit;case w.Interval:return 1+e.unit;case w.FixedSizeList:return e.listSize;case w.FixedSizeBinary:return e.byteWidth;default:return 1}}class rt{visitMany(e,...n){return e.map((r,s)=>this.visit(r,...n.map(a=>a[s])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,n=!0){return VT(this,e,n)}getVisitFnByTypeId(e,n=!0){return br(this,e,n)}visitNull(e,...n){return null}visitBool(e,...n){return null}visitInt(e,...n){return null}visitFloat(e,...n){return null}visitUtf8(e,...n){return null}visitBinary(e,...n){return null}visitFixedSizeBinary(e,...n){return null}visitDate(e,...n){return null}visitTimestamp(e,...n){return null}visitTime(e,...n){return null}visitDecimal(e,...n){return null}visitList(e,...n){return null}visitStruct(e,...n){return null}visitUnion(e,...n){return null}visitDictionary(e,...n){return null}visitInterval(e,...n){return null}visitDuration(e,...n){return null}visitFixedSizeList(e,...n){return null}visitMap(e,...n){return null}}function VT(t,e,n=!0){return typeof e=="number"?br(t,e,n):typeof e=="string"&&e in w?br(t,w[e],n):e&&e instanceof et?br(t,Sd(e),n):e!=null&&e.type&&e.type instanceof et?br(t,Sd(e.type),n):br(t,w.NONE,n)}function br(t,e,n=!0){let r=null;switch(e){case w.Null:r=t.visitNull;break;case w.Bool:r=t.visitBool;break;case w.Int:r=t.visitInt;break;case w.Int8:r=t.visitInt8||t.visitInt;break;case w.Int16:r=t.visitInt16||t.visitInt;break;case w.Int32:r=t.visitInt32||t.visitInt;break;case w.Int64:r=t.visitInt64||t.visitInt;break;case w.Uint8:r=t.visitUint8||t.visitInt;break;case w.Uint16:r=t.visitUint16||t.visitInt;break;case w.Uint32:r=t.visitUint32||t.visitInt;break;case w.Uint64:r=t.visitUint64||t.visitInt;break;case w.Float:r=t.visitFloat;break;case w.Float16:r=t.visitFloat16||t.visitFloat;break;case w.Float32:r=t.visitFloat32||t.visitFloat;break;case w.Float64:r=t.visitFloat64||t.visitFloat;break;case w.Utf8:r=t.visitUtf8;break;case w.Binary:r=t.visitBinary;break;case w.FixedSizeBinary:r=t.visitFixedSizeBinary;break;case w.Date:r=t.visitDate;break;case w.DateDay:r=t.visitDateDay||t.visitDate;break;case w.DateMillisecond:r=t.visitDateMillisecond||t.visitDate;break;case w.Timestamp:r=t.visitTimestamp;break;case w.TimestampSecond:r=t.visitTimestampSecond||t.visitTimestamp;break;case w.TimestampMillisecond:r=t.visitTimestampMillisecond||t.visitTimestamp;break;case w.TimestampMicrosecond:r=t.visitTimestampMicrosecond||t.visitTimestamp;break;case w.TimestampNanosecond:r=t.visitTimestampNanosecond||t.visitTimestamp;break;case w.Time:r=t.visitTime;break;case w.TimeSecond:r=t.visitTimeSecond||t.visitTime;break;case w.TimeMillisecond:r=t.visitTimeMillisecond||t.visitTime;break;case w.TimeMicrosecond:r=t.visitTimeMicrosecond||t.visitTime;break;case w.TimeNanosecond:r=t.visitTimeNanosecond||t.visitTime;break;case w.Decimal:r=t.visitDecimal;break;case w.List:r=t.visitList;break;case w.Struct:r=t.visitStruct;break;case w.Union:r=t.visitUnion;break;case w.DenseUnion:r=t.visitDenseUnion||t.visitUnion;break;case w.SparseUnion:r=t.visitSparseUnion||t.visitUnion;break;case w.Dictionary:r=t.visitDictionary;break;case w.Interval:r=t.visitInterval;break;case w.IntervalDayTime:r=t.visitIntervalDayTime||t.visitInterval;break;case w.IntervalYearMonth:r=t.visitIntervalYearMonth||t.visitInterval;break;case w.Duration:r=t.visitDuration;break;case w.DurationSecond:r=t.visitDurationSecond||t.visitDuration;break;case w.DurationMillisecond:r=t.visitDurationMillisecond||t.visitDuration;break;case w.DurationMicrosecond:r=t.visitDurationMicrosecond||t.visitDuration;break;case w.DurationNanosecond:r=t.visitDurationNanosecond||t.visitDuration;break;case w.FixedSizeList:r=t.visitFixedSizeList;break;case w.Map:r=t.visitMap;break}if(typeof r=="function")return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${w[e]}'`)}function Sd(t){switch(t.typeId){case w.Null:return w.Null;case w.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?w.Int8:w.Uint8;case 16:return n?w.Int16:w.Uint16;case 32:return n?w.Int32:w.Uint32;case 64:return n?w.Int64:w.Uint64}return w.Int}case w.Float:switch(t.precision){case Xt.HALF:return w.Float16;case Xt.SINGLE:return w.Float32;case Xt.DOUBLE:return w.Float64}return w.Float;case w.Binary:return w.Binary;case w.Utf8:return w.Utf8;case w.Bool:return w.Bool;case w.Decimal:return w.Decimal;case w.Time:switch(t.unit){case j.SECOND:return w.TimeSecond;case j.MILLISECOND:return w.TimeMillisecond;case j.MICROSECOND:return w.TimeMicrosecond;case j.NANOSECOND:return w.TimeNanosecond}return w.Time;case w.Timestamp:switch(t.unit){case j.SECOND:return w.TimestampSecond;case j.MILLISECOND:return w.TimestampMillisecond;case j.MICROSECOND:return w.TimestampMicrosecond;case j.NANOSECOND:return w.TimestampNanosecond}return w.Timestamp;case w.Date:switch(t.unit){case Ln.DAY:return w.DateDay;case Ln.MILLISECOND:return w.DateMillisecond}return w.Date;case w.Interval:switch(t.unit){case Pn.DAY_TIME:return w.IntervalDayTime;case Pn.YEAR_MONTH:return w.IntervalYearMonth}return w.Interval;case w.Duration:switch(t.unit){case j.SECOND:return w.DurationSecond;case j.MILLISECOND:return w.DurationMillisecond;case j.MICROSECOND:return w.DurationMicrosecond;case j.NANOSECOND:return w.DurationNanosecond}return w.Duration;case w.Map:return w.Map;case w.List:return w.List;case w.Struct:return w.Struct;case w.Union:switch(t.mode){case Ae.Dense:return w.DenseUnion;case Ae.Sparse:return w.SparseUnion}return w.Union;case w.FixedSizeBinary:return w.FixedSizeBinary;case w.FixedSizeList:return w.FixedSizeList;case w.Dictionary:return w.Dictionary}throw new Error(`Unrecognized type '${w[t.typeId]}'`)}rt.prototype.visitInt8=null;rt.prototype.visitInt16=null;rt.prototype.visitInt32=null;rt.prototype.visitInt64=null;rt.prototype.visitUint8=null;rt.prototype.visitUint16=null;rt.prototype.visitUint32=null;rt.prototype.visitUint64=null;rt.prototype.visitFloat16=null;rt.prototype.visitFloat32=null;rt.prototype.visitFloat64=null;rt.prototype.visitDateDay=null;rt.prototype.visitDateMillisecond=null;rt.prototype.visitTimestampSecond=null;rt.prototype.visitTimestampMillisecond=null;rt.prototype.visitTimestampMicrosecond=null;rt.prototype.visitTimestampNanosecond=null;rt.prototype.visitTimeSecond=null;rt.prototype.visitTimeMillisecond=null;rt.prototype.visitTimeMicrosecond=null;rt.prototype.visitTimeNanosecond=null;rt.prototype.visitDenseUnion=null;rt.prototype.visitSparseUnion=null;rt.prototype.visitIntervalDayTime=null;rt.prototype.visitIntervalYearMonth=null;rt.prototype.visitDuration=null;rt.prototype.visitDurationSecond=null;rt.prototype.visitDurationMillisecond=null;rt.prototype.visitDurationMicrosecond=null;rt.prototype.visitDurationNanosecond=null;const P0=new Float64Array(1),vr=new Uint32Array(P0.buffer);function V0(t){const e=(t&31744)>>10,n=(t&1023)/1024,r=Math.pow(-1,(t&32768)>>15);switch(e){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,e-15)*(1+n)}function U0(t){if(t!==t)return 32256;P0[0]=t;const e=(vr[1]&2147483648)>>16&65535;let n=vr[1]&2146435072,r=0;return n>=1089470464?vr[0]>0?n=31744:(n=(n&2080374784)>>16,r=(vr[1]&1048575)>>10):n<=1056964608?(r=1048576+(vr[1]&1048575),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=(vr[1]&1048575)+512>>10),e|n|r&65535}class Y extends rt{}function J(t){return(e,n,r)=>{if(e.setValid(n,r!=null))return t(e,n,r)}}const UT=(t,e,n)=>{t[e]=Math.trunc(n/864e5)},Gc=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},$T=(t,e,n)=>{t[e]=Math.trunc(n*1e3%4294967296),t[e+1]=Math.trunc(n*1e3/4294967296)},jT=(t,e,n)=>{t[e]=Math.trunc(n*1e6%4294967296),t[e+1]=Math.trunc(n*1e6/4294967296)},$0=(t,e,n,r)=>{if(n+1<e.length){const{[n]:s,[n+1]:a}=e;t.set(r.subarray(0,a-s),s)}},zT=({offset:t,values:e},n,r)=>{const s=t+n;r?e[s>>3]|=1<<s%8:e[s>>3]&=~(1<<s%8)},ci=({values:t},e,n)=>{t[e]=n},Kc=({values:t},e,n)=>{t[e]=n},j0=({values:t},e,n)=>{t[e]=U0(n)},qT=(t,e,n)=>{switch(t.type.precision){case Xt.HALF:return j0(t,e,n);case Xt.SINGLE:case Xt.DOUBLE:return Kc(t,e,n)}},Qc=({values:t},e,n)=>{UT(t,e,n.valueOf())},Jc=({values:t},e,n)=>{Gc(t,e*2,n.valueOf())},z0=({stride:t,values:e},n,r)=>{e.set(r.subarray(0,t),t*n)},WT=({values:t,valueOffsets:e},n,r)=>$0(t,e,n,r),HT=({values:t,valueOffsets:e},n,r)=>{$0(t,e,n,Bc(r))},q0=(t,e,n)=>{t.type.unit===Ln.DAY?Qc(t,e,n):Jc(t,e,n)},Xc=({values:t},e,n)=>Gc(t,e*2,n/1e3),Zc=({values:t},e,n)=>Gc(t,e*2,n),th=({values:t},e,n)=>$T(t,e*2,n),eh=({values:t},e,n)=>jT(t,e*2,n),W0=(t,e,n)=>{switch(t.type.unit){case j.SECOND:return Xc(t,e,n);case j.MILLISECOND:return Zc(t,e,n);case j.MICROSECOND:return th(t,e,n);case j.NANOSECOND:return eh(t,e,n)}},nh=({values:t},e,n)=>{t[e]=n},ih=({values:t},e,n)=>{t[e]=n},rh=({values:t},e,n)=>{t[e]=n},sh=({values:t},e,n)=>{t[e]=n},H0=(t,e,n)=>{switch(t.type.unit){case j.SECOND:return nh(t,e,n);case j.MILLISECOND:return ih(t,e,n);case j.MICROSECOND:return rh(t,e,n);case j.NANOSECOND:return sh(t,e,n)}},Y0=({values:t,stride:e},n,r)=>{t.set(r.subarray(0,e),e*n)},YT=(t,e,n)=>{const r=t.children[0],s=t.valueOffsets,a=Ke.getVisitFn(r);if(Array.isArray(n))for(let o=-1,u=s[e],l=s[e+1];u<l;)a(r,u++,n[++o]);else for(let o=-1,u=s[e],l=s[e+1];u<l;)a(r,u++,n.get(++o))},GT=(t,e,n)=>{const r=t.children[0],{valueOffsets:s}=t,a=Ke.getVisitFn(r);let{[e]:o,[e+1]:u}=s;const l=n instanceof Map?n.entries():Object.entries(n);for(const c of l)if(a(r,o,c),++o>=u)break},KT=(t,e)=>(n,r,s,a)=>r&&n(r,t,e[a]),QT=(t,e)=>(n,r,s,a)=>r&&n(r,t,e.get(a)),JT=(t,e)=>(n,r,s,a)=>r&&n(r,t,e.get(s.name)),XT=(t,e)=>(n,r,s,a)=>r&&n(r,t,e[s.name]),ZT=(t,e,n)=>{const r=t.type.children.map(a=>Ke.getVisitFn(a.type)),s=n instanceof Map?JT(e,n):n instanceof wt?QT(e,n):Array.isArray(n)?KT(e,n):XT(e,n);t.type.children.forEach((a,o)=>s(r[o],t.children[o],a,o))},tA=(t,e,n)=>{t.type.mode===Ae.Dense?G0(t,e,n):K0(t,e,n)},G0=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],s=t.children[r];Ke.visit(s,t.valueOffsets[e],n)},K0=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],s=t.children[r];Ke.visit(s,e,n)},eA=(t,e,n)=>{var r;(r=t.dictionary)===null||r===void 0||r.set(t.values[e],n)},Q0=(t,e,n)=>{t.type.unit===Pn.DAY_TIME?ah(t,e,n):oh(t,e,n)},ah=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},oh=({values:t},e,n)=>{t[e]=n[0]*12+n[1]%12},uh=({values:t},e,n)=>{t[e]=n},lh=({values:t},e,n)=>{t[e]=n},ch=({values:t},e,n)=>{t[e]=n},hh=({values:t},e,n)=>{t[e]=n},J0=(t,e,n)=>{switch(t.type.unit){case j.SECOND:return uh(t,e,n);case j.MILLISECOND:return lh(t,e,n);case j.MICROSECOND:return ch(t,e,n);case j.NANOSECOND:return hh(t,e,n)}},nA=(t,e,n)=>{const{stride:r}=t,s=t.children[0],a=Ke.getVisitFn(s);if(Array.isArray(n))for(let o=-1,u=e*r;++o<r;)a(s,u+o,n[o]);else for(let o=-1,u=e*r;++o<r;)a(s,u+o,n.get(o))};Y.prototype.visitBool=J(zT);Y.prototype.visitInt=J(ci);Y.prototype.visitInt8=J(ci);Y.prototype.visitInt16=J(ci);Y.prototype.visitInt32=J(ci);Y.prototype.visitInt64=J(ci);Y.prototype.visitUint8=J(ci);Y.prototype.visitUint16=J(ci);Y.prototype.visitUint32=J(ci);Y.prototype.visitUint64=J(ci);Y.prototype.visitFloat=J(qT);Y.prototype.visitFloat16=J(j0);Y.prototype.visitFloat32=J(Kc);Y.prototype.visitFloat64=J(Kc);Y.prototype.visitUtf8=J(HT);Y.prototype.visitBinary=J(WT);Y.prototype.visitFixedSizeBinary=J(z0);Y.prototype.visitDate=J(q0);Y.prototype.visitDateDay=J(Qc);Y.prototype.visitDateMillisecond=J(Jc);Y.prototype.visitTimestamp=J(W0);Y.prototype.visitTimestampSecond=J(Xc);Y.prototype.visitTimestampMillisecond=J(Zc);Y.prototype.visitTimestampMicrosecond=J(th);Y.prototype.visitTimestampNanosecond=J(eh);Y.prototype.visitTime=J(H0);Y.prototype.visitTimeSecond=J(nh);Y.prototype.visitTimeMillisecond=J(ih);Y.prototype.visitTimeMicrosecond=J(rh);Y.prototype.visitTimeNanosecond=J(sh);Y.prototype.visitDecimal=J(Y0);Y.prototype.visitList=J(YT);Y.prototype.visitStruct=J(ZT);Y.prototype.visitUnion=J(tA);Y.prototype.visitDenseUnion=J(G0);Y.prototype.visitSparseUnion=J(K0);Y.prototype.visitDictionary=J(eA);Y.prototype.visitInterval=J(Q0);Y.prototype.visitIntervalDayTime=J(ah);Y.prototype.visitIntervalYearMonth=J(oh);Y.prototype.visitDuration=J(J0);Y.prototype.visitDurationSecond=J(uh);Y.prototype.visitDurationMillisecond=J(lh);Y.prototype.visitDurationMicrosecond=J(ch);Y.prototype.visitDurationNanosecond=J(hh);Y.prototype.visitFixedSizeList=J(nA);Y.prototype.visitMap=J(GT);const Ke=new Y,en=Symbol.for("parent"),Rr=Symbol.for("rowIndex");class fh{constructor(e,n){return this[en]=e,this[Rr]=n,new Proxy(this,new rA)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[Rr],n=this[en],r=n.type.children,s={};for(let a=-1,o=r.length;++a<o;)s[r[a].name]=Ce.visit(n.children[a],e);return s}toString(){return`{${[...this].map(([e,n])=>`${lr(e)}: ${lr(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new iA(this[en],this[Rr])}}class iA{constructor(e,n){this.childIndex=0,this.children=e.children,this.rowIndex=n,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,Ce.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(fh.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[en]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Rr]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class rA{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[en].type.children.map(n=>n.name)}has(e,n){return e[en].type.children.findIndex(r=>r.name===n)!==-1}getOwnPropertyDescriptor(e,n){if(e[en].type.children.findIndex(r=>r.name===n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,n){if(Reflect.has(e,n))return e[n];const r=e[en].type.children.findIndex(s=>s.name===n);if(r!==-1){const s=Ce.visit(e[en].children[r],e[Rr]);return Reflect.set(e,n,s),s}}set(e,n,r){const s=e[en].type.children.findIndex(a=>a.name===n);return s!==-1?(Ke.visit(e[en].children[s],e[Rr],r),Reflect.set(e,n,r)):Reflect.has(e,n)||typeof n=="symbol"?Reflect.set(e,n,r):!1}}class z extends rt{}function G(t){return(e,n)=>e.getValid(n)?t(e,n):null}const sA=(t,e)=>864e5*t[e],dh=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),aA=(t,e)=>4294967296*(t[e+1]/1e3)+(t[e]>>>0)/1e3,oA=(t,e)=>4294967296*(t[e+1]/1e6)+(t[e]>>>0)/1e6,X0=t=>new Date(t),uA=(t,e)=>X0(sA(t,e)),lA=(t,e)=>X0(dh(t,e)),cA=(t,e)=>null,Z0=(t,e,n)=>{if(n+1>=e.length)return null;const r=e[n],s=e[n+1];return t.subarray(r,s)},hA=({offset:t,values:e},n)=>{const r=t+n;return(e[r>>3]&1<<r%8)!==0},ty=({values:t},e)=>uA(t,e),ey=({values:t},e)=>lA(t,e*2),ji=({stride:t,values:e},n)=>e[t*n],fA=({stride:t,values:e},n)=>V0(e[t*n]),ny=({values:t},e)=>t[e],dA=({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)),pA=({values:t,valueOffsets:e},n)=>Z0(t,e,n),mA=({values:t,valueOffsets:e},n)=>{const r=Z0(t,e,n);return r!==null?Fl(r):null},yA=({values:t},e)=>t[e],gA=({type:t,values:e},n)=>t.precision!==Xt.HALF?e[n]:V0(e[n]),vA=(t,e)=>t.type.unit===Ln.DAY?ty(t,e):ey(t,e),iy=({values:t},e)=>1e3*dh(t,e*2),ry=({values:t},e)=>dh(t,e*2),sy=({values:t},e)=>aA(t,e*2),ay=({values:t},e)=>oA(t,e*2),_A=(t,e)=>{switch(t.type.unit){case j.SECOND:return iy(t,e);case j.MILLISECOND:return ry(t,e);case j.MICROSECOND:return sy(t,e);case j.NANOSECOND:return ay(t,e)}},oy=({values:t},e)=>t[e],uy=({values:t},e)=>t[e],ly=({values:t},e)=>t[e],cy=({values:t},e)=>t[e],bA=(t,e)=>{switch(t.type.unit){case j.SECOND:return oy(t,e);case j.MILLISECOND:return uy(t,e);case j.MICROSECOND:return ly(t,e);case j.NANOSECOND:return cy(t,e)}},wA=({values:t,stride:e},n)=>Pc.decimal(t.subarray(e*n,e*(n+1))),xA=(t,e)=>{const{valueOffsets:n,stride:r,children:s}=t,{[e*r]:a,[e*r+1]:o}=n,l=s[0].slice(a,o-a);return new wt([l])},SA=(t,e)=>{const{valueOffsets:n,children:r}=t,{[e]:s,[e+1]:a}=n,o=r[0];return new pu(o.slice(s,a-s))},IA=(t,e)=>new fh(t,e),TA=(t,e)=>t.type.mode===Ae.Dense?hy(t,e):fy(t,e),hy=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return Ce.visit(r,t.valueOffsets[e])},fy=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return Ce.visit(r,e)},AA=(t,e)=>{var n;return(n=t.dictionary)===null||n===void 0?void 0:n.get(t.values[e])},CA=(t,e)=>t.type.unit===Pn.DAY_TIME?dy(t,e):py(t,e),dy=({values:t},e)=>t.subarray(2*e,2*(e+1)),py=({values:t},e)=>{const n=t[e],r=new Int32Array(2);return r[0]=Math.trunc(n/12),r[1]=Math.trunc(n%12),r},my=({values:t},e)=>t[e],yy=({values:t},e)=>t[e],gy=({values:t},e)=>t[e],vy=({values:t},e)=>t[e],kA=(t,e)=>{switch(t.type.unit){case j.SECOND:return my(t,e);case j.MILLISECOND:return yy(t,e);case j.MICROSECOND:return gy(t,e);case j.NANOSECOND:return vy(t,e)}},MA=(t,e)=>{const{stride:n,children:r}=t,a=r[0].slice(e*n,n);return new wt([a])};z.prototype.visitNull=G(cA);z.prototype.visitBool=G(hA);z.prototype.visitInt=G(yA);z.prototype.visitInt8=G(ji);z.prototype.visitInt16=G(ji);z.prototype.visitInt32=G(ji);z.prototype.visitInt64=G(ny);z.prototype.visitUint8=G(ji);z.prototype.visitUint16=G(ji);z.prototype.visitUint32=G(ji);z.prototype.visitUint64=G(ny);z.prototype.visitFloat=G(gA);z.prototype.visitFloat16=G(fA);z.prototype.visitFloat32=G(ji);z.prototype.visitFloat64=G(ji);z.prototype.visitUtf8=G(mA);z.prototype.visitBinary=G(pA);z.prototype.visitFixedSizeBinary=G(dA);z.prototype.visitDate=G(vA);z.prototype.visitDateDay=G(ty);z.prototype.visitDateMillisecond=G(ey);z.prototype.visitTimestamp=G(_A);z.prototype.visitTimestampSecond=G(iy);z.prototype.visitTimestampMillisecond=G(ry);z.prototype.visitTimestampMicrosecond=G(sy);z.prototype.visitTimestampNanosecond=G(ay);z.prototype.visitTime=G(bA);z.prototype.visitTimeSecond=G(oy);z.prototype.visitTimeMillisecond=G(uy);z.prototype.visitTimeMicrosecond=G(ly);z.prototype.visitTimeNanosecond=G(cy);z.prototype.visitDecimal=G(wA);z.prototype.visitList=G(xA);z.prototype.visitStruct=G(IA);z.prototype.visitUnion=G(TA);z.prototype.visitDenseUnion=G(hy);z.prototype.visitSparseUnion=G(fy);z.prototype.visitDictionary=G(AA);z.prototype.visitInterval=G(CA);z.prototype.visitIntervalDayTime=G(dy);z.prototype.visitIntervalYearMonth=G(py);z.prototype.visitDuration=G(kA);z.prototype.visitDurationSecond=G(my);z.prototype.visitDurationMillisecond=G(yy);z.prototype.visitDurationMicrosecond=G(gy);z.prototype.visitDurationNanosecond=G(vy);z.prototype.visitFixedSizeList=G(MA);z.prototype.visitMap=G(SA);const Ce=new z,an=Symbol.for("keys"),Lr=Symbol.for("vals");class pu{constructor(e){return this[an]=new wt([e.children[0]]).memoize(),this[Lr]=e.children[1],new Proxy(this,new EA)}[Symbol.iterator](){return new NA(this[an],this[Lr])}get size(){return this[an].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[an],n=this[Lr],r={};for(let s=-1,a=e.length;++s<a;)r[e.get(s)]=Ce.visit(n,s);return r}toString(){return`{${[...this].map(([e,n])=>`${lr(e)}: ${lr(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class NA{constructor(e,n){this.keys=e,this.vals=n,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),Ce.visit(this.vals,e)]})}}class EA{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[an].toArray().map(String)}has(e,n){return e[an].includes(n)}getOwnPropertyDescriptor(e,n){if(e[an].indexOf(n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,n){if(Reflect.has(e,n))return e[n];const r=e[an].indexOf(n);if(r!==-1){const s=Ce.visit(Reflect.get(e,Lr),r);return Reflect.set(e,n,s),s}}set(e,n,r){const s=e[an].indexOf(n);return s!==-1?(Ke.visit(Reflect.get(e,Lr),s,r),Reflect.set(e,n,r)):Reflect.has(e,n)?Reflect.set(e,n,r):!1}}Object.defineProperties(pu.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[an]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Lr]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let Id;function _y(t,e,n,r){const{length:s=0}=t;let a=typeof e!="number"?0:e,o=typeof n!="number"?s:n;return a<0&&(a=(a%s+s)%s),o<0&&(o=(o%s+s)%s),o<a&&(Id=a,a=o,o=Id),o>s&&(o=s),r?r(t,a,o):[a,o]}const Td=t=>t!==t;function fs(t){if(typeof t!=="object"||t===null)return Td(t)?Td:n=>n===t;if(t instanceof Date){const n=t.valueOf();return r=>r instanceof Date?r.valueOf()===n:!1}return ArrayBuffer.isView(t)?n=>n?wT(t,n):!1:t instanceof Map?DA(t):Array.isArray(t)?OA(t):t instanceof wt?FA(t):BA(t,!0)}function OA(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=fs(t[n]);return mu(e)}function DA(t){let e=-1;const n=[];for(const r of t.values())n[++e]=fs(r);return mu(n)}function FA(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=fs(t.get(n));return mu(e)}function BA(t,e=!1){const n=Object.keys(t);if(!e&&n.length===0)return()=>!1;const r=[];for(let s=-1,a=n.length;++s<a;)r[s]=fs(t[n[s]]);return mu(r,n)}function mu(t,e){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return RA(t,n);case Map:return Ad(t,n,n.keys());case pu:case fh:case Object:case void 0:return Ad(t,n,e||Object.keys(n))}return n instanceof wt?LA(t,n):!1}}function RA(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e[r]))return!1;return!0}function LA(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e.get(r)))return!1;return!0}function Ad(t,e,n){const r=n[Symbol.iterator](),s=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),a=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let o=0;const u=t.length;let l=a.next(),c=r.next(),h=s.next();for(;o<u&&!c.done&&!h.done&&!l.done&&!(c.value!==h.value||!t[o](l.value));++o,c=r.next(),h=s.next(),l=a.next());return o===u&&c.done&&h.done&&l.done?!0:(r.return&&r.return(),s.return&&s.return(),a.return&&a.return(),!1)}function by(t,e,n,r){return(n&1<<r)!==0}function PA(t,e,n,r){return(n&1<<r)>>r}function Do(t,e,n){const r=n.byteLength+7&-8;if(t>0||n.byteLength<r){const s=new Uint8Array(r);return s.set(t%8===0?n.subarray(t>>3):wy(new ph(n,t,e,null,by)).subarray(0,r)),s}return n}function wy(t){const e=[];let n=0,r=0,s=0;for(const o of t)o&&(s|=1<<r),++r===8&&(e[n++]=s,s=r=0);(n===0||r>0)&&(e[n++]=s);const a=new Uint8Array(e.length+7&-8);return a.set(e),a}class ph{constructor(e,n,r,s,a){this.bytes=e,this.length=r,this.context=s,this.get=a,this.bit=n%8,this.byteIndex=n>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Rl(t,e,n){if(n-e<=0)return 0;if(n-e<8){let a=0;for(const o of new ph(t,e,n-e,t,PA))a+=o;return a}const r=n>>3<<3,s=e+(e%8===0?0:8-e%8);return Rl(t,e,s)+Rl(t,r,n)+VA(t,s>>3,r-s>>3)}function VA(t,e,n){let r=0,s=Math.trunc(e);const a=new DataView(t.buffer,t.byteOffset,t.byteLength),o=n===void 0?t.byteLength:s+n;for(;o-s>=4;)r+=nl(a.getUint32(s)),s+=4;for(;o-s>=2;)r+=nl(a.getUint16(s)),s+=2;for(;o-s>=1;)r+=nl(a.getUint8(s)),s+=1;return r}function nl(t){let e=Math.trunc(t);return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}const UA=-1;class Tt{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:e}=this;return et.isSparseUnion(e)?this.children.some(n=>n.nullable):et.isDenseUnion(e)?this.children.some(n=>n.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let e=0;const{valueOffsets:n,values:r,nullBitmap:s,typeIds:a}=this;return n&&(e+=n.byteLength),r&&(e+=r.byteLength),s&&(e+=s.byteLength),a&&(e+=a.byteLength),this.children.reduce((o,u)=>o+u.byteLength,e)}get nullCount(){if(et.isUnion(this.type))return this.children.reduce((r,s)=>r+s.nullCount,0);let e=this._nullCount,n;return e<=UA&&(n=this.nullBitmap)&&(this._nullCount=e=this.length-Rl(n,this.offset,this.offset+this.length)),e}constructor(e,n,r,s,a,o=[],u){this.type=e,this.children=o,this.dictionary=u,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(r||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1));let l;a instanceof Tt?(this.stride=a.stride,this.values=a.values,this.typeIds=a.typeIds,this.nullBitmap=a.nullBitmap,this.valueOffsets=a.valueOffsets):(this.stride=Sn(e),a&&((l=a[0])&&(this.valueOffsets=l),(l=a[1])&&(this.values=l),(l=a[2])&&(this.nullBitmap=l),(l=a[3])&&(this.typeIds=l)))}getValid(e){const{type:n}=this;if(et.isUnion(n)){const r=n,s=this.children[r.typeIdToChildIndex[this.typeIds[e]]],a=r.mode===Ae.Dense?this.valueOffsets[e]:e;return s.getValid(a)}if(this.nullable&&this.nullCount>0){const r=this.offset+e;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}setValid(e,n){let r;const{type:s}=this;if(et.isUnion(s)){const a=s,o=this.children[a.typeIdToChildIndex[this.typeIds[e]]],u=a.mode===Ae.Dense?this.valueOffsets[e]:e;r=o.getValid(u),o.setValid(u,n)}else{let{nullBitmap:a}=this;const{offset:o,length:u}=this,l=o+e,c=1<<l%8,h=l>>3;(!a||a.byteLength<=h)&&(a=new Uint8Array((o+u+63&-64)>>3).fill(255),this.nullCount>0&&a.set(Do(o,u,this.nullBitmap),0),Object.assign(this,{nullBitmap:a,_nullCount:-1}));const f=a[h];r=(f&c)!==0,n?a[h]=f|c:a[h]=f&~c}return r!==!!n&&(this._nullCount=this.nullCount+(n?-1:1)),n}clone(e=this.type,n=this.offset,r=this.length,s=this._nullCount,a=this,o=this.children){return new Tt(e,n,r,s,a,o,this.dictionary)}slice(e,n){const{stride:r,typeId:s,children:a}=this,o=+(this._nullCount===0)-1,u=s===16?r:1,l=this._sliceBuffers(e,n,r,s);return this.clone(this.type,this.offset+e,n,o,l,a.length===0||this.valueOffsets?a:this._sliceChildren(a,u*e,u*n))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===w.Null)return this.clone(this.type,0,e,0);const{length:n,nullCount:r}=this,s=new Uint8Array((e+63&-64)>>3).fill(255,0,n>>3);s[n>>3]=(1<<n-(n&-8))-1,r>0&&s.set(Do(this.offset,n,this.nullBitmap),0);const a=this.buffers;return a[Hn.VALIDITY]=s,this.clone(this.type,0,e,r+(e-n),a)}_sliceBuffers(e,n,r,s){let a;const{buffers:o}=this;return(a=o[Hn.TYPE])&&(o[Hn.TYPE]=a.subarray(e,e+n)),(a=o[Hn.OFFSET])&&(o[Hn.OFFSET]=a.subarray(e,e+n+1))||(a=o[Hn.DATA])&&(o[Hn.DATA]=s===6?a:a.subarray(r*e,r*(e+n))),o}_sliceChildren(e,n,r){return e.map(s=>s.slice(n,r))}}Tt.prototype.children=Object.freeze([]);class js extends rt{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{["type"]:n,["offset"]:r=0,["length"]:s=0}=e;return new Tt(n,r,s,s)}visitBool(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length>>3,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitInt(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitFloat(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitUtf8(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.data),a=At(e.nullBitmap),o=Ns(e.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:l=e.nullBitmap?-1:0}=e;return new Tt(n,r,u,l,[o,s,a])}visitBinary(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.data),a=At(e.nullBitmap),o=Ns(e.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:l=e.nullBitmap?-1:0}=e;return new Tt(n,r,u,l,[o,s,a])}visitFixedSizeBinary(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitDate(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitTimestamp(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitTime(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitDecimal(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitList(e){const{["type"]:n,["offset"]:r=0,["child"]:s}=e,a=At(e.nullBitmap),o=Ns(e.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:l=e.nullBitmap?-1:0}=e;return new Tt(n,r,u,l,[o,void 0,a],[s])}visitStruct(e){const{["type"]:n,["offset"]:r=0,["children"]:s=[]}=e,a=At(e.nullBitmap),{length:o=s.reduce((l,{length:c})=>Math.max(l,c),0),nullCount:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,void 0,a],s)}visitUnion(e){const{["type"]:n,["offset"]:r=0,["children"]:s=[]}=e,a=Ht(n.ArrayType,e.typeIds),{["length"]:o=a.length,["nullCount"]:u=-1}=e;if(et.isSparseUnion(n))return new Tt(n,r,o,u,[void 0,void 0,void 0,a],s);const l=Ns(e.valueOffsets);return new Tt(n,r,o,u,[l,void 0,void 0,a],s)}visitDictionary(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.indices.ArrayType,e.data),{["dictionary"]:o=new wt([new js().visit({type:n.dictionary})])}=e,{["length"]:u=a.length,["nullCount"]:l=e.nullBitmap?-1:0}=e;return new Tt(n,r,u,l,[void 0,a,s],[],o)}visitInterval(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitDuration(e){const{["type"]:n,["offset"]:r=0}=e,s=At(e.nullBitmap),a=Ht(n.ArrayType,e.data),{["length"]:o=a.length,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,a,s])}visitFixedSizeList(e){const{["type"]:n,["offset"]:r=0,["child"]:s=new js().visit({type:n.valueType})}=e,a=At(e.nullBitmap),{["length"]:o=s.length/Sn(n),["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Tt(n,r,o,u,[void 0,void 0,a],[s])}visitMap(e){const{["type"]:n,["offset"]:r=0,["child"]:s=new js().visit({type:n.childType})}=e,a=At(e.nullBitmap),o=Ns(e.valueOffsets),{["length"]:u=o.length-1,["nullCount"]:l=e.nullBitmap?-1:0}=e;return new Tt(n,r,u,l,[o,void 0,a],[s])}}const $A=new js;function ee(t){return $A.visit(t)}class Cd{constructor(e=0,n){this.numChunks=e,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function xy(t){return t.reduce((e,n)=>e+n.nullCount,0)}function Sy(t){return t.reduce((e,n,r)=>(e[r+1]=e[r]+n.length,e),new Uint32Array(t.length+1))}function Iy(t,e,n,r){const s=[];for(let a=-1,o=t.length;++a<o;){const u=t[a],l=e[a],{length:c}=u;if(l>=r)break;if(n>=l+c)continue;if(l>=n&&l+c<=r){s.push(u);continue}const h=Math.max(0,n-l),f=Math.min(r-l,c);s.push(u.slice(h,f-h))}return s.length===0&&s.push(t[0].slice(0,0)),s}function mh(t,e,n,r){let s=0,a=0,o=e.length-1;do{if(s>=o-1)return n<e[o]?r(t,s,n-e[s]):null;a=s+Math.trunc((o-s)*.5),n<e[a]?o=a:s=a}while(s<o)}function yh(t,e){return t.getValid(e)}function Pr(t){function e(n,r,s){return t(n[r],s)}return function(n){const r=this.data;return mh(r,this._offsets,n,e)}}function Ty(t){let e;function n(r,s,a){return t(r[s],a,e)}return function(r,s){const a=this.data;e=s;const o=mh(a,this._offsets,r,n);return e=void 0,o}}function Ay(t){let e;function n(r,s,a){let o=a,u=0,l=0;for(let c=s-1,h=r.length;++c<h;){const f=r[c];if(~(u=t(f,e,o)))return l+u;o=0,l+=f.length}return-1}return function(r,s){e=r;const a=this.data,o=typeof s!="number"?n(a,0,0):mh(a,this._offsets,s,n);return e=void 0,o}}class q extends rt{}function jA(t,e){return e===null&&t.length>0?0:-1}function zA(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let r=0;for(const s of new ph(n,t.offset+(e||0),t.length,n,by)){if(!s)return r;++r}return-1}function tt(t,e,n){if(e===void 0)return-1;if(e===null)switch(t.typeId){case w.Union:break;case w.Dictionary:break;default:return zA(t,n)}const r=Ce.getVisitFn(t),s=fs(e);for(let a=(n||0)-1,o=t.length;++a<o;)if(s(r(t,a)))return a;return-1}function Cy(t,e,n){const r=Ce.getVisitFn(t),s=fs(e);for(let a=(n||0)-1,o=t.length;++a<o;)if(s(r(t,a)))return a;return-1}q.prototype.visitNull=jA;q.prototype.visitBool=tt;q.prototype.visitInt=tt;q.prototype.visitInt8=tt;q.prototype.visitInt16=tt;q.prototype.visitInt32=tt;q.prototype.visitInt64=tt;q.prototype.visitUint8=tt;q.prototype.visitUint16=tt;q.prototype.visitUint32=tt;q.prototype.visitUint64=tt;q.prototype.visitFloat=tt;q.prototype.visitFloat16=tt;q.prototype.visitFloat32=tt;q.prototype.visitFloat64=tt;q.prototype.visitUtf8=tt;q.prototype.visitBinary=tt;q.prototype.visitFixedSizeBinary=tt;q.prototype.visitDate=tt;q.prototype.visitDateDay=tt;q.prototype.visitDateMillisecond=tt;q.prototype.visitTimestamp=tt;q.prototype.visitTimestampSecond=tt;q.prototype.visitTimestampMillisecond=tt;q.prototype.visitTimestampMicrosecond=tt;q.prototype.visitTimestampNanosecond=tt;q.prototype.visitTime=tt;q.prototype.visitTimeSecond=tt;q.prototype.visitTimeMillisecond=tt;q.prototype.visitTimeMicrosecond=tt;q.prototype.visitTimeNanosecond=tt;q.prototype.visitDecimal=tt;q.prototype.visitList=tt;q.prototype.visitStruct=tt;q.prototype.visitUnion=tt;q.prototype.visitDenseUnion=Cy;q.prototype.visitSparseUnion=Cy;q.prototype.visitDictionary=tt;q.prototype.visitInterval=tt;q.prototype.visitIntervalDayTime=tt;q.prototype.visitIntervalYearMonth=tt;q.prototype.visitDuration=tt;q.prototype.visitDurationSecond=tt;q.prototype.visitDurationMillisecond=tt;q.prototype.visitDurationMicrosecond=tt;q.prototype.visitDurationNanosecond=tt;q.prototype.visitFixedSizeList=tt;q.prototype.visitMap=tt;const Fo=new q;class W extends rt{}function K(t){const{type:e}=t;if(t.nullCount===0&&t.stride===1&&(e.typeId===w.Timestamp||e instanceof he&&e.bitWidth!==64||e instanceof ai&&e.bitWidth!==64||e instanceof Ei&&e.precision!==Xt.HALF))return new Cd(t.data.length,r=>{const s=t.data[r];return s.values.subarray(0,s.length)[Symbol.iterator]()});let n=0;return new Cd(t.data.length,r=>{const a=t.data[r].length,o=t.slice(n,n+a);return n+=a,new qA(o)})}class qA{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}W.prototype.visitNull=K;W.prototype.visitBool=K;W.prototype.visitInt=K;W.prototype.visitInt8=K;W.prototype.visitInt16=K;W.prototype.visitInt32=K;W.prototype.visitInt64=K;W.prototype.visitUint8=K;W.prototype.visitUint16=K;W.prototype.visitUint32=K;W.prototype.visitUint64=K;W.prototype.visitFloat=K;W.prototype.visitFloat16=K;W.prototype.visitFloat32=K;W.prototype.visitFloat64=K;W.prototype.visitUtf8=K;W.prototype.visitBinary=K;W.prototype.visitFixedSizeBinary=K;W.prototype.visitDate=K;W.prototype.visitDateDay=K;W.prototype.visitDateMillisecond=K;W.prototype.visitTimestamp=K;W.prototype.visitTimestampSecond=K;W.prototype.visitTimestampMillisecond=K;W.prototype.visitTimestampMicrosecond=K;W.prototype.visitTimestampNanosecond=K;W.prototype.visitTime=K;W.prototype.visitTimeSecond=K;W.prototype.visitTimeMillisecond=K;W.prototype.visitTimeMicrosecond=K;W.prototype.visitTimeNanosecond=K;W.prototype.visitDecimal=K;W.prototype.visitList=K;W.prototype.visitStruct=K;W.prototype.visitUnion=K;W.prototype.visitDenseUnion=K;W.prototype.visitSparseUnion=K;W.prototype.visitDictionary=K;W.prototype.visitInterval=K;W.prototype.visitIntervalDayTime=K;W.prototype.visitIntervalYearMonth=K;W.prototype.visitDuration=K;W.prototype.visitDurationSecond=K;W.prototype.visitDurationMillisecond=K;W.prototype.visitDurationMicrosecond=K;W.prototype.visitDurationNanosecond=K;W.prototype.visitFixedSizeList=K;W.prototype.visitMap=K;const gh=new W,WA=(t,e)=>t+e;class zi extends rt{visitNull(e,n){return 0}visitInt(e,n){return e.type.bitWidth/8}visitFloat(e,n){return e.type.ArrayType.BYTES_PER_ELEMENT}visitBool(e,n){return 1/8}visitDecimal(e,n){return e.type.bitWidth/8}visitDate(e,n){return(e.type.unit+1)*4}visitTime(e,n){return e.type.bitWidth/8}visitTimestamp(e,n){return e.type.unit===j.SECOND?4:8}visitInterval(e,n){return(e.type.unit+1)*4}visitDuration(e,n){return 8}visitStruct(e,n){return e.children.reduce((r,s)=>r+Vn.visit(s,n),0)}visitFixedSizeBinary(e,n){return e.type.byteWidth}visitMap(e,n){return 8+e.children.reduce((r,s)=>r+Vn.visit(s,n),0)}visitDictionary(e,n){var r;return e.type.indices.bitWidth/8+(((r=e.dictionary)===null||r===void 0?void 0:r.getByteLength(e.values[n]))||0)}}const HA=({valueOffsets:t},e)=>8+(t[e+1]-t[e]),YA=({valueOffsets:t},e)=>8+(t[e+1]-t[e]),GA=({valueOffsets:t,stride:e,children:n},r)=>{const s=n[0],{[r*e]:a}=t,{[r*e+1]:o}=t,u=Vn.getVisitFn(s.type),l=s.slice(a,o-a);let c=8;for(let h=-1,f=o-a;++h<f;)c+=u(l,h);return c},KA=({stride:t,children:e},n)=>{const r=e[0],s=r.slice(n*t,t),a=Vn.getVisitFn(r.type);let o=0;for(let u=-1,l=s.length;++u<l;)o+=a(s,u);return o},QA=(t,e)=>t.type.mode===Ae.Dense?ky(t,e):My(t,e),ky=({type:t,children:e,typeIds:n,valueOffsets:r},s)=>{const a=t.typeIdToChildIndex[n[s]];return 8+Vn.visit(e[a],r[s])},My=({children:t},e)=>4+Vn.visitMany(t,t.map(()=>e)).reduce(WA,0);zi.prototype.visitUtf8=HA;zi.prototype.visitBinary=YA;zi.prototype.visitList=GA;zi.prototype.visitFixedSizeList=KA;zi.prototype.visitUnion=QA;zi.prototype.visitDenseUnion=ky;zi.prototype.visitSparseUnion=My;const Vn=new zi;var Ny;const Ey={},Oy={};class wt{constructor(e){var n,r,s;const a=e[0]instanceof wt?e.flatMap(u=>u.data):e;if(a.length===0||a.some(u=>!(u instanceof Tt)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(n=a[0])===null||n===void 0?void 0:n.type;switch(a.length){case 0:this._offsets=[0];break;case 1:{const{get:u,set:l,indexOf:c,byteLength:h}=Ey[o.typeId],f=a[0];this.isValid=d=>yh(f,d),this.get=d=>u(f,d),this.set=(d,m)=>l(f,d,m),this.indexOf=d=>c(f,d),this.getByteLength=d=>h(f,d),this._offsets=[0,f.length];break}default:Object.setPrototypeOf(this,Oy[o.typeId]),this._offsets=Sy(a);break}this.data=a,this.type=o,this.stride=Sn(o),this.numChildren=(s=(r=o.children)===null||r===void 0?void 0:r.length)!==null&&s!==void 0?s:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((e,n)=>e+n.byteLength,0)}get nullCount(){return xy(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${w[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}set(e,n){}indexOf(e,n){return-1}includes(e,n){return this.indexOf(e,n)>-1}getByteLength(e){return 0}[Symbol.iterator](){return gh.visit(this)}concat(...e){return new wt(this.data.concat(e.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(e,n){return new wt(_y(this,e,n,({data:r,_offsets:s},a,o)=>Iy(r,s,a,o)))}toJSON(){return[...this]}toArray(){const{type:e,data:n,length:r,stride:s,ArrayType:a}=this;switch(e.typeId){case w.Int:case w.Float:case w.Decimal:case w.Time:case w.Timestamp:switch(n.length){case 0:return new a;case 1:return n[0].values.subarray(0,r*s);default:return n.reduce((o,{values:u,length:l})=>(o.array.set(u.subarray(0,l*s),o.offset),o.offset+=l*s,o),{array:new a(r*s),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(r=>r.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new wt(this.data.map(({children:n})=>n[e])):null}get isMemoized(){return et.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(et.isDictionary(this.type)){const e=new Bo(this.data[0].dictionary),n=this.data.map(r=>{const s=r.clone();return s.dictionary=e,s});return new wt(n)}return new Bo(this)}unmemoize(){if(et.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),n=this.data.map(r=>{const s=r.clone();return s.dictionary=e,s});return new wt(n)}return this}}Ny=Symbol.toStringTag;wt[Ny]=(t=>{t.type=et.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(w).map(n=>w[n]).filter(n=>typeof n=="number"&&n!==w.NONE);for(const n of e){const r=Ce.getVisitFnByTypeId(n),s=Ke.getVisitFnByTypeId(n),a=Fo.getVisitFnByTypeId(n),o=Vn.getVisitFnByTypeId(n);Ey[n]={get:r,set:s,indexOf:a,byteLength:o},Oy[n]=Object.create(t,{isValid:{value:Pr(yh)},get:{value:Pr(Ce.getVisitFnByTypeId(n))},set:{value:Ty(Ke.getVisitFnByTypeId(n))},indexOf:{value:Ay(Fo.getVisitFnByTypeId(n))},getByteLength:{value:Pr(Vn.getVisitFnByTypeId(n))}})}return"Vector"})(wt.prototype);class Bo extends wt{constructor(e){super(e.data);const n=this.get,r=this.set,s=this.slice,a=new Array(this.length);Object.defineProperty(this,"get",{value(o){const u=a[o];if(u!==void 0)return u;const l=n.call(this,o);return a[o]=l,l}}),Object.defineProperty(this,"set",{value(o,u){r.call(this,o,u),a[o]=u}}),Object.defineProperty(this,"slice",{value:(o,u)=>new Bo(s.call(this,o,u))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new wt(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function JA(t){if(!t||t.length<=0)return function(s){return!0};let e="";const n=t.filter(r=>r===r);return n.length>0&&(e=`
    switch (x) {${n.map(r=>`
        case ${XA(r)}:`).join("")}
            return false;
    }`),t.length!==n.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}function XA(t){return typeof t!="bigint"?lr(t):`${lr(t)}n`}const il=(t,e)=>(Math.ceil(t)*e+63&-64||64)/e,ZA=(t,e=0)=>t.length>=e?t.subarray(0,e):ko(new t.constructor(e),t,0);class yu{constructor(e,n=1){this.buffer=e,this.stride=n,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e.constructor,this._resize(this.length=Math.ceil(e.length/n))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,n){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;const n=this.stride,r=this.length*n,s=this.buffer.length;r>=s&&this._resize(s===0?il(r*1,this.BYTES_PER_ELEMENT):il(r*2,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=il(e*this.stride,this.BYTES_PER_ELEMENT);const n=ZA(this.buffer,e);return this.clear(),n}clear(){return this.length=0,this._resize(0),this}_resize(e){return this.buffer=ko(new this.ArrayType(e),this.buffer)}}yu.prototype.offset=0;class ba extends yu{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,n){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=n,this}}class Dy extends ba{constructor(e=new Uint8Array(0)){super(e,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,n){const{buffer:r}=this.reserve(e-this.length+1),s=e>>3,a=e%8,o=r[s]>>a&1;return n?o===0&&(r[s]|=1<<a,++this.numValid):o===1&&(r[s]&=~(1<<a),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class Fy extends ba{constructor(e=new Int32Array(1)){super(e,1)}append(e){return this.set(this.length-1,e)}set(e,n){const r=this.length-1,s=this.reserve(e-r+1).buffer;return r<e++&&s.fill(s[r],r,e),s[e]=s[e-1]+n,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,0),super.flush(e+1)}}let Me=class{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}constructor({type:e,nullValues:n}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=n,this.stride=Sn(e),this._nulls=new Dy,n&&n.length>0&&(this._isValid=JA(n))}toVector(){return new wt([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;const{_offsets:n,_values:r,_nulls:s,_typeIds:a,children:o}=this;return n&&(e+=n.byteLength),r&&(e+=r.byteLength),s&&(e+=s.byteLength),a&&(e+=a.byteLength),o.reduce((u,l)=>u+l.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((n,r)=>n+r.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,n){return this.setValid(e,this.isValid(n))&&this.setValue(e,n),this}setValue(e,n){this._setValue(this,e,n)}setValid(e,n){return this.length=this._nulls.set(e,+n).length,n}addChild(e,n=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e,n,r,s;const{type:a,length:o,nullCount:u,_typeIds:l,_offsets:c,_values:h,_nulls:f}=this;(n=l==null?void 0:l.flush(o))?s=c==null?void 0:c.flush(o):(s=c==null?void 0:c.flush(o))?e=h==null?void 0:h.flush(c.last()):e=h==null?void 0:h.flush(o),u>0&&(r=f==null?void 0:f.flush(o));const d=this.children.map(m=>m.flush());return this.clear(),ee({type:a,length:o,nullCount:u,children:d,child:d[0],data:e,typeIds:n,nullBitmap:r,valueOffsets:s})}finish(){this.finished=!0;for(const e of this.children)e.finish();return this}clear(){var e,n,r,s;this.length=0,(e=this._nulls)===null||e===void 0||e.clear(),(n=this._values)===null||n===void 0||n.clear(),(r=this._offsets)===null||r===void 0||r.clear(),(s=this._typeIds)===null||s===void 0||s.clear();for(const a of this.children)a.clear();return this}};Me.prototype.length=1;Me.prototype.stride=1;Me.prototype.children=null;Me.prototype.finished=!1;Me.prototype.nullValues=null;Me.prototype._isValid=()=>!0;class hi extends Me{constructor(e){super(e),this._values=new ba(new this.ArrayType(0),this.stride)}setValue(e,n){const r=this._values;return r.reserve(e-r.length+1),super.setValue(e,n)}}class gu extends Me{constructor(e){super(e),this._pendingLength=0,this._offsets=new Fy}setValue(e,n){const r=this._pending||(this._pending=new Map),s=r.get(e);s&&(this._pendingLength-=s.length),this._pendingLength+=n instanceof pu?n[an].length:n.length,r.set(e,n)}setValid(e,n){return super.setValid(e,n)?!0:((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const e=this._pending,n=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,n),this}}class Ll{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,n,r,s){return e.prep(8,24),e.writeInt64(BigInt(s??0)),e.pad(4),e.writeInt32(r),e.writeInt64(BigInt(n??0)),e.offset()}}const rl=2,In=4,Qn=4,kt=4,xi=new Int32Array(2),kd=new Float32Array(xi.buffer),Md=new Float64Array(xi.buffer),$a=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Pl;(function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"})(Pl||(Pl={}));let Ro=class By{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(e){return new By(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return xi[0]=this.readInt32(e),kd[0]}readFloat64(e){return xi[$a?0:1]=this.readInt32(e),xi[$a?1:0]=this.readInt32(e+4),Md[0]}writeInt8(e,n){this.bytes_[e]=n}writeUint8(e,n){this.bytes_[e]=n}writeInt16(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8}writeUint16(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8}writeInt32(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8,this.bytes_[e+2]=n>>16,this.bytes_[e+3]=n>>24}writeUint32(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8,this.bytes_[e+2]=n>>16,this.bytes_[e+3]=n>>24}writeInt64(e,n){this.writeInt32(e,Number(BigInt.asIntN(32,n))),this.writeInt32(e+4,Number(BigInt.asIntN(32,n>>BigInt(32))))}writeUint64(e,n){this.writeUint32(e,Number(BigInt.asUintN(32,n))),this.writeUint32(e+4,Number(BigInt.asUintN(32,n>>BigInt(32))))}writeFloat32(e,n){kd[0]=n,this.writeInt32(e,xi[0])}writeFloat64(e,n){Md[0]=n,this.writeInt32(e,xi[$a?0:1]),this.writeInt32(e+4,xi[$a?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+In+Qn)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let n=0;n<Qn;n++)e+=String.fromCharCode(this.readInt8(this.position_+In+n));return e}__offset(e,n){const r=e-this.readInt32(e);return n<this.readInt16(r)?this.readInt16(r+n):0}__union(e,n){return e.bb_pos=n+this.readInt32(n),e.bb=this,e}__string(e,n){e+=this.readInt32(e);const r=this.readInt32(e);e+=In;const s=this.bytes_.subarray(e,e+r);return n===Pl.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(e,n){return typeof e=="string"?this.__string(n):this.__union(e,n)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+In}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=Qn)throw new Error("FlatBuffers: file identifier must be length "+Qn);for(let n=0;n<Qn;n++)if(e.charCodeAt(n)!=this.readInt8(this.position()+In+n))return!1;return!0}createScalarList(e,n){const r=[];for(let s=0;s<n;++s){const a=e(s);a!==null&&r.push(a)}return r}createObjList(e,n){const r=[];for(let s=0;s<n;++s){const a=e(s);a!==null&&r.push(a.unpack())}return r}},Ry=class Ly{constructor(e){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let n;e?n=e:n=1024,this.bb=Ro.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,n){e>this.minalign&&(this.minalign=e);const r=~(this.bb.capacity()-this.space+n)+1&e-1;for(;this.space<r+e+n;){const s=this.bb.capacity();this.bb=Ly.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(r)}pad(e){for(let n=0;n<e;n++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,n,r){(this.force_defaults||n!=r)&&(this.addInt8(n),this.slot(e))}addFieldInt16(e,n,r){(this.force_defaults||n!=r)&&(this.addInt16(n),this.slot(e))}addFieldInt32(e,n,r){(this.force_defaults||n!=r)&&(this.addInt32(n),this.slot(e))}addFieldInt64(e,n,r){(this.force_defaults||n!==r)&&(this.addInt64(n),this.slot(e))}addFieldFloat32(e,n,r){(this.force_defaults||n!=r)&&(this.addFloat32(n),this.slot(e))}addFieldFloat64(e,n,r){(this.force_defaults||n!=r)&&(this.addFloat64(n),this.slot(e))}addFieldOffset(e,n,r){(this.force_defaults||n!=r)&&(this.addOffset(n),this.slot(e))}addFieldStruct(e,n,r){n!=r&&(this.nested(n),this.slot(e))}nested(e){if(e!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){this.vtable!==null&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const n=e.capacity();if(n&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const r=n<<1,s=Ro.allocate(r);return s.setPosition(r-n),s.bytes().set(e.bytes(),r-n),s}addOffset(e){this.prep(In,0),this.writeInt32(this.offset()-e+In)}startObject(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(let n=0;n<e;n++)this.vtable[n]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let n=this.vtable_in_use-1;for(;n>=0&&this.vtable[n]==0;n--);const r=n+1;for(;n>=0;n--)this.addInt16(this.vtable[n]!=0?e-this.vtable[n]:0);const s=2;this.addInt16(e-this.object_start);const a=(r+s)*rl;this.addInt16(a);let o=0;const u=this.space;t:for(n=0;n<this.vtables.length;n++){const l=this.bb.capacity()-this.vtables[n];if(a==this.bb.readInt16(l)){for(let c=rl;c<a;c+=rl)if(this.bb.readInt16(u+c)!=this.bb.readInt16(l+c))continue t;o=this.vtables[n];break}}return o?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,o-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,n,r){const s=r?kt:0;if(n){const a=n;if(this.prep(this.minalign,In+Qn+s),a.length!=Qn)throw new TypeError("FlatBuffers: file identifier must be length "+Qn);for(let o=Qn-1;o>=0;o--)this.writeInt8(a.charCodeAt(o))}this.prep(this.minalign,In+s),this.addOffset(e),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,n){this.finish(e,n,!0)}requiredField(e,n){const r=this.bb.capacity()-e,s=r-this.bb.readInt32(r);if(!(n<this.bb.readInt16(s)&&this.bb.readInt16(s+n)!=0))throw new TypeError("FlatBuffers: field "+n+" must be set")}startVector(e,n,r){this.notNested(),this.vector_num_elems=n,this.prep(In,e*n),this.prep(r,e*n)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const n=this.createString(e);return this.string_maps.set(e,n),n}createString(e){if(e==null)return 0;let n;e instanceof Uint8Array?n=e:n=this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,n.length,1),this.bb.setPosition(this.space-=n.length);for(let r=0,s=this.space,a=this.bb.bytes();r<n.length;r++)a[s++]=n[r];return this.endVector()}createObjectOffset(e){return e===null?0:typeof e=="string"?this.createString(e):e.pack(this)}createObjectOffsetList(e){const n=[];for(let r=0;r<e.length;++r){const s=e[r];if(s!==null)n.push(this.createObjectOffset(s));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return n}createStructOffsetList(e,n){return n(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}};class jt{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsKeyValue(e,n){return(n||new jt).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,n){return e.setPosition(e.position()+kt),(n||new jt).__init(e.readInt32(e.position())+e.position(),e)}key(e){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,e):null}value(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,n){e.addFieldOffset(0,n,0)}static addValue(e,n){e.addFieldOffset(1,n,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,n,r){return jt.startKeyValue(e),jt.addKey(e,n),jt.addValue(e,r),jt.endKeyValue(e)}}var es;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(es||(es={}));var ns;(function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"})(ns||(ns={}));var Lo;(function(t){t[t.DenseArray=0]="DenseArray"})(Lo||(Lo={}));class Ee{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsInt(e,n){return(n||new Ee).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,n){return e.setPosition(e.position()+kt),(n||new Ee).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startInt(e){e.startObject(2)}static addBitWidth(e,n){e.addFieldInt32(0,n,0)}static addIsSigned(e,n){e.addFieldInt8(1,+n,0)}static endInt(e){return e.endObject()}static createInt(e,n,r){return Ee.startInt(e),Ee.addBitWidth(e,n),Ee.addIsSigned(e,r),Ee.endInt(e)}}class Jn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDictionaryEncoding(e,n){return(n||new Jn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,n){return e.setPosition(e.position()+kt),(n||new Jn).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}indexType(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Ee).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):Lo.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addIndexType(e,n){e.addFieldOffset(1,n,0)}static addIsOrdered(e,n){e.addFieldInt8(2,+n,0)}static addDictionaryKind(e,n){e.addFieldInt16(3,n,Lo.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}class Xi{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBinary(e,n){return(n||new Xi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,n){return e.setPosition(e.position()+kt),(n||new Xi).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return Xi.startBinary(e),Xi.endBinary(e)}}class Zi{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBool(e,n){return(n||new Zi).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,n){return e.setPosition(e.position()+kt),(n||new Zi).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return Zi.startBool(e),Zi.endBool(e)}}var Po;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Po||(Po={}));let Xa=class wr{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDate(e,n){return(n||new wr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,n){return e.setPosition(e.position()+kt),(n||new wr).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Po.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,Po.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,n){return wr.startDate(e),wr.addUnit(e,n),wr.endDate(e)}};class be{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDecimal(e,n){return(n||new be).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,n){return e.setPosition(e.position()+kt),(n||new be).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,n){e.addFieldInt32(0,n,0)}static addScale(e,n){e.addFieldInt32(1,n,0)}static addBitWidth(e,n){e.addFieldInt32(2,n,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,n,r,s){return be.startDecimal(e),be.addPrecision(e,n),be.addScale(e,r),be.addBitWidth(e,s),be.endDecimal(e)}}var Di;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(Di||(Di={}));class Tn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDuration(e,n){return(n||new Tn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDuration(e,n){return e.setPosition(e.position()+kt),(n||new Tn).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Di.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,Di.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(e,n){return Tn.startDuration(e),Tn.addUnit(e,n),Tn.endDuration(e)}}class An{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFixedSizeBinary(e,n){return(n||new An).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,n){return e.setPosition(e.position()+kt),(n||new An).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,n){e.addFieldInt32(0,n,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,n){return An.startFixedSizeBinary(e),An.addByteWidth(e,n),An.endFixedSizeBinary(e)}}class Cn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFixedSizeList(e,n){return(n||new Cn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,n){return e.setPosition(e.position()+kt),(n||new Cn).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,n){e.addFieldInt32(0,n,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,n){return Cn.startFixedSizeList(e),Cn.addListSize(e,n),Cn.endFixedSizeList(e)}}var Vo;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(Vo||(Vo={}));class kn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFloatingPoint(e,n){return(n||new kn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,n){return e.setPosition(e.position()+kt),(n||new kn).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Vo.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,n){e.addFieldInt16(0,n,Vo.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,n){return kn.startFloatingPoint(e),kn.addPrecision(e,n),kn.endFloatingPoint(e)}}var Uo;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Uo||(Uo={}));class Mn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsInterval(e,n){return(n||new Mn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,n){return e.setPosition(e.position()+kt),(n||new Mn).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Uo.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,Uo.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,n){return Mn.startInterval(e),Mn.addUnit(e,n),Mn.endInterval(e)}}class tr{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsList(e,n){return(n||new tr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,n){return e.setPosition(e.position()+kt),(n||new tr).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return tr.startList(e),tr.endList(e)}}let Za=class xr{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsMap(e,n){return(n||new xr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,n){return e.setPosition(e.position()+kt),(n||new xr).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startMap(e){e.startObject(1)}static addKeysSorted(e,n){e.addFieldInt8(0,+n,0)}static endMap(e){return e.endObject()}static createMap(e,n){return xr.startMap(e),xr.addKeysSorted(e,n),xr.endMap(e)}};class er{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsNull(e,n){return(n||new er).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,n){return e.setPosition(e.position()+kt),(n||new er).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return er.startNull(e),er.endNull(e)}}class nr{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsStruct_(e,n){return(n||new nr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,n){return e.setPosition(e.position()+kt),(n||new nr).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return nr.startStruct_(e),nr.endStruct_(e)}}class ze{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsTime(e,n){return(n||new ze).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,n){return e.setPosition(e.position()+kt),(n||new ze).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Di.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,n){e.addFieldInt16(0,n,Di.MILLISECOND)}static addBitWidth(e,n){e.addFieldInt32(1,n,32)}static endTime(e){return e.endObject()}static createTime(e,n,r){return ze.startTime(e),ze.addUnit(e,n),ze.addBitWidth(e,r),ze.endTime(e)}}class qe{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsTimestamp(e,n){return(n||new qe).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,n){return e.setPosition(e.position()+kt),(n||new qe).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Di.SECOND}timezone(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,n){e.addFieldInt16(0,n,Di.SECOND)}static addTimezone(e,n){e.addFieldOffset(1,n,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,n,r){return qe.startTimestamp(e),qe.addUnit(e,n),qe.addTimezone(e,r),qe.endTimestamp(e)}}var $o;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})($o||($o={}));class we{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsUnion(e,n){return(n||new we).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,n){return e.setPosition(e.position()+kt),(n||new we).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):$o.Sparse}typeIds(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt32(this.bb.__vector(this.bb_pos+n)+e*4):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,n){e.addFieldInt16(0,n,$o.Sparse)}static addTypeIds(e,n){e.addFieldOffset(1,n,0)}static createTypeIdsVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addInt32(n[r]);return e.endVector()}static startTypeIdsVector(e,n){e.startVector(4,n,4)}static endUnion(e){return e.endObject()}static createUnion(e,n,r){return we.startUnion(e),we.addMode(e,n),we.addTypeIds(e,r),we.endUnion(e)}}class ir{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsUtf8(e,n){return(n||new ir).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,n){return e.setPosition(e.position()+kt),(n||new ir).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return ir.startUtf8(e),ir.endUtf8(e)}}var Ft;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList",t[t.RunEndEncoded=22]="RunEndEncoded"})(Ft||(Ft={}));let $e=class to{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsField(e,n){return(n||new to).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,n){return e.setPosition(e.position()+kt),(n||new to).__init(e.readInt32(e.position())+e.position(),e)}name(e){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Ft.NONE}type(e){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__union(e,this.bb_pos+n):null}dictionary(e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new Jn).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}children(e,n){const r=this.bb.__offset(this.bb_pos,14);return r?(n||new to).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const r=this.bb.__offset(this.bb_pos,16);return r?(n||new jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,n){e.addFieldOffset(0,n,0)}static addNullable(e,n){e.addFieldInt8(1,+n,0)}static addTypeType(e,n){e.addFieldInt8(2,n,Ft.NONE)}static addType(e,n){e.addFieldOffset(3,n,0)}static addDictionary(e,n){e.addFieldOffset(4,n,0)}static addChildren(e,n){e.addFieldOffset(5,n,0)}static createChildrenVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startChildrenVector(e,n){e.startVector(4,n,4)}static addCustomMetadata(e,n){e.addFieldOffset(6,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endField(e){return e.endObject()}},bn=class Wn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsSchema(e,n){return(n||new Wn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,n){return e.setPosition(e.position()+kt),(n||new Wn).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):ns.Little}fields(e,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new $e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt64(this.bb.__vector(this.bb_pos+n)+e*8):BigInt(0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,n){e.addFieldInt16(0,n,ns.Little)}static addFields(e,n){e.addFieldOffset(1,n,0)}static createFieldsVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startFieldsVector(e,n){e.startVector(4,n,4)}static addCustomMetadata(e,n){e.addFieldOffset(2,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static addFeatures(e,n){e.addFieldOffset(3,n,0)}static createFeaturesVector(e,n){e.startVector(8,n.length,8);for(let r=n.length-1;r>=0;r--)e.addInt64(n[r]);return e.endVector()}static startFeaturesVector(e,n){e.startVector(8,n,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,n){e.finish(n)}static finishSizePrefixedSchemaBuffer(e,n){e.finish(n,void 0,!0)}static createSchema(e,n,r,s,a){return Wn.startSchema(e),Wn.addEndianness(e,n),Wn.addFields(e,r),Wn.addCustomMetadata(e,s),Wn.addFeatures(e,a),Wn.endSchema(e)}};class Ne{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFooter(e,n){return(n||new Ne).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,n){return e.setPosition(e.position()+kt),(n||new Ne).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):es.V1}schema(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new bn).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}dictionaries(e,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new Ll).__init(this.bb.__vector(this.bb_pos+r)+e*24,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,n){const r=this.bb.__offset(this.bb_pos,10);return r?(n||new Ll).__init(this.bb.__vector(this.bb_pos+r)+e*24,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,n){e.addFieldInt16(0,n,es.V1)}static addSchema(e,n){e.addFieldOffset(1,n,0)}static addDictionaries(e,n){e.addFieldOffset(2,n,0)}static startDictionariesVector(e,n){e.startVector(24,n,8)}static addRecordBatches(e,n){e.addFieldOffset(3,n,0)}static startRecordBatchesVector(e,n){e.startVector(24,n,8)}static addCustomMetadata(e,n){e.addFieldOffset(4,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,n){e.finish(n)}static finishSizePrefixedFooterBuffer(e,n){e.finish(n,void 0,!0)}}class It{constructor(e=[],n,r,s=le.V5){this.fields=e||[],this.metadata=n||new Map,r||(r=Vl(e)),this.dictionaries=r,this.metadataVersion=s}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return`Schema<{ ${this.fields.map((e,n)=>`${n}: ${e}`).join(", ")} }>`}select(e){const n=new Set(e),r=this.fields.filter(s=>n.has(s.name));return new It(r,this.metadata)}selectAt(e){const n=e.map(r=>this.fields[r]).filter(Boolean);return new It(n,this.metadata)}assign(...e){const n=e[0]instanceof It?e[0]:Array.isArray(e[0])?new It(e[0]):new It(e),r=[...this.fields],s=ja(ja(new Map,this.metadata),n.metadata),a=n.fields.filter(u=>{const l=r.findIndex(c=>c.name===u.name);return~l?(r[l]=u.clone({metadata:ja(ja(new Map,r[l].metadata),u.metadata)}))&&!1:!0}),o=Vl(a,new Map);return new It([...r,...a],s,new Map([...this.dictionaries,...o]))}}It.prototype.fields=null;It.prototype.metadata=null;It.prototype.dictionaries=null;class St{static new(...e){let[n,r,s,a]=e;return e[0]&&typeof e[0]=="object"&&({name:n}=e[0],r===void 0&&(r=e[0].type),s===void 0&&(s=e[0].nullable),a===void 0&&(a=e[0].metadata)),new St(`${n}`,r,s,a)}constructor(e,n,r=!1,s){this.name=e,this.type=n,this.nullable=r,this.metadata=s||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...e){let[n,r,s,a]=e;return!e[0]||typeof e[0]!="object"?[n=this.name,r=this.type,s=this.nullable,a=this.metadata]=e:{name:n=this.name,type:r=this.type,nullable:s=this.nullable,metadata:a=this.metadata}=e[0],St.new(n,r,s,a)}}St.prototype.type=null;St.prototype.name=null;St.prototype.nullable=null;St.prototype.metadata=null;function ja(t,e){return new Map([...t||new Map,...e||new Map])}function Vl(t,e=new Map){for(let n=-1,r=t.length;++n<r;){const a=t[n].type;if(et.isDictionary(a)){if(!e.has(a.id))e.set(a.id,a.dictionary);else if(e.get(a.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&Vl(a.children,e)}return e}var t3=Ry,e3=Ro;class Ul{static decode(e){e=new e3(At(e));const n=Ne.getRootAsFooter(e),r=It.decode(n.schema(),new Map,n.version());return new n3(r,n)}static encode(e){const n=new t3,r=It.encode(n,e.schema);Ne.startRecordBatchesVector(n,e.numRecordBatches);for(const o of[...e.recordBatches()].slice().reverse())Fi.encode(n,o);const s=n.endVector();Ne.startDictionariesVector(n,e.numDictionaries);for(const o of[...e.dictionaryBatches()].slice().reverse())Fi.encode(n,o);const a=n.endVector();return Ne.startFooter(n),Ne.addSchema(n,r),Ne.addVersion(n,le.V5),Ne.addRecordBatches(n,s),Ne.addDictionaries(n,a),Ne.finishFooterBuffer(n,Ne.endFooter(n)),n.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(e,n=le.V5,r,s){this.schema=e,this.version=n,r&&(this._recordBatches=r),s&&(this._dictionaryBatches=s)}*recordBatches(){for(let e,n=-1,r=this.numRecordBatches;++n<r;)(e=this.getRecordBatch(n))&&(yield e)}*dictionaryBatches(){for(let e,n=-1,r=this.numDictionaries;++n<r;)(e=this.getDictionaryBatch(n))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class n3 extends Ul{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(e,n){super(e,n.version()),this._footer=n}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const n=this._footer.recordBatches(e);if(n)return Fi.decode(n)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const n=this._footer.dictionaries(e);if(n)return Fi.decode(n)}return null}}class Fi{static decode(e){return new Fi(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,n){const{metaDataLength:r}=n,s=BigInt(n.offset),a=BigInt(n.bodyLength);return Ll.createBlock(e,s,r,a)}constructor(e,n,r){this.metaDataLength=e,this.offset=fn(r),this.bodyLength=fn(n)}}const za=Object.freeze({done:!0,value:void 0});class Py{tee(){return this._getDOMStream().tee()}pipe(e,n){return this._getNodeStream().pipe(e,n)}pipeTo(e,n){return this._getDOMStream().pipeTo(e,n)}pipeThrough(e,n){return this._getDOMStream().pipeThrough(e,n)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class i3 extends Py{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return Kn(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(za);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return xd.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return xd.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return Kn(this,void 0,void 0,function*(){return yield this.abort(e),za})}return(e){return Kn(this,void 0,void 0,function*(){return yield this.close(),za})}read(e){return Kn(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return Kn(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((n,r)=>{this.resolvers.push({resolve:n,reject:r})}):Promise.resolve(za)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class sl extends i3{write(e){if((e=At(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?Fl(this.toUint8Array(!0)):this.toUint8Array(!1).then(Fl)}toUint8Array(e=!1){return e?Rn(this._values)[0]:Kn(this,void 0,void 0,function*(){var n,r,s,a;const o=[];let u=0;try{for(var l=!0,c=$s(this),h;h=yield c.next(),n=h.done,!n;l=!0){a=h.value,l=!1;const f=a;o.push(f),u+=f.byteLength}}catch(f){r={error:f}}finally{try{!l&&!n&&(s=c.return)&&(yield s.call(c))}finally{if(r)throw r.error}}return Rn(o,u)[0]})}}class Vy extends gu{constructor(e){super(e),this._values=new yu(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,n){return super.setValue(e,At(n))}_flushPending(e,n){const r=this._offsets,s=this._values.reserve(n).buffer;let a=0;for(const[o,u]of e)if(u===void 0)r.set(o,0);else{const l=u.length;s.set(u,a),r.set(o,l),a+=l}}}class r3 extends Me{constructor(e){super(e),this._values=new Dy}setValue(e,n){this._values.set(e,+n)}}class vu extends hi{}vu.prototype._setValue=q0;class Uy extends vu{}Uy.prototype._setValue=Qc;class $y extends vu{}$y.prototype._setValue=Jc;class jy extends hi{}jy.prototype._setValue=Y0;class s3 extends Me{constructor({type:e,nullValues:n,dictionaryHashFunction:r}){super({type:new Oi(e.dictionary,e.indices,e.id,e.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=jo({type:this.type.indices,nullValues:n}),this.dictionary=jo({type:this.type.dictionary,nullValues:null}),typeof r=="function"&&(this.valueToKey=r)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,n){const r=this.indices;return n=r.setValid(e,n),this.length=r.length,n}setValue(e,n){const r=this._keysToIndices,s=this.valueToKey(n);let a=r[s];return a===void 0&&(r[s]=a=this._dictionaryOffset+this.dictionary.append(n).length-1),this.indices.setValue(e,a)}flush(){const e=this.type,n=this._dictionary,r=this.dictionary.toVector(),s=this.indices.flush().clone(e);return s.dictionary=n?n.concat(r):r,this.finished||(this._dictionaryOffset+=r.length),this._dictionary=s.dictionary,this.clear(),s}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}}class zy extends hi{}zy.prototype._setValue=z0;class a3 extends Me{setValue(e,n){const[r]=this.children,s=e*this.stride;for(let a=-1,o=n.length;++a<o;)r.set(s+a,n[a])}addChild(e,n="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const r=this.children.push(e);return this.type=new ts(this.type.listSize,new St(n,e.type,!0)),r}}class _u extends hi{setValue(e,n){this._values.set(e,n)}}class o3 extends _u{setValue(e,n){super.setValue(e,U0(n))}}class u3 extends _u{}class l3 extends _u{}class bu extends hi{}bu.prototype._setValue=Q0;class qy extends bu{}qy.prototype._setValue=ah;class Wy extends bu{}Wy.prototype._setValue=oh;class ds extends hi{}ds.prototype._setValue=J0;class Hy extends ds{}Hy.prototype._setValue=uh;class Yy extends ds{}Yy.prototype._setValue=lh;class Gy extends ds{}Gy.prototype._setValue=ch;class Ky extends ds{}Ky.prototype._setValue=hh;class fi extends hi{setValue(e,n){this._values.set(e,n)}}class c3 extends fi{}class h3 extends fi{}class f3 extends fi{}class d3 extends fi{}class p3 extends fi{}class m3 extends fi{}class y3 extends fi{}class g3 extends fi{}class v3 extends gu{constructor(e){super(e),this._offsets=new Fy}addChild(e,n="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new Zr(new St(n,e.type,!0)),this.numChildren-1}_flushPending(e){const n=this._offsets,[r]=this.children;for(const[s,a]of e)if(typeof a>"u")n.set(s,0);else{const o=a,u=o.length,l=n.set(s,u).buffer[s];for(let c=-1;++c<u;)r.set(l+c,o[c])}}}class _3 extends gu{set(e,n){return super.set(e,n)}setValue(e,n){const r=n instanceof Map?n:new Map(Object.entries(n)),s=this._pending||(this._pending=new Map),a=s.get(e);a&&(this._pendingLength-=a.size),this._pendingLength+=r.size,s.set(e,r)}addChild(e,n=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new aa(new St(n,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){const n=this._offsets,[r]=this.children;for(const[s,a]of e)if(a===void 0)n.set(s,0);else{let{[s]:o,[s+1]:u}=n.set(s,a.size).buffer;for(const l of a.entries())if(r.set(o,l),++o>=u)break}}}class b3 extends Me{setValue(e,n){}setValid(e,n){return this.length=Math.max(e+1,this.length),n}}class w3 extends Me{setValue(e,n){const{children:r,type:s}=this;switch(Array.isArray(n)||n.constructor){case!0:return s.children.forEach((a,o)=>r[o].set(e,n[o]));case Map:return s.children.forEach((a,o)=>r[o].set(e,n.get(a.name)));default:return s.children.forEach((a,o)=>r[o].set(e,n[a.name]))}}setValid(e,n){return super.setValid(e,n)||this.children.forEach(r=>r.setValid(e,n)),n}addChild(e,n=`${this.numChildren}`){const r=this.children.push(e);return this.type=new ne([...this.type.children,new St(n,e.type,!0)]),r}}class ps extends hi{}ps.prototype._setValue=W0;class Qy extends ps{}Qy.prototype._setValue=Xc;class Jy extends ps{}Jy.prototype._setValue=Zc;class Xy extends ps{}Xy.prototype._setValue=th;class Zy extends ps{}Zy.prototype._setValue=eh;class ms extends hi{}ms.prototype._setValue=H0;class tg extends ms{}tg.prototype._setValue=nh;class eg extends ms{}eg.prototype._setValue=ih;class ng extends ms{}ng.prototype._setValue=rh;class ig extends ms{}ig.prototype._setValue=sh;class vh extends Me{constructor(e){super(e),this._typeIds=new ba(new Int8Array(0),1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,n){return this.set(this.length,e,n)}set(e,n,r){return r===void 0&&(r=this._valueToChildTypeId(this,n,e)),this.setValue(e,n,r),this}setValue(e,n,r){this._typeIds.set(e,r);const s=this.type.typeIdToChildIndex[r],a=this.children[s];a==null||a.set(e,n)}addChild(e,n=`${this.children.length}`){const r=this.children.push(e),{type:{children:s,mode:a,typeIds:o}}=this,u=[...s,new St(n,e.type)];return this.type=new sa(a,[...o,r],u),r}_valueToChildTypeId(e,n,r){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class x3 extends vh{}class S3 extends vh{constructor(e){super(e),this._offsets=new ba(new Int32Array(0))}setValue(e,n,r){const s=this._typeIds.set(e,r).buffer[e],a=this.getChildAt(this.type.typeIdToChildIndex[s]),o=this._offsets.set(e,a.length).buffer[e];a==null||a.set(o,n)}}class rg extends gu{constructor(e){super(e),this._values=new yu(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,n){return super.setValue(e,Bc(n))}_flushPending(e,n){}}rg.prototype._flushPending=Vy.prototype._flushPending;class I3 extends rt{visitNull(){return b3}visitBool(){return r3}visitInt(){return fi}visitInt8(){return c3}visitInt16(){return h3}visitInt32(){return f3}visitInt64(){return d3}visitUint8(){return p3}visitUint16(){return m3}visitUint32(){return y3}visitUint64(){return g3}visitFloat(){return _u}visitFloat16(){return o3}visitFloat32(){return u3}visitFloat64(){return l3}visitUtf8(){return rg}visitBinary(){return Vy}visitFixedSizeBinary(){return zy}visitDate(){return vu}visitDateDay(){return Uy}visitDateMillisecond(){return $y}visitTimestamp(){return ps}visitTimestampSecond(){return Qy}visitTimestampMillisecond(){return Jy}visitTimestampMicrosecond(){return Xy}visitTimestampNanosecond(){return Zy}visitTime(){return ms}visitTimeSecond(){return tg}visitTimeMillisecond(){return eg}visitTimeMicrosecond(){return ng}visitTimeNanosecond(){return ig}visitDecimal(){return jy}visitList(){return v3}visitStruct(){return w3}visitUnion(){return vh}visitDenseUnion(){return S3}visitSparseUnion(){return x3}visitDictionary(){return s3}visitInterval(){return bu}visitIntervalDayTime(){return qy}visitIntervalYearMonth(){return Wy}visitDuration(){return ds}visitDurationSecond(){return Hy}visitDurationMillisecond(){return Yy}visitDurationMicrosecond(){return Gy}visistDurationNanosecond(){return Ky}visitFixedSizeList(){return a3}visitMap(){return _3}}const T3=new I3;class H extends rt{compareSchemas(e,n){return e===n||n instanceof e.constructor&&this.compareManyFields(e.fields,n.fields)}compareManyFields(e,n){return e===n||Array.isArray(e)&&Array.isArray(n)&&e.length===n.length&&e.every((r,s)=>this.compareFields(r,n[s]))}compareFields(e,n){return e===n||n instanceof e.constructor&&e.name===n.name&&e.nullable===n.nullable&&this.visit(e.type,n.type)}}function fe(t,e){return e instanceof t.constructor}function wa(t,e){return t===e||fe(t,e)}function di(t,e){return t===e||fe(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function wu(t,e){return t===e||fe(t,e)&&t.precision===e.precision}function A3(t,e){return t===e||fe(t,e)&&t.byteWidth===e.byteWidth}function _h(t,e){return t===e||fe(t,e)&&t.unit===e.unit}function xa(t,e){return t===e||fe(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Sa(t,e){return t===e||fe(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function C3(t,e){return t===e||fe(t,e)&&t.children.length===e.children.length&&Bi.compareManyFields(t.children,e.children)}function k3(t,e){return t===e||fe(t,e)&&t.children.length===e.children.length&&Bi.compareManyFields(t.children,e.children)}function bh(t,e){return t===e||fe(t,e)&&t.mode===e.mode&&t.typeIds.every((n,r)=>n===e.typeIds[r])&&Bi.compareManyFields(t.children,e.children)}function M3(t,e){return t===e||fe(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Bi.visit(t.indices,e.indices)&&Bi.visit(t.dictionary,e.dictionary)}function wh(t,e){return t===e||fe(t,e)&&t.unit===e.unit}function Ia(t,e){return t===e||fe(t,e)&&t.unit===e.unit}function N3(t,e){return t===e||fe(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Bi.compareManyFields(t.children,e.children)}function E3(t,e){return t===e||fe(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Bi.compareManyFields(t.children,e.children)}H.prototype.visitNull=wa;H.prototype.visitBool=wa;H.prototype.visitInt=di;H.prototype.visitInt8=di;H.prototype.visitInt16=di;H.prototype.visitInt32=di;H.prototype.visitInt64=di;H.prototype.visitUint8=di;H.prototype.visitUint16=di;H.prototype.visitUint32=di;H.prototype.visitUint64=di;H.prototype.visitFloat=wu;H.prototype.visitFloat16=wu;H.prototype.visitFloat32=wu;H.prototype.visitFloat64=wu;H.prototype.visitUtf8=wa;H.prototype.visitBinary=wa;H.prototype.visitFixedSizeBinary=A3;H.prototype.visitDate=_h;H.prototype.visitDateDay=_h;H.prototype.visitDateMillisecond=_h;H.prototype.visitTimestamp=xa;H.prototype.visitTimestampSecond=xa;H.prototype.visitTimestampMillisecond=xa;H.prototype.visitTimestampMicrosecond=xa;H.prototype.visitTimestampNanosecond=xa;H.prototype.visitTime=Sa;H.prototype.visitTimeSecond=Sa;H.prototype.visitTimeMillisecond=Sa;H.prototype.visitTimeMicrosecond=Sa;H.prototype.visitTimeNanosecond=Sa;H.prototype.visitDecimal=wa;H.prototype.visitList=C3;H.prototype.visitStruct=k3;H.prototype.visitUnion=bh;H.prototype.visitDenseUnion=bh;H.prototype.visitSparseUnion=bh;H.prototype.visitDictionary=M3;H.prototype.visitInterval=wh;H.prototype.visitIntervalDayTime=wh;H.prototype.visitIntervalYearMonth=wh;H.prototype.visitDuration=Ia;H.prototype.visitDurationSecond=Ia;H.prototype.visitDurationMillisecond=Ia;H.prototype.visitDurationMicrosecond=Ia;H.prototype.visitDurationNanosecond=Ia;H.prototype.visitFixedSizeList=N3;H.prototype.visitMap=E3;const Bi=new H;function $l(t,e){return Bi.compareSchemas(t,e)}function jo(t){const e=t.type,n=new(T3.getVisitFn(e)())(t);if(e.children&&e.children.length>0){const r=t.children||[],s={nullValues:t.nullValues},a=Array.isArray(r)?(o,u)=>r[u]||s:({name:o})=>r[o]||s;for(const[o,u]of e.children.entries()){const{type:l}=u,c=a(u,o);n.children.push(jo(Object.assign(Object.assign({},c),{type:l})))}}return n}function al(t,e){return O3(t,e.map(n=>n.data.concat()))}function O3(t,e){const n=[...t.fields],r=[],s={numBatches:e.reduce((f,d)=>Math.max(f,d.length),0)};let a=0,o=0,u=-1;const l=e.length;let c,h=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,u=-1;++u<l;)h[u]=c=e[u].shift(),o=Math.min(o,c?c.length:o);Number.isFinite(o)&&(h=D3(n,o,h,e,s),o>0&&(r[a++]=ee({type:new ne(n),length:o,nullCount:0,children:h.slice()})))}return[t=t.assign(n),r.map(f=>new Oe(t,f))]}function D3(t,e,n,r,s){var a;const o=(e+63&-64)>>3;for(let u=-1,l=r.length;++u<l;){const c=n[u],h=c==null?void 0:c.length;if(h>=e)h===e?n[u]=c:(n[u]=c.slice(0,e),s.numBatches=Math.max(s.numBatches,r[u].unshift(c.slice(e,h-e))));else{const f=t[u];t[u]=f.clone({nullable:!0}),n[u]=(a=c==null?void 0:c._changeLengthAndBackfillNullBitmap(e))!==null&&a!==void 0?a:ee({type:f.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)})}}return n}var sg;class xe{constructor(...e){var n,r;if(e.length===0)return this.batches=[],this.schema=new It([]),this._offsets=[0],this;let s,a;e[0]instanceof It&&(s=e.shift()),e.at(-1)instanceof Uint32Array&&(a=e.pop());const o=l=>{if(l){if(l instanceof Oe)return[l];if(l instanceof xe)return l.batches;if(l instanceof Tt){if(l.type instanceof ne)return[new Oe(new It(l.type.children),l)]}else{if(Array.isArray(l))return l.flatMap(c=>o(c));if(typeof l[Symbol.iterator]=="function")return[...l].flatMap(c=>o(c));if(typeof l=="object"){const c=Object.keys(l),h=c.map(m=>new wt([l[m]])),f=new It(c.map((m,p)=>new St(String(m),h[p].type))),[,d]=al(f,h);return d.length===0?[new Oe(l)]:d}}}return[]},u=e.flatMap(l=>o(l));if(s=(r=s??((n=u[0])===null||n===void 0?void 0:n.schema))!==null&&r!==void 0?r:new It([]),!(s instanceof It))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const l of u){if(!(l instanceof Oe))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!$l(s,l.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=s,this.batches=u,this._offsets=a??Sy(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,n)=>e+n.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=xy(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}set(e,n){}indexOf(e,n){return-1}getByteLength(e){return 0}[Symbol.iterator](){return this.batches.length>0?gh.visit(new wt(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...e){const n=this.schema,r=this.data.concat(e.flatMap(({data:s})=>s));return new xe(n,r.map(s=>new Oe(n,s)))}slice(e,n){const r=this.schema;[e,n]=_y({length:this.numRows},e,n);const s=Iy(this.data,this._offsets,e,n);return new xe(r,s.map(a=>new Oe(r,a)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(n=>n.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const n=this.data.map(r=>r.children[e]);if(n.length===0){const{type:r}=this.schema.fields[e],s=ee({type:r,length:0,nullCount:0});n.push(s._changeLengthAndBackfillNullBitmap(this.numRows))}return new wt(n)}return null}setChild(e,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(s=>s.name===e),n)}setChildAt(e,n){let r=this.schema,s=[...this.batches];if(e>-1&&e<this.numCols){n||(n=new wt([ee({type:new si,length:this.numRows})]));const a=r.fields.slice(),o=a[e].clone({type:n.type}),u=this.schema.fields.map((l,c)=>this.getChildAt(c));[a[e],u[e]]=[o,n],[r,s]=al(r,u)}return new xe(r,s)}select(e){const n=this.schema.fields.reduce((r,s,a)=>r.set(s.name,a),new Map);return this.selectAt(e.map(r=>n.get(r)).filter(r=>r>-1))}selectAt(e){const n=this.schema.selectAt(e),r=this.batches.map(s=>s.selectAt(e));return new xe(n,r)}assign(e){const n=this.schema.fields,[r,s]=e.schema.fields.reduce((u,l,c)=>{const[h,f]=u,d=n.findIndex(m=>m.name===l.name);return~d?f[d]=c:h.push(c),u},[[],[]]),a=this.schema.assign(e.schema),o=[...n.map((u,l)=>[l,s[l]]).map(([u,l])=>l===void 0?this.getChildAt(u):e.getChildAt(l)),...r.map(u=>e.getChildAt(u))].filter(Boolean);return new xe(...al(a,o))}}sg=Symbol.toStringTag;xe[sg]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=Pr(yh),t.get=Pr(Ce.getVisitFn(w.Struct)),t.set=Ty(Ke.getVisitFn(w.Struct)),t.indexOf=Ay(Fo.getVisitFn(w.Struct)),t.getByteLength=Pr(Vn.getVisitFn(w.Struct)),"Table"))(xe.prototype);var ag;let Oe=class Rs{constructor(...e){switch(e.length){case 2:{if([this.schema]=e,!(this.schema instanceof It))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=ee({nullCount:0,type:new ne(this.schema.fields),children:this.schema.fields.map(n=>ee({type:n.type,nullCount:0}))})]=e,!(this.data instanceof Tt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Nd(this.schema,this.data.children);break}case 1:{const[n]=e,{fields:r,children:s,length:a}=Object.keys(n).reduce((l,c,h)=>(l.children[h]=n[c],l.length=Math.max(l.length,n[c].length),l.fields[h]=St.new({name:c,type:n[c].type,nullable:!0}),l),{length:0,fields:new Array,children:new Array}),o=new It(r),u=ee({type:new ne(r),length:a,children:s,nullCount:0});[this.schema,this.data]=Nd(o,u.children,a);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=og(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return Ce.visit(this.data,e)}set(e,n){return Ke.visit(this.data,e,n)}indexOf(e,n){return Fo.visit(this.data,e,n)}getByteLength(e){return Vn.visit(this.data,e)}[Symbol.iterator](){return gh.visit(new wt([this.data]))}toArray(){return[...this]}concat(...e){return new xe(this.schema,[this,...e])}slice(e,n){const[r]=new wt([this.data]).slice(e,n).data;return new Rs(this.schema,r)}getChild(e){var n;return this.getChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(r=>r.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new wt([this.data.children[e]]):null}setChild(e,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(s=>s.name===e),n)}setChildAt(e,n){let r=this.schema,s=this.data;if(e>-1&&e<this.numCols){n||(n=new wt([ee({type:new si,length:this.numRows})]));const a=r.fields.slice(),o=s.children.slice(),u=a[e].clone({type:n.type});[a[e],o[e]]=[u,n.data[0]],r=new It(a,new Map(this.schema.metadata)),s=ee({type:new ne(a),children:o})}return new Rs(r,s)}select(e){const n=this.schema.select(e),r=new ne(n.fields),s=[];for(const a of e){const o=this.schema.fields.findIndex(u=>u.name===a);~o&&(s[o]=this.data.children[o])}return new Rs(n,ee({type:r,length:this.numRows,children:s}))}selectAt(e){const n=this.schema.selectAt(e),r=e.map(a=>this.data.children[a]).filter(Boolean),s=ee({type:new ne(n.fields),length:this.numRows,children:r});return new Rs(n,s)}};ag=Symbol.toStringTag;Oe[ag]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Oe.prototype);function Nd(t,e,n=e.reduce((r,s)=>Math.max(r,s.length),0)){var r;const s=[...t.fields],a=[...e],o=(n+63&-64)>>3;for(const[u,l]of t.fields.entries()){const c=e[u];(!c||c.length!==n)&&(s[u]=l.clone({nullable:!0}),a[u]=(r=c==null?void 0:c._changeLengthAndBackfillNullBitmap(n))!==null&&r!==void 0?r:ee({type:l.type,length:n,nullCount:n,nullBitmap:new Uint8Array(o)}))}return[t.assign(s),ee({type:new ne(s),length:n,children:a})]}function og(t,e,n=new Map){var r,s;if(((r=t==null?void 0:t.length)!==null&&r!==void 0?r:0)>0&&(t==null?void 0:t.length)===(e==null?void 0:e.length))for(let a=-1,o=t.length;++a<o;){const{type:u}=t[a],l=e[a];for(const c of[l,...((s=l==null?void 0:l.dictionary)===null||s===void 0?void 0:s.data)||[]])og(u.children,c==null?void 0:c.children,n);if(et.isDictionary(u)){const{id:c}=u;if(!n.has(c))l!=null&&l.dictionary&&n.set(c,l.dictionary);else if(n.get(c)!==l.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return n}class F3 extends Oe{constructor(e){const n=e.fields.map(s=>ee({type:s.type})),r=ee({type:new ne(e.fields),nullCount:0,children:n});super(e,r)}}var zo;(function(t){t[t.BUFFER=0]="BUFFER"})(zo||(zo={}));var qo;(function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"})(qo||(qo={}));class Si{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBodyCompression(e,n){return(n||new Si).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,n){return e.setPosition(e.position()+kt),(n||new Si).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):qo.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):zo.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,n){e.addFieldInt8(0,n,qo.LZ4_FRAME)}static addMethod(e,n){e.addFieldInt8(1,n,zo.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,n,r){return Si.startBodyCompression(e),Si.addCodec(e,n),Si.addMethod(e,r),Si.endBodyCompression(e)}}class ug{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,n,r){return e.prep(8,16),e.writeInt64(BigInt(r??0)),e.writeInt64(BigInt(n??0)),e.offset()}}let lg=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,n,r){return e.prep(8,16),e.writeInt64(BigInt(r??0)),e.writeInt64(BigInt(n??0)),e.offset()}},Yn=class jl{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsRecordBatch(e,n){return(n||new jl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,n){return e.setPosition(e.position()+kt),(n||new jl).__init(e.readInt32(e.position())+e.position(),e)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}nodes(e,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new lg).__init(this.bb.__vector(this.bb_pos+r)+e*16,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new ug).__init(this.bb.__vector(this.bb_pos+r)+e*16,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new Si).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addNodes(e,n){e.addFieldOffset(1,n,0)}static startNodesVector(e,n){e.startVector(16,n,8)}static addBuffers(e,n){e.addFieldOffset(2,n,0)}static startBuffersVector(e,n){e.startVector(16,n,8)}static addCompression(e,n){e.addFieldOffset(3,n,0)}static endRecordBatch(e){return e.endObject()}},Sr=class zl{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDictionaryBatch(e,n){return(n||new zl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,n){return e.setPosition(e.position()+kt),(n||new zl).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}data(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Yn).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startDictionaryBatch(e){e.startObject(3)}static addId(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addData(e,n){e.addFieldOffset(1,n,0)}static addIsDelta(e,n){e.addFieldInt8(2,+n,0)}static endDictionaryBatch(e){return e.endObject()}};var Wo;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(Wo||(Wo={}));let bi=class vn{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsMessage(e,n){return(n||new vn).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,n){return e.setPosition(e.position()+kt),(n||new vn).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):es.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):Wo.NONE}header(e){const n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__union(e,this.bb_pos+n):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}customMetadata(e,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,n){e.addFieldInt16(0,n,es.V1)}static addHeaderType(e,n){e.addFieldInt8(1,n,Wo.NONE)}static addHeader(e,n){e.addFieldOffset(2,n,0)}static addBodyLength(e,n){e.addFieldInt64(3,n,BigInt("0"))}static addCustomMetadata(e,n){e.addFieldOffset(4,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)e.addOffset(n[r]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,n){e.finish(n)}static finishSizePrefixedMessageBuffer(e,n){e.finish(n,void 0,!0)}static createMessage(e,n,r,s,a,o){return vn.startMessage(e),vn.addVersion(e,n),vn.addHeaderType(e,r),vn.addHeader(e,s),vn.addBodyLength(e,a),vn.addCustomMetadata(e,o),vn.endMessage(e)}};class B3 extends rt{visit(e,n){return e==null||n==null?void 0:super.visit(e,n)}visitNull(e,n){return er.startNull(n),er.endNull(n)}visitInt(e,n){return Ee.startInt(n),Ee.addBitWidth(n,e.bitWidth),Ee.addIsSigned(n,e.isSigned),Ee.endInt(n)}visitFloat(e,n){return kn.startFloatingPoint(n),kn.addPrecision(n,e.precision),kn.endFloatingPoint(n)}visitBinary(e,n){return Xi.startBinary(n),Xi.endBinary(n)}visitBool(e,n){return Zi.startBool(n),Zi.endBool(n)}visitUtf8(e,n){return ir.startUtf8(n),ir.endUtf8(n)}visitDecimal(e,n){return be.startDecimal(n),be.addScale(n,e.scale),be.addPrecision(n,e.precision),be.addBitWidth(n,e.bitWidth),be.endDecimal(n)}visitDate(e,n){return Xa.startDate(n),Xa.addUnit(n,e.unit),Xa.endDate(n)}visitTime(e,n){return ze.startTime(n),ze.addUnit(n,e.unit),ze.addBitWidth(n,e.bitWidth),ze.endTime(n)}visitTimestamp(e,n){const r=e.timezone&&n.createString(e.timezone)||void 0;return qe.startTimestamp(n),qe.addUnit(n,e.unit),r!==void 0&&qe.addTimezone(n,r),qe.endTimestamp(n)}visitInterval(e,n){return Mn.startInterval(n),Mn.addUnit(n,e.unit),Mn.endInterval(n)}visitDuration(e,n){return Tn.startDuration(n),Tn.addUnit(n,e.unit),Tn.endDuration(n)}visitList(e,n){return tr.startList(n),tr.endList(n)}visitStruct(e,n){return nr.startStruct_(n),nr.endStruct_(n)}visitUnion(e,n){we.startTypeIdsVector(n,e.typeIds.length);const r=we.createTypeIdsVector(n,e.typeIds);return we.startUnion(n),we.addMode(n,e.mode),we.addTypeIds(n,r),we.endUnion(n)}visitDictionary(e,n){const r=this.visit(e.indices,n);return Jn.startDictionaryEncoding(n),Jn.addId(n,BigInt(e.id)),Jn.addIsOrdered(n,e.isOrdered),r!==void 0&&Jn.addIndexType(n,r),Jn.endDictionaryEncoding(n)}visitFixedSizeBinary(e,n){return An.startFixedSizeBinary(n),An.addByteWidth(n,e.byteWidth),An.endFixedSizeBinary(n)}visitFixedSizeList(e,n){return Cn.startFixedSizeList(n),Cn.addListSize(n,e.listSize),Cn.endFixedSizeList(n)}visitMap(e,n){return Za.startMap(n),Za.addKeysSorted(n,e.keysSorted),Za.endMap(n)}}const ol=new B3;function R3(t,e=new Map){return new It(P3(t,e),eo(t.metadata),e)}function cg(t){return new Re(t.count,hg(t.columns),fg(t.columns))}function L3(t){return new Un(cg(t.data),t.id,t.isDelta)}function P3(t,e){return(t.fields||[]).filter(Boolean).map(n=>St.fromJSON(n,e))}function Ed(t,e){return(t.children||[]).filter(Boolean).map(n=>St.fromJSON(n,e))}function hg(t){return(t||[]).reduce((e,n)=>[...e,new Ri(n.count,V3(n.VALIDITY)),...hg(n.children)],[])}function fg(t,e=[]){for(let n=-1,r=(t||[]).length;++n<r;){const s=t[n];s.VALIDITY&&e.push(new Dn(e.length,s.VALIDITY.length)),s.TYPE_ID&&e.push(new Dn(e.length,s.TYPE_ID.length)),s.OFFSET&&e.push(new Dn(e.length,s.OFFSET.length)),s.DATA&&e.push(new Dn(e.length,s.DATA.length)),e=fg(s.children,e)}return e}function V3(t){return(t||[]).reduce((e,n)=>e+ +(n===0),0)}function U3(t,e){let n,r,s,a,o,u;return!e||!(a=t.dictionary)?(o=Dd(t,Ed(t,e)),s=new St(t.name,o,t.nullable,eo(t.metadata))):e.has(n=a.id)?(r=(r=a.indexType)?Od(r):new Ni,u=new Oi(e.get(n),r,n,a.isOrdered),s=new St(t.name,u,t.nullable,eo(t.metadata))):(r=(r=a.indexType)?Od(r):new Ni,e.set(n,o=Dd(t,Ed(t,e))),u=new Oi(o,r,n,a.isOrdered),s=new St(t.name,u,t.nullable,eo(t.metadata))),s||null}function eo(t=[]){return new Map(t.map(({key:e,value:n})=>[e,n]))}function Od(t){return new he(t.isSigned,t.bitWidth)}function Dd(t,e){const n=t.type.name;switch(n){case"NONE":return new si;case"null":return new si;case"binary":return new ia;case"utf8":return new Qr;case"bool":return new ra;case"list":return new Zr((e||[])[0]);case"struct":return new ne(e||[]);case"struct_":return new ne(e||[])}switch(n){case"int":{const r=t.type;return new he(r.isSigned,r.bitWidth)}case"floatingpoint":{const r=t.type;return new Ei(Xt[r.precision])}case"decimal":{const r=t.type;return new Mo(r.scale,r.precision,r.bitWidth)}case"date":{const r=t.type;return new Jr(Ln[r.unit])}case"time":{const r=t.type;return new ai(j[r.unit],r.bitWidth)}case"timestamp":{const r=t.type;return new No(j[r.unit],r.timezone)}case"interval":{const r=t.type;return new Xr(Pn[r.unit])}case"duration":{const r=t.type;return new Eo(j[r.unit])}case"union":{const r=t.type,[s,...a]=(r.mode+"").toLowerCase(),o=s.toUpperCase()+a.join("");return new sa(Ae[o],r.typeIds||[],e||[])}case"fixedsizebinary":{const r=t.type;return new Oo(r.byteWidth)}case"fixedsizelist":{const r=t.type;return new ts(r.listSize,(e||[])[0])}case"map":{const r=t.type;return new aa((e||[])[0],r.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var $3=Ry,j3=Ro;class Nn{static fromJSON(e,n){const r=new Nn(0,le.V5,n);return r._createHeader=z3(e,n),r}static decode(e){e=new j3(At(e));const n=bi.getRootAsMessage(e),r=n.bodyLength(),s=n.version(),a=n.headerType(),o=new Nn(r,s,a);return o._createHeader=q3(n,a),o}static encode(e){const n=new $3;let r=-1;return e.isSchema()?r=It.encode(n,e.header()):e.isRecordBatch()?r=Re.encode(n,e.header()):e.isDictionaryBatch()&&(r=Un.encode(n,e.header())),bi.startMessage(n),bi.addVersion(n,le.V5),bi.addHeader(n,r),bi.addHeaderType(n,e.headerType),bi.addBodyLength(n,BigInt(e.bodyLength)),bi.finishMessageBuffer(n,bi.endMessage(n)),n.asUint8Array()}static from(e,n=0){if(e instanceof It)return new Nn(0,le.V5,Yt.Schema,e);if(e instanceof Re)return new Nn(n,le.V5,Yt.RecordBatch,e);if(e instanceof Un)return new Nn(n,le.V5,Yt.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Yt.Schema}isRecordBatch(){return this.headerType===Yt.RecordBatch}isDictionaryBatch(){return this.headerType===Yt.DictionaryBatch}constructor(e,n,r,s){this._version=n,this._headerType=r,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=fn(e)}}class Re{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,n,r){this._nodes=n,this._buffers=r,this._length=fn(e)}}class Un{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,n,r=!1){this._data=e,this._isDelta=r,this._id=fn(n)}}class Dn{constructor(e,n){this.offset=fn(e),this.length=fn(n)}}class Ri{constructor(e,n){this.length=fn(e),this.nullCount=fn(n)}}function z3(t,e){return()=>{switch(e){case Yt.Schema:return It.fromJSON(t);case Yt.RecordBatch:return Re.fromJSON(t);case Yt.DictionaryBatch:return Un.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${Yt[e]}, type: ${e} }`)}}function q3(t,e){return()=>{switch(e){case Yt.Schema:return It.decode(t.header(new bn),new Map,t.version());case Yt.RecordBatch:return Re.decode(t.header(new Yn),t.version());case Yt.DictionaryBatch:return Un.decode(t.header(new Sr),t.version())}throw new Error(`Unrecognized Message type: { name: ${Yt[e]}, type: ${e} }`)}}St.encode=eC;St.decode=Z3;St.fromJSON=U3;It.encode=tC;It.decode=W3;It.fromJSON=R3;Re.encode=nC;Re.decode=H3;Re.fromJSON=cg;Un.encode=iC;Un.decode=Y3;Un.fromJSON=L3;Ri.encode=rC;Ri.decode=K3;Dn.encode=sC;Dn.decode=G3;function W3(t,e=new Map,n=le.V5){const r=X3(t,e);return new It(r,no(t),e,n)}function H3(t,e=le.V5){if(t.compression()!==null)throw new Error("Record batch compression not implemented");return new Re(t.length(),Q3(t),J3(t,e))}function Y3(t,e=le.V5){return new Un(Re.decode(t.data(),e),t.id(),t.isDelta())}function G3(t){return new Dn(t.offset(),t.length())}function K3(t){return new Ri(t.length(),t.nullCount())}function Q3(t){const e=[];for(let n,r=-1,s=-1,a=t.nodesLength();++r<a;)(n=t.nodes(r))&&(e[++s]=Ri.decode(n));return e}function J3(t,e){const n=[];for(let r,s=-1,a=-1,o=t.buffersLength();++s<o;)(r=t.buffers(s))&&(e<le.V4&&(r.bb_pos+=8*(s+1)),n[++a]=Dn.decode(r));return n}function X3(t,e){const n=[];for(let r,s=-1,a=-1,o=t.fieldsLength();++s<o;)(r=t.fields(s))&&(n[++a]=St.decode(r,e));return n}function Fd(t,e){const n=[];for(let r,s=-1,a=-1,o=t.childrenLength();++s<o;)(r=t.children(s))&&(n[++a]=St.decode(r,e));return n}function Z3(t,e){let n,r,s,a,o,u;return!e||!(u=t.dictionary())?(s=Rd(t,Fd(t,e)),r=new St(t.name(),s,t.nullable(),no(t))):e.has(n=fn(u.id()))?(a=(a=u.indexType())?Bd(a):new Ni,o=new Oi(e.get(n),a,n,u.isOrdered()),r=new St(t.name(),o,t.nullable(),no(t))):(a=(a=u.indexType())?Bd(a):new Ni,e.set(n,s=Rd(t,Fd(t,e))),o=new Oi(s,a,n,u.isOrdered()),r=new St(t.name(),o,t.nullable(),no(t))),r||null}function no(t){const e=new Map;if(t)for(let n,r,s=-1,a=Math.trunc(t.customMetadataLength());++s<a;)(n=t.customMetadata(s))&&(r=n.key())!=null&&e.set(r,n.value());return e}function Bd(t){return new he(t.isSigned(),t.bitWidth())}function Rd(t,e){const n=t.typeType();switch(n){case Ft.NONE:return new si;case Ft.Null:return new si;case Ft.Binary:return new ia;case Ft.Utf8:return new Qr;case Ft.Bool:return new ra;case Ft.List:return new Zr((e||[])[0]);case Ft.Struct_:return new ne(e||[])}switch(n){case Ft.Int:{const r=t.type(new Ee);return new he(r.isSigned(),r.bitWidth())}case Ft.FloatingPoint:{const r=t.type(new kn);return new Ei(r.precision())}case Ft.Decimal:{const r=t.type(new be);return new Mo(r.scale(),r.precision(),r.bitWidth())}case Ft.Date:{const r=t.type(new Xa);return new Jr(r.unit())}case Ft.Time:{const r=t.type(new ze);return new ai(r.unit(),r.bitWidth())}case Ft.Timestamp:{const r=t.type(new qe);return new No(r.unit(),r.timezone())}case Ft.Interval:{const r=t.type(new Mn);return new Xr(r.unit())}case Ft.Duration:{const r=t.type(new Tn);return new Eo(r.unit())}case Ft.Union:{const r=t.type(new we);return new sa(r.mode(),r.typeIdsArray()||[],e||[])}case Ft.FixedSizeBinary:{const r=t.type(new An);return new Oo(r.byteWidth())}case Ft.FixedSizeList:{const r=t.type(new Cn);return new ts(r.listSize(),(e||[])[0])}case Ft.Map:{const r=t.type(new Za);return new aa((e||[])[0],r.keysSorted())}}throw new Error(`Unrecognized type: "${Ft[n]}" (${n})`)}function tC(t,e){const n=e.fields.map(a=>St.encode(t,a));bn.startFieldsVector(t,n.length);const r=bn.createFieldsVector(t,n),s=e.metadata&&e.metadata.size>0?bn.createCustomMetadataVector(t,[...e.metadata].map(([a,o])=>{const u=t.createString(`${a}`),l=t.createString(`${o}`);return jt.startKeyValue(t),jt.addKey(t,u),jt.addValue(t,l),jt.endKeyValue(t)})):-1;return bn.startSchema(t),bn.addFields(t,r),bn.addEndianness(t,aC?ns.Little:ns.Big),s!==-1&&bn.addCustomMetadata(t,s),bn.endSchema(t)}function eC(t,e){let n=-1,r=-1,s=-1;const a=e.type;let o=e.typeId;et.isDictionary(a)?(o=a.dictionary.typeId,s=ol.visit(a,t),r=ol.visit(a.dictionary,t)):r=ol.visit(a,t);const u=(a.children||[]).map(h=>St.encode(t,h)),l=$e.createChildrenVector(t,u),c=e.metadata&&e.metadata.size>0?$e.createCustomMetadataVector(t,[...e.metadata].map(([h,f])=>{const d=t.createString(`${h}`),m=t.createString(`${f}`);return jt.startKeyValue(t),jt.addKey(t,d),jt.addValue(t,m),jt.endKeyValue(t)})):-1;return e.name&&(n=t.createString(e.name)),$e.startField(t),$e.addType(t,r),$e.addTypeType(t,o),$e.addChildren(t,l),$e.addNullable(t,!!e.nullable),n!==-1&&$e.addName(t,n),s!==-1&&$e.addDictionary(t,s),c!==-1&&$e.addCustomMetadata(t,c),$e.endField(t)}function nC(t,e){const n=e.nodes||[],r=e.buffers||[];Yn.startNodesVector(t,n.length);for(const o of n.slice().reverse())Ri.encode(t,o);const s=t.endVector();Yn.startBuffersVector(t,r.length);for(const o of r.slice().reverse())Dn.encode(t,o);const a=t.endVector();return Yn.startRecordBatch(t),Yn.addLength(t,BigInt(e.length)),Yn.addNodes(t,s),Yn.addBuffers(t,a),Yn.endRecordBatch(t)}function iC(t,e){const n=Re.encode(t,e.data);return Sr.startDictionaryBatch(t),Sr.addId(t,BigInt(e.id)),Sr.addIsDelta(t,e.isDelta),Sr.addData(t,n),Sr.endDictionaryBatch(t)}function rC(t,e){return lg.createFieldNode(t,BigInt(e.length),BigInt(e.nullCount))}function sC(t,e){return ug.createBuffer(t,BigInt(e.offset),BigInt(e.length))}const aC=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256})(),ql="ARROW1",xh=new Uint8Array(ql.length);for(let t=0;t<ql.length;t+=1)xh[t]=ql.codePointAt(t);xh.length;class Ut extends rt{static assemble(...e){const n=s=>s.flatMap(a=>Array.isArray(a)?n(a):a instanceof Oe?a.data.children:a.data),r=new Ut;return r.visitMany(n(e)),r}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(e){if(e instanceof wt)return this.visitMany(e.data),this;const{type:n}=e;if(!et.isDictionary(n)){const{length:r}=e;if(r>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(et.isUnion(n))this.nodes.push(new Ri(r,0));else{const{nullCount:s}=e;et.isNull(n)||cn.call(this,s<=0?new Uint8Array(0):Do(e.offset,r,e.nullBitmap)),this.nodes.push(new Ri(r,s))}}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function cn(t){const e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new Dn(this._byteLength,e)),this._byteLength+=e,this}function oC(t){var e;const{type:n,length:r,typeIds:s,valueOffsets:a}=t;if(cn.call(this,s),n.mode===Ae.Sparse)return Wl.call(this,t);if(n.mode===Ae.Dense){if(t.offset<=0)return cn.call(this,a),Wl.call(this,t);{const o=new Int32Array(r),u=Object.create(null),l=Object.create(null);for(let c,h,f=-1;++f<r;)(c=s[f])!==void 0&&((h=u[c])===void 0&&(h=u[c]=a[f]),o[f]=a[f]-h,l[c]=((e=l[c])!==null&&e!==void 0?e:0)+1);cn.call(this,o),this.visitMany(t.children.map((c,h)=>{const f=n.typeIds[h],d=u[f],m=l[f];return c.slice(d,Math.min(r,m))}))}}return this}function uC(t){let e;return t.nullCount>=t.length?cn.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?cn.call(this,Do(t.offset,t.length,e)):cn.call(this,wy(t.values))}function pi(t){return cn.call(this,t.values.subarray(0,t.length*t.stride))}function dg(t){const{length:e,values:n,valueOffsets:r}=t,{[0]:s,[e]:a}=r,o=Math.min(a-s,n.byteLength-s);return cn.call(this,m0(-s,e+1,r)),cn.call(this,n.subarray(s,s+o)),this}function Sh(t){const{length:e,valueOffsets:n}=t;if(n){const{[0]:r,[e]:s}=n;return cn.call(this,m0(-r,e+1,n)),this.visit(t.children[0].slice(r,s-r))}return this.visit(t.children[0])}function Wl(t){return this.visitMany(t.type.children.map((e,n)=>t.children[n]).filter(Boolean))[0]}Ut.prototype.visitBool=uC;Ut.prototype.visitInt=pi;Ut.prototype.visitFloat=pi;Ut.prototype.visitUtf8=dg;Ut.prototype.visitBinary=dg;Ut.prototype.visitFixedSizeBinary=pi;Ut.prototype.visitDate=pi;Ut.prototype.visitTimestamp=pi;Ut.prototype.visitTime=pi;Ut.prototype.visitDecimal=pi;Ut.prototype.visitList=Sh;Ut.prototype.visitStruct=Wl;Ut.prototype.visitUnion=oC;Ut.prototype.visitInterval=pi;Ut.prototype.visitDuration=pi;Ut.prototype.visitFixedSizeList=Sh;Ut.prototype.visitMap=Sh;class pg extends Py{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,n){throw new Error('"throughDOM" not available in this environment')}constructor(e){super(),this._position=0,this._started=!1,this._sink=new sl,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,$i(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return fu(e)?e.then(n=>this.writeAll(n)):du(e)?Ch(this,e):Ah(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,n=null){return e===this._sink||e instanceof sl?this._sink=e:(this._sink=new sl,e&&pT(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&mT(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!n||!$l(n,this._schema))&&(n==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=n,this._writeSchema(n))),this}write(e){let n=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof xe&&!(n=e.schema))return this.finish()&&void 0;if(e instanceof Oe&&!(n=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(n&&!$l(n,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,n)}e instanceof Oe?e instanceof F3||this._writeRecordBatch(e):e instanceof xe?this.writeAll(e.batches):Rc(e)&&this.writeAll(e)}_writeMessage(e,n=8){const r=n-1,s=Nn.encode(e),a=s.byteLength,o=this._writeLegacyIpcFormat?4:8,u=a+o+r&~r,l=u-a-o;return e.headerType===Yt.RecordBatch?this._recordBatchBlocks.push(new Fi(u,e.bodyLength,this._position)):e.headerType===Yt.DictionaryBatch&&this._dictionaryBlocks.push(new Fi(u,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(u-o)),a>0&&this._write(s),this._writePadding(l)}_write(e){if(this._started){const n=At(e);n&&n.byteLength>0&&(this._sink.write(n),this._position+=n.byteLength)}return this}_writeSchema(e){return this._writeMessage(Nn.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(xh)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:n,nodes:r,bufferRegions:s,buffers:a}=Ut.assemble(e),o=new Re(e.numRows,r,s),u=Nn.from(o,n);return this._writeDictionaries(e)._writeMessage(u)._writeBodyBuffers(a)}_writeDictionaryBatch(e,n,r=!1){this._dictionaryDeltaOffsets.set(n,e.length+(this._dictionaryDeltaOffsets.get(n)||0));const{byteLength:s,nodes:a,bufferRegions:o,buffers:u}=Ut.assemble(new wt([e])),l=new Re(e.length,a,o),c=new Un(l,n,r),h=Nn.from(c,s);return this._writeMessage(h)._writeBodyBuffers(u)}_writeBodyBuffers(e){let n,r,s;for(let a=-1,o=e.length;++a<o;)(n=e[a])&&(r=n.byteLength)>0&&(this._write(n),(s=(r+7&-8)-r)>0&&this._writePadding(s));return this}_writeDictionaries(e){for(let[n,r]of e.dictionaries){let s=this._dictionaryDeltaOffsets.get(n)||0;if(s===0||(r=r==null?void 0:r.slice(s)).length>0)for(const a of r.data)this._writeDictionaryBatch(a,n,s>0),s+=a.length}return this}}class Ih extends pg{static writeAll(e,n){const r=new Ih(n);return fu(e)?e.then(s=>r.writeAll(s)):du(e)?Ch(r,e):Ah(r,e)}}class Th extends pg{static writeAll(e){const n=new Th;return fu(e)?e.then(r=>n.writeAll(r)):du(e)?Ch(n,e):Ah(n,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){const n=Ul.encode(new Ul(e,le.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(n)._write(Int32Array.of(n.byteLength))._writeMagic()}}function Ah(t,e){let n=e;e instanceof xe&&(n=e.batches,t.reset(void 0,e.schema));for(const r of n)t.write(r);return t.finish()}function Ch(t,e){var n,r,s,a,o,u,l;return Kn(this,void 0,void 0,function*(){try{for(n=!0,r=$s(e);s=yield r.next(),a=s.done,!a;n=!0){l=s.value,n=!1;const c=l;t.write(c)}}catch(c){o={error:c}}finally{try{!n&&!a&&(u=r.return)&&(yield u.call(r))}finally{if(o)throw o.error}}return t.finish()})}function lC(t,e="stream"){return(e==="stream"?Ih:Th).writeAll(t).toUint8Array(!0)}function kh(t,e=1){return(t*e+63&-64||64)/e}function Li(t,e,n=t.BYTES_PER_ELEMENT){return new t(kh(e,n))}function Mh(t){return t instanceof Tt?t:new Tt(t.type,0,t.length,t.nulls,t.buffers,null,t.dict)}function cC(t){return new wt([Mh(t)])}const Nh=new TextEncoder;function hC(t,e,n){const r=Nh.encode(n);return t.set(r,e),r.length}function fC(t,e,n){return Nh.encodeInto(n,t.subarray(e)).written}const dC=Nh.encodeInto?fC:hC;function Ld(t,e){const n=Li(t.ArrayType,e);return{set(r,s){n[s]=r},data:()=>({type:t,length:e,buffers:[null,n]})}}function pC(t,e){const n=Li(t.ArrayType,e/8);return{set(r,s){r&&(n[s>>3]|=1<<s%8)},data:()=>({type:t,length:e,buffers:[null,n]})}}function mC(t,e){const n=Li(t.ArrayType,e);return{set(r,s){n[s]=r/864e5|0},data:()=>({type:t,length:e,buffers:[null,n]})}}function yC(t,e){const n=Li(t.ArrayType,e<<1);return{set(r,s){const a=s<<1;n[a]=r%4294967296|0,n[a+1]=r/4294967296|0},data:()=>({type:t,length:e,buffers:[null,n]})}}function gC(t){const e=jo({type:t,nullValues:[null,void 0]});return{set(n,r){e.set(r,n)},data:()=>e.finish().flush()}}function vC(t,e,n){const r=Li(Int32Array,e+1),s=Li(Uint8Array,3*n);let a=0;return{set(o,u){a+=dC(s,a,o),r[u+1]=a},data:()=>{const o=kh(a),u=s.length>o?s.subarray(0,o):s;return{type:t,length:e,buffers:[r,u]}}}}function _C(t,e){const n=[],r=Li(t.indices.ArrayType,e),s=Object.create(null);let a=-1,o=0;return{set(u,l){const c=String(u);let h=s[c];h===void 0&&(o+=c.length,s[c]=h=++a,n.push(c)),r[l]=h},data:()=>({type:t,length:e,buffers:[null,r],dict:bC(t.dictionary,n,o)})}}function bC(t,e,n){const r=vC(t,e.length,n);return e.forEach(r.set),cC(r.data())}function wC(t,e){const n=Li(Uint8Array,e/8);let r=0;return{set(s,a){s==null?++r:(t.set(s,a),n[a>>3]|=1<<a%8)},data:()=>{const s=t.data();return r&&(s.nulls=r,s.buffers[2]=n),s}}}function xC(t,e,n=!0){let r;switch(t.typeId){case w.Int:r=t.bitWidth<64?Ld:null;break;case w.Float:r=t.precision>0?Ld:null;break;case w.Dictionary:r=t.dictionary.typeId===w.Utf8&&t.indices.typeId===w.Int&&t.indices.bitWidth<64?_C:null;break;case w.Bool:r=pC;break;case w.Date:r=t.unit?yC:mC;break}return r==null?gC(t):n?wC(r(t,e),e):r(t,e)}function SC(t,e){const n=t.length,r=kh(n,t.BYTES_PER_ELEMENT);let s=t;return n!==r&&(s=new t.constructor(r),s.set(t)),Mh({type:e,length:n,buffers:[null,s]})}function mg(t,e,n,r,s=!0){const a=xC(r,t,s);return e(n,a.set),Mh(a.data())}function Eh(t){if(t instanceof et||t==null)return t;switch(t){case w.Binary:return new ia;case w.Bool:return new ra;case w.DateDay:return new NT;case w.DateMillisecond:case w.Date:return new ET;case w.Dictionary:return new Oi(new Qr,new Ni);case w.Float16:return new L0;case w.Float32:return new Hc;case w.Float64:case w.Float:return new Yc;case w.Int8:return new Vc;case w.Int16:return new Uc;case w.Int32:case w.Int:return new Ni;case w.Int64:return new $c;case w.IntervalDayTime:return new RT;case w.Interval:case w.IntervalYearMonth:return new LT;case w.Null:return new si;case w.TimeMicrosecond:return new FT;case w.TimeMillisecond:case w.Time:return new DT;case w.TimeNanosecond:return new BT;case w.TimeSecond:return new OT;case w.Uint8:return new jc;case w.Uint16:return new zc;case w.Uint32:return new qc;case w.Uint64:return new Wc;case w.Utf8:return new Qr;default:it(`Unsupported type code: ${Bn(t)}. Use a data type constructor instead?`)}}function IC(t){return t.getUTCHours()===0&&t.getUTCMinutes()===0&&t.getUTCSeconds()===0&&t.getUTCMilliseconds()===0}function yg(t,e){const n=Hl();return t(e,n.add),n}function Hl(){const t={count:0,nulls:0,bools:0,nums:0,ints:0,bigints:0,min:1/0,max:-1/0,digits:0,dates:0,utcdays:0,strings:0,strlen:0,arrays:0,minlen:1/0,maxlen:0,structs:0,add(e){if(++t.count,e==null){++t.nulls;return}const n=typeof e;if(n==="string")++t.strings;else if(n==="number")++t.nums,e<t.min&&(t.min=e),e>t.max&&(t.max=e),Number.isInteger(e)&&++t.ints;else if(n==="boolean")++t.bools;else if(n==="object")if(ri(e))++t.dates,IC(e)&&++t.utcdays;else if(Qi(e)){++t.arrays,e.length<t.minlen&&(t.minlen=e.length),e.length>t.maxlen&&(t.maxlen=e.length);const r=t.array_prof||(t.array_prof=Hl());e.forEach(r.add)}else{++t.structs;const r=t.struct_prof||(t.struct_prof={});for(const s in e)(r[s]||(r[s]=Hl())).add(e[s])}else n==="bigint"&&(++t.bigints,e<t.min&&(t.min=e),e>t.max&&(t.max=e))},type(){return Eh(TC(t))}};return t}function TC(t){const e=t.count-t.nulls;if(e===0)return w.Null;if(t.ints===e){const n=Math.max(Math.abs(t.min)-1,t.max);return t.min<0?n>=2**31?w.Float64:n<128?w.Int8:n<32768?w.Int16:w.Int32:n>=2**32?w.Float64:n<256?w.Uint8:n<65536?w.Uint16:w.Uint32}else{if(t.nums===e)return w.Float64;if(t.bigints===e){const n=-t.min>t.max?-t.min-1n:t.max;return t.min<0?n<2**63?w.Int64:it(`BigInt exceeds 64 bits: ${n}`):t.max<2**64?w.Uint64:it(`BigInt exceeds 64 bits: ${t.max}`)}else{if(t.bools===e)return w.Bool;if(t.utcdays===e)return w.DateDay;if(t.dates===e)return w.DateMillisecond;if(t.arrays===e){const n=St.new("value",t.array_prof.type(),!0);return t.minlen===t.maxlen?new ts(t.minlen,n):new Zr(n)}else if(t.structs===e){const n=t.struct_prof;return new ne(Object.keys(n).map(r=>St.new(r,n[r].type(),!0)))}else{if(t.strings>0)return w.Dictionary;it("Type inference failure")}}}}function AC(t,e,n,r,s,a=!0){if(s=Eh(s),!s){const o=yg(r,e);a=o.nulls>0,s=o.type()}return mg(n,r,e,s,a)}function CC(t,e,n,r,s,a=!0){s=Eh(s);const o=t.column(e),u=!(t.isFiltered()||t.isOrdered()),l=kC(o);if(l&&u&&Pd(l.type,s))return l;const c=o.data;if(va(c)){const h=MC(c);if(u&&h&&Pd(h,s))return SC(c,h);s=s||h,a=!1}if(!s){const h=yg(r,o);a=h.nulls>0,s=h.type()}return mg(n,r,o,s,a)}function kC(t){return t instanceof wt?t:t.vector instanceof wt?t.vector:null}function MC(t){const n={Float32Array:Hc,Float64Array:Yc,Int8Array:Vc,Int16Array:Uc,Int32Array:Ni,Uint8Array:jc,Uint16Array:zc,Uint32Array:qc,BigInt64Array:$c,BigUint64Array:Wc}[t.constructor.name];return n?new n:null}function Pd(t,e){return!t||!e?!0:t.compareTo(e)}function NC(t,e,n){const r=Math.min(t.length,n+e);return(s,a)=>{for(let o=n;o<r;++o)a(t[o][s],o)}}function EC(t,e,n){const r=n===0&&t.numRows()<=e&&!t.isFiltered()&&!t.isOrdered();return(s,a)=>{let o=-1;r&&Qi(s.data)?s.data.forEach(a):t.scan(u=>a(s.get(u),++o),!0,e,n)}}const OC=()=>it("Apache Arrow not imported, see https://github.com/uwdata/arquero#usage");function DC(){try{return xe}catch{OC()}}function gg(t,e={}){const{types:n={}}=e,{dataFrom:r,names:s,nrows:a,scan:o}=FC(t,e),u={};s.forEach(c=>{const h=r(t,c,a,o,n[c]);h.length!==a&&it("Column length mismatch"),u[c]=h});const l=DC();return new l(u)}function FC(t,e){const{columns:n,limit:r=1/0,offset:s=0}=e,a=Ot(n)?n(t):bt(n)?n:null;if(bt(t))return{dataFrom:AC,names:a||Object.keys(t[0]),nrows:Math.min(r,t.length-s),scan:NC(t,r,s)};if(BC(t))return{dataFrom:CC,names:a||t.columnNames(),nrows:Math.min(r,t.numRows()-s),scan:EC(t,r,s)};it("Unsupported input data type")}function BC(t){return t&&Ot(t.reify)}function RC(t,e={}){const{format:n,...r}=e,s=n||"stream";if(!["stream","file"].includes(s))throw Error("Unrecognised output format");return lC(gg(t,r),n)}function LC(t){return t.getUTCHours()===0&&t.getUTCMinutes()===0&&t.getUTCSeconds()===0&&t.getUTCMilliseconds()===0}function PC(t,e={}){let n=0,r=0,s=0,a=0,o=0,u=0;return t(l=>{if(++n,l==null){++r;return}const c=typeof l;if(c==="object"&&ri(l))++s,LC(l)&&++a;else if(c==="number"&&(++o,l===l&&(l|0)!==l)){const h=l+"",f=h.indexOf(".");if(f>=0){const d=h.indexOf("e"),m=d>0?d:h.length;u=Math.max(u,m-f-1)}}}),{align:(r+o+s)/n>.5?"r":"l",format:{utc:s===a,digits:Math.min(u,e.maxdigits||6)}}}function xu(t,e){return Ot(e)?e(t):e||t.columnNames()}function vg(t,e,n){const r=n.format||{},s=n.align||{},a={},o={};return e.forEach(u=>{const l=PC(VC(t,u),n);o[u]=s[u]||l.align,a[u]=r[u]||l.format}),{align:o,format:a}}function VC(t,e){const n=t.column(e);return r=>t.scan(s=>r(n.get(s)))}function Oh(t,e,n=100,r,s){const a=t.data(),o=e.length;t.scan(u=>{s.row(u);for(let l=0;l<o;++l){const c=e[l];s.cell(a[e[l]].get(u),c,l)}},!0,n,r)}function UC(t,e={}){const n=xu(t,e.columns),r=e.format||{},s=e.delimiter||",",a=new RegExp(`["${s}
\r]`),o=c=>c==null?"":ri(c)?cu(c,!0):a.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c,u=n.map(o);let l="";return Oh(t,n,e.limit||1/0,e.offset,{row(){l+=u.join(s)+`
`},cell(c,h,f){u[f]=o(r[h]?r[h](c):c)}}),l+u.join(s)}function _g(t,e={}){if(Ot(e))return e(t)+"";const n=typeof t;if(n==="object"){if(ri(t))return e.utc?cu(t):$m(t);{const r=JSON.stringify(t,(a,o)=>va(o)?Array.from(o):o),s=e.maxlen||30;return r.length>s?r.slice(0,28)+"…"+(r[0]==="["?"]":"}"):r}}else if(n==="number"){const r=e.digits||0;let s;return t!==0&&((s=Math.abs(t))>=1e18||s<Math.pow(10,-r))?t.toExponential(r):t.toFixed(r)}else return t+""}function Su(t,e,n={}){for(const r in t)n[r]=e(t[r],r);return n}function $C(t,e={}){const n=xu(t,e.columns),{align:r,format:s}=vg(t,n,e),a=jC(e),o=e.null,u=g=>g==="c"?"center":g==="r"?"right":"left",l=g=>g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c=(g,y)=>l(_g(g,y)),h=o?(g,y)=>g==null?o(g):c(g,y):c;let f=-1,d=-1;const m=(g,y,_)=>{const b=_?u(r[y]):"",A=a[g]&&a[g](y,d,f)||"",S=(b?`text-align: ${b};`+(A?" ":""):"")+A;return`<${g}${S?` style="${S}"`:""}>`};let p=m("table")+m("thead")+m("tr",f)+n.map(g=>`${m("th",g,1)}${g}</th>`).join("")+"</tr></thead>"+m("tbody");return Oh(t,n,e.limit,e.offset,{row(g){f=g,p+=(++d?"</tr>":"")+m("tr")},cell(g,y){p+=m("td",y,1)+h(g,s[y])+"</td>"}}),p+"</tr></tbody></table>"}function jC(t){return Su(t.style,e=>Ot(e)?e:()=>e)}function zC(t,e=!0,n=!1){return t===void 0||t?e:n}const qC=t=>ri(t)?cu(t,!0):t;function WC(t,e={}){const n=zC(e.schema),r=e.format||{},s=xu(t,e.columns);let a="{";return n&&(a+='"schema":{"fields":'+JSON.stringify(s.map(o=>({name:o})))+'},"data":{'),s.forEach((o,u)=>{a+=(u?",":"")+JSON.stringify(o)+":[";const l=t.column(o),c=r[o]||qC;let h=-1;t.scan(f=>{const d=l.get(f);a+=(++h?",":"")+JSON.stringify(c(d))},!0,e.limit,e.offset),a+="]"}),a+"}"+(n?"}":"")}function HC(t,e={}){const n=xu(t,e.columns),{align:r,format:s}=vg(t,n,e),a=l=>l==="c"?":-:":l==="r"?"-:":":-",o=l=>l.replace(/\|/g,"\\|");let u="|"+n.map(o).join("|")+`|
|`+n.map(l=>a(r[l])).join("|")+"|";return Oh(t,n,e.limit,e.offset,{row(){u+=`
|`},cell(l,c){u+=o(_g(l,s[c]))+"|"}}),u+`
`}function bg(t,e){for(const[n,r]of hu(e))t.set(n,r);return t}function YC(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function oi(t,e,n=new Map){return e=ce(e)?t.columnName(e):e,te(e)?n.set(e,e):bt(e)?e.forEach(r=>oi(t,r,n)):Ot(e)?oi(t,e(t),n):re(e)?bg(n,e):it(`Invalid column selection: ${Bn(e)}`),n}function Iu(t,e){return t.toObject=e,t}function wg(t){return bt(t)?t.map(wg):t&&t.toObject?t.toObject():t}function is(){return Iu(t=>t.columnNames(),()=>({all:[]}))}function xg(...t){return t=t.flat(),Iu(e=>{const n=oi(e,t);return e.columnNames(r=>!n.has(r))},()=>({not:wg(t)}))}function GC(t,e){return Iu(n=>{let r=ce(t)?t:n.columnIndex(t),s=ce(e)?e:n.columnIndex(e);if(s<r){const a=s;s=r,r=a}return n.columnNames().slice(r,s+1)},()=>({range:[t,e]}))}function KC(t){return te(t)&&(t=RegExp(YC(t))),Iu(e=>e.columnNames(n=>t.test(n)),()=>({matches:[t.source,t.flags]}))}function QC(t){return va(t.data)?t.data.constructor:Array}class En extends dI{static from(e,n){return new En(yI(e,n),n)}static new(e,n){if(e instanceof En)return e;const r={},s=[];for(const[a,o]of hu(e))r[a]=o,s.push(a);return new En(r,n||s)}constructor(e,n,r,s,a,o){Su(e,mI,e),n=n||Object.keys(e);const u=n.length?e[n[0]].length:0;super(n,u,e,r,s,a,o)}create({data:e,names:n,filter:r,groups:s,order:a}){const o=r!==void 0?r:this.mask();return new En(e||this._data,n||(e?null:this._names),o,s!==void 0?s:WI(this._group,r&&o),a!==void 0?a:this._order,this._params)}assign(...e){const n=this.numRows(),r=this.reify(),s=Le(r).groupby(r.groups());return e.forEach(a=>{a=En.new(a),a.numRows()!==n&&it("Assign row counts do not match"),a=a.reify(),a.columnNames(o=>s.add(o,a.column(o)))}),this.create(s.new())}columns(){return this._data}column(e){return this._data[e]}columnAt(e){return this._data[this._names[e]]}array(e,n=Array){const r=this.column(e),s=new n(this.numRows());let a=-1;return this.scan(o=>s[++a]=r.get(o),!0),s}get(e,n=0){const r=this.column(e);return this.isFiltered()||this.isOrdered()?r.get(this.indices()[n]):r.get(n)}getter(e){const n=this.column(e),r=this.isFiltered()||this.isOrdered()?this.indices():null;return r?s=>n.get(r[s]):n?s=>n.get(s):it(`Unrecognized column: ${e}`)}object(e=0){return Vd(this)(e)}objects(e={}){const{grouped:n,limit:r,offset:s}=e,a=oi(this,e.columns||is()),o=f0(a),u=[];if(this.scan((l,c)=>u.push(o(l,c)),!0,r,s),n&&this.isGrouped()){const l=[];return this.scan(c=>l.push(c),!0,r,s),YI(this,l,u,n)}return u}*[Symbol.iterator](){const e=Vd(this),n=this.numRows();for(let r=0;r<n;++r)yield e(r)}reify(e){const n=e?e.length:this.numRows(),r=this._names;let s,a;if(!e&&!this.isOrdered())if(this.isFiltered())n===this.totalRows()&&(s=this.data());else return this;if(!s){const o=e?l=>e.forEach(l):l=>this.scan(l,!0),u=r.length;s={};for(let l=0;l<u;++l){const c=r[l],h=this.column(c),f=s[c]=new(QC(h))(n);let d=-1;o(m=>f[++d]=h.get(m))}this.isGrouped()&&(a=HI(this.groups(),o,!!e,n))}return this.create({data:s,names:r,groups:a,filter:null,order:null})}transform(...e){return e.flat().reduce((n,r)=>r(n),this)}toArrow(e){return gg(this,e)}toArrowBuffer(e){return RC(this,e)}toCSV(e){return UC(this,e)}toHTML(e){return $C(this,e)}toJSON(e){return WC(this,e)}toMarkdown(e){return HC(this,e)}}function Vd(t){let e=t._builder;if(!e){const n=f0(t.columnNames()),r=t.data();if(t.isOrdered()||t.isFiltered()){const s=t.indices();e=a=>n(s[a],r)}else e=s=>n(s,r);t._builder=e}return e}class JC{constructor(e){this._outputs=e}size(){return this._outputs.length}outputs(){return this._outputs}init(){return{}}add(){}rem(){}write(){}}function pt(t,e,n,r){const s=n[t.type]||n.Default;if(s&&s(t,e,r)===!1)return;const a=XC[t.type];a&&a(t,e,n)}const qa=(t,e,n)=>{pt(t.argument,e,n,t)},ul=(t,e,n)=>{pt(t.left,e,n,t),pt(t.right,e,n,t)},Ud=(t,e,n)=>{pt(t.test,e,n,t),pt(t.consequent,e,n,t),t.alternate&&pt(t.alternate,e,n,t)},ll=(t,e,n)=>{wn(t.params,e,n,t),pt(t.body,e,n,t)},$d=(t,e,n)=>{pt(t.callee,e,n,t),wn(t.arguments,e,n,t)},wn=(t,e,n,r)=>{t.forEach(s=>pt(s,e,n,r))},XC={TemplateLiteral:(t,e,n)=>{wn(t.expressions,e,n,t),wn(t.quasis,e,n,t)},MemberExpression:(t,e,n)=>{pt(t.object,e,n,t),pt(t.property,e,n,t)},CallExpression:$d,NewExpression:$d,ArrayExpression:(t,e,n)=>{wn(t.elements,e,n,t)},AssignmentExpression:ul,AwaitExpression:qa,BinaryExpression:ul,LogicalExpression:ul,UnaryExpression:qa,UpdateExpression:qa,ConditionalExpression:Ud,ObjectExpression:(t,e,n)=>{wn(t.properties,e,n,t)},Property:(t,e,n)=>{pt(t.key,e,n,t),pt(t.value,e,n,t)},ArrowFunctionExpression:ll,FunctionExpression:ll,FunctionDeclaration:ll,VariableDeclaration:(t,e,n)=>{wn(t.declarations,e,n,t)},VariableDeclarator:(t,e,n)=>{pt(t.id,e,n,t),pt(t.init,e,n,t)},SpreadElement:(t,e,n)=>{pt(t.argument,e,n,t)},BlockStatement:(t,e,n)=>{wn(t.body,e,n,t)},ExpressionStatement:(t,e,n)=>{pt(t.expression,e,n,t)},IfStatement:Ud,ForStatement:(t,e,n)=>{pt(t.init,e,n,t),pt(t.test,e,n,t),pt(t.update,e,n,t),pt(t.body,e,n,t)},WhileStatement:(t,e,n)=>{pt(t.test,e,n,t),pt(t.body,e,n,t)},DoWhileStatement:(t,e,n)=>{pt(t.body,e,n,t),pt(t.test,e,n,t)},SwitchStatement:(t,e,n)=>{pt(t.discriminant,e,n,t),wn(t.cases,e,n,t)},SwitchCase:(t,e,n)=>{t.test&&pt(t.test,e,n,t),wn(t.consequent,e,n,t)},ReturnStatement:qa,Program:(t,e,n)=>{pt(t.body[0],e,n,t)}};function Sg(t){delete t.start,delete t.end,delete t.optional}function jd(t){Sg(t),delete t.object,delete t.property,delete t.computed,t.table||delete t.table}function ZC(t){return pt(t,null,{Column:jd,Constant:jd,Default:Sg}),t}function zt(t,e){return e&&e.type===t}function tk(t){return zt(QI,t)||zt(KI,t)}function ek(t){return Ot(t)?t:()=>t}const nk="Escaped functions are not valid as rollup or pivot values.";function ik(t,e,n){t.aggronly&&it(nk);const r="(row,data)=>fn("+h0(t.table.columnNames())+",$)";return{escape:Fc.escape(r,ek(e.expr),n)}}var rk=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],Ig=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],sk="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࢘-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",Tg="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",cl={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},hl="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",ak={5:hl,"5module":hl+" export import",6:hl+" const class extends export import super"},ok=/^in(stanceof)?$/,uk=new RegExp("["+Tg+"]"),lk=new RegExp("["+Tg+sk+"]");function Yl(t,e){for(var n=65536,r=0;r<e.length;r+=2){if(n+=e[r],n>t)return!1;if(n+=e[r+1],n>=t)return!0}return!1}function ui(t,e){return t<65?t===36:t<91?!0:t<97?t===95:t<123?!0:t<=65535?t>=170&&uk.test(String.fromCharCode(t)):e===!1?!1:Yl(t,Ig)}function rs(t,e){return t<48?t===36:t<58?!0:t<65?!1:t<91?!0:t<97?t===95:t<123?!0:t<=65535?t>=170&&lk.test(String.fromCharCode(t)):e===!1?!1:Yl(t,Ig)||Yl(t,rk)}var gt=function(e,n){n===void 0&&(n={}),this.label=e,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function Ve(t,e){return new gt(t,{beforeExpr:!0,binop:e})}var Ue={beforeExpr:!0},me={startsExpr:!0},Dh={};function ct(t,e){return e===void 0&&(e={}),e.keyword=t,Dh[t]=new gt(t,e)}var v={num:new gt("num",me),regexp:new gt("regexp",me),string:new gt("string",me),name:new gt("name",me),privateId:new gt("privateId",me),eof:new gt("eof"),bracketL:new gt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new gt("]"),braceL:new gt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new gt("}"),parenL:new gt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new gt(")"),comma:new gt(",",Ue),semi:new gt(";",Ue),colon:new gt(":",Ue),dot:new gt("."),question:new gt("?",Ue),questionDot:new gt("?."),arrow:new gt("=>",Ue),template:new gt("template"),invalidTemplate:new gt("invalidTemplate"),ellipsis:new gt("...",Ue),backQuote:new gt("`",me),dollarBraceL:new gt("${",{beforeExpr:!0,startsExpr:!0}),eq:new gt("=",{beforeExpr:!0,isAssign:!0}),assign:new gt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new gt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new gt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ve("||",1),logicalAND:Ve("&&",2),bitwiseOR:Ve("|",3),bitwiseXOR:Ve("^",4),bitwiseAND:Ve("&",5),equality:Ve("==/!=/===/!==",6),relational:Ve("</>/<=/>=",7),bitShift:Ve("<</>>/>>>",8),plusMin:new gt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ve("%",10),star:Ve("*",10),slash:Ve("/",10),starstar:new gt("**",{beforeExpr:!0}),coalesce:Ve("??",1),_break:ct("break"),_case:ct("case",Ue),_catch:ct("catch"),_continue:ct("continue"),_debugger:ct("debugger"),_default:ct("default",Ue),_do:ct("do",{isLoop:!0,beforeExpr:!0}),_else:ct("else",Ue),_finally:ct("finally"),_for:ct("for",{isLoop:!0}),_function:ct("function",me),_if:ct("if"),_return:ct("return",Ue),_switch:ct("switch"),_throw:ct("throw",Ue),_try:ct("try"),_var:ct("var"),_const:ct("const"),_while:ct("while",{isLoop:!0}),_with:ct("with"),_new:ct("new",{beforeExpr:!0,startsExpr:!0}),_this:ct("this",me),_super:ct("super",me),_class:ct("class",me),_extends:ct("extends",Ue),_export:ct("export"),_import:ct("import",me),_null:ct("null",me),_true:ct("true",me),_false:ct("false",me),_in:ct("in",{beforeExpr:!0,binop:7}),_instanceof:ct("instanceof",{beforeExpr:!0,binop:7}),_typeof:ct("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:ct("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:ct("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Qe=/\r\n?|\n|\u2028|\u2029/,ck=new RegExp(Qe.source,"g");function ys(t){return t===10||t===13||t===8232||t===8233}function Ag(t,e,n){n===void 0&&(n=t.length);for(var r=e;r<n;r++){var s=t.charCodeAt(r);if(ys(s))return r<n-1&&s===13&&t.charCodeAt(r+1)===10?r+2:r+1}return-1}var Cg=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,We=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,kg=Object.prototype,hk=kg.hasOwnProperty,fk=kg.toString,Ta=Object.hasOwn||function(t,e){return hk.call(t,e)},zd=Array.isArray||function(t){return fk.call(t)==="[object Array]"},qd=Object.create(null);function Ci(t){return qd[t]||(qd[t]=new RegExp("^(?:"+t.replace(/ /g,"|")+")$"))}function Pi(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}var dk=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,oa=function(e,n){this.line=e,this.column=n};oa.prototype.offset=function(e){return new oa(this.line,this.column+e)};var Tu=function(e,n,r){this.start=n,this.end=r,e.sourceFile!==null&&(this.source=e.sourceFile)};function Mg(t,e){for(var n=1,r=0;;){var s=Ag(t,r,e);if(s<0)return new oa(n,e-r);++n,r=s}}var Gl={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Wd=!1;function pk(t){var e={};for(var n in Gl)e[n]=t&&Ta(t,n)?t[n]:Gl[n];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!Wd&&typeof console=="object"&&console.warn&&(Wd=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!t||t.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),zd(e.onToken)){var r=e.onToken;e.onToken=function(s){return r.push(s)}}return zd(e.onComment)&&(e.onComment=mk(e,e.onComment)),e}function mk(t,e){return function(n,r,s,a,o,u){var l={type:n?"Block":"Line",value:r,start:s,end:a};t.locations&&(l.loc=new Tu(this,o,u)),t.ranges&&(l.range=[s,a]),e.push(l)}}var ua=1,gs=2,Fh=4,Ng=8,Eg=16,Og=32,Bh=64,Dg=128,Aa=256,Rh=ua|gs|Aa;function Lh(t,e){return gs|(t?Fh:0)|(e?Ng:0)}var Ho=0,Ph=1,mi=2,Fg=3,Bg=4,Rg=5,qt=function(e,n,r){this.options=e=pk(e),this.sourceFile=e.sourceFile,this.keywords=Ci(ak[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var s="";e.allowReserved!==!0&&(s=cl[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(s+=" await")),this.reservedWords=Ci(s);var a=(s?s+" ":"")+cl.strict;this.reservedWordsStrict=Ci(a),this.reservedWordsStrictBind=Ci(a+" "+cl.strictBind),this.input=String(n),this.containsEsc=!1,r?(this.pos=r,this.lineStart=this.input.lastIndexOf(`
`,r-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Qe).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=v.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ua),this.regexpState=null,this.privateNameStack=[]},jn={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};qt.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)};jn.inFunction.get=function(){return(this.currentVarScope().flags&gs)>0};jn.inGenerator.get=function(){return(this.currentVarScope().flags&Ng)>0&&!this.currentVarScope().inClassFieldInit};jn.inAsync.get=function(){return(this.currentVarScope().flags&Fh)>0&&!this.currentVarScope().inClassFieldInit};jn.canAwait.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t];if(e.inClassFieldInit||e.flags&Aa)return!1;if(e.flags&gs)return(e.flags&Fh)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};jn.allowSuper.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(e&Bh)>0||n||this.options.allowSuperOutsideMethod};jn.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Dg)>0};jn.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};jn.allowNewDotTarget.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(e&(gs|Aa))>0||n};jn.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Aa)>0};qt.extend=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];for(var r=this,s=0;s<e.length;s++)r=e[s](r);return r};qt.parse=function(e,n){return new this(n,e).parse()};qt.parseExpressionAt=function(e,n,r){var s=new this(r,e,n);return s.nextToken(),s.parseExpression()};qt.tokenizer=function(e,n){return new this(n,e)};Object.defineProperties(qt.prototype,jn);var de=qt.prototype,yk=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;de.strictDirective=function(t){if(this.options.ecmaVersion<5)return!1;for(;;){We.lastIndex=t,t+=We.exec(this.input)[0].length;var e=yk.exec(this.input.slice(t));if(!e)return!1;if((e[1]||e[2])==="use strict"){We.lastIndex=t+e[0].length;var n=We.exec(this.input),r=n.index+n[0].length,s=this.input.charAt(r);return s===";"||s==="}"||Qe.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(s)||s==="!"&&this.input.charAt(r+1)==="=")}t+=e[0].length,We.lastIndex=t,t+=We.exec(this.input)[0].length,this.input[t]===";"&&t++}};de.eat=function(t){return this.type===t?(this.next(),!0):!1};de.isContextual=function(t){return this.type===v.name&&this.value===t&&!this.containsEsc};de.eatContextual=function(t){return this.isContextual(t)?(this.next(),!0):!1};de.expectContextual=function(t){this.eatContextual(t)||this.unexpected()};de.canInsertSemicolon=function(){return this.type===v.eof||this.type===v.braceR||Qe.test(this.input.slice(this.lastTokEnd,this.start))};de.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};de.semicolon=function(){!this.eat(v.semi)&&!this.insertSemicolon()&&this.unexpected()};de.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};de.expect=function(t){this.eat(t)||this.unexpected()};de.unexpected=function(t){this.raise(t??this.start,"Unexpected token")};var Au=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};de.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,e?"Assigning to rvalue":"Parenthesized pattern")}};de.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")};de.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};de.isSimpleAssignTarget=function(t){return t.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(t.expression):t.type==="Identifier"||t.type==="MemberExpression"};var V=qt.prototype;V.parseTopLevel=function(t){var e=Object.create(null);for(t.body||(t.body=[]);this.type!==v.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var r=0,s=Object.keys(this.undefinedExports);r<s.length;r+=1){var a=s[r];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var Vh={kind:"loop"},gk={kind:"switch"};V.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;We.lastIndex=this.pos;var e=We.exec(this.input),n=this.pos+e[0].length,r=this.input.charCodeAt(n);if(r===91||r===92)return!0;if(t)return!1;if(r===123||r>55295&&r<56320)return!0;if(ui(r,!0)){for(var s=n+1;rs(r=this.input.charCodeAt(s),!0);)++s;if(r===92||r>55295&&r<56320)return!0;var a=this.input.slice(n,s);if(!ok.test(a))return!0}return!1};V.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;We.lastIndex=this.pos;var t=We.exec(this.input),e=this.pos+t[0].length,n;return!Qe.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(rs(n=this.input.charCodeAt(e+8))||n>55295&&n<56320))};V.parseStatement=function(t,e,n){var r=this.type,s=this.startNode(),a;switch(this.isLet(t)&&(r=v._var,a="let"),r){case v._break:case v._continue:return this.parseBreakContinueStatement(s,r.keyword);case v._debugger:return this.parseDebuggerStatement(s);case v._do:return this.parseDoStatement(s);case v._for:return this.parseForStatement(s);case v._function:return t&&(this.strict||t!=="if"&&t!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!t);case v._class:return t&&this.unexpected(),this.parseClass(s,!0);case v._if:return this.parseIfStatement(s);case v._return:return this.parseReturnStatement(s);case v._switch:return this.parseSwitchStatement(s);case v._throw:return this.parseThrowStatement(s);case v._try:return this.parseTryStatement(s);case v._const:case v._var:return a=a||this.value,t&&a!=="var"&&this.unexpected(),this.parseVarStatement(s,a);case v._while:return this.parseWhileStatement(s);case v._with:return this.parseWithStatement(s);case v.braceL:return this.parseBlock(!0,s);case v.semi:return this.parseEmptyStatement(s);case v._export:case v._import:if(this.options.ecmaVersion>10&&r===v._import){We.lastIndex=this.pos;var o=We.exec(this.input),u=this.pos+o[0].length,l=this.input.charCodeAt(u);if(l===40||l===46)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===v._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!t);var c=this.value,h=this.parseExpression();return r===v.name&&h.type==="Identifier"&&this.eat(v.colon)?this.parseLabeledStatement(s,c,h,t):this.parseExpressionStatement(s,h)}};V.parseBreakContinueStatement=function(t,e){var n=e==="break";this.next(),this.eat(v.semi)||this.insertSemicolon()?t.label=null:this.type!==v.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var s=this.labels[r];if((t.label==null||s.name===t.label.name)&&(s.kind!=null&&(n||s.kind==="loop")||t.label&&n))break}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")};V.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")};V.parseDoStatement=function(t){return this.next(),this.labels.push(Vh),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(v._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(v.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")};V.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Vh),this.enterScope(0),this.expect(v.parenL),this.type===v.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===v._var||this.type===v._const||n){var r=this.startNode(),s=n?"let":this.value;return this.next(),this.parseVar(r,!0,s),this.finishNode(r,"VariableDeclaration"),(this.type===v._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&r.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===v._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,r)):(e>-1&&this.unexpected(e),this.parseFor(t,r))}var a=this.isContextual("let"),o=!1,u=new Au,l=this.parseExpression(e>-1?"await":!0,u);return this.type===v._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===v._in?e>-1&&this.unexpected(e):t.await=e>-1),a&&o&&this.raise(l.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(l,!1,u),this.checkLValPattern(l),this.parseForIn(t,l)):(this.checkExpressionErrors(u,!0),e>-1&&this.unexpected(e),this.parseFor(t,l))};V.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,zs|(n?0:Kl),!1,e)};V.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(v._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")};V.parseReturnStatement=function(t){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(v.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")};V.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(v.braceL),this.labels.push(gk),this.enterScope(0);for(var e,n=!1;this.type!==v.braceR;)if(this.type===v._case||this.type===v._default){var r=this.type===v._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(v.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")};V.parseThrowStatement=function(t){return this.next(),Qe.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var vk=[];V.parseCatchClauseParam=function(){var t=this.parseBindingAtom(),e=t.type==="Identifier";return this.enterScope(e?Og:0),this.checkLValPattern(t,e?Bg:mi),this.expect(v.parenR),t};V.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===v._catch){var e=this.startNode();this.next(),this.eat(v.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(v._finally)?this.parseBlock():null,!t.handler&&!t.finalizer&&this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")};V.parseVarStatement=function(t,e,n){return this.next(),this.parseVar(t,!1,e,n),this.semicolon(),this.finishNode(t,"VariableDeclaration")};V.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(Vh),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")};V.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")};V.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")};V.parseLabeledStatement=function(t,e,n,r){for(var s=0,a=this.labels;s<a.length;s+=1){var o=a[s];o.name===e&&this.raise(n.start,"Label '"+e+"' is already declared")}for(var u=this.type.isLoop?"loop":this.type===v._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===t.start)c.statementStart=this.start,c.kind=u;else break}return this.labels.push({name:e,kind:u,statementStart:this.start}),t.body=this.parseStatement(r?r.indexOf("label")===-1?r+"label":r:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")};V.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")};V.parseBlock=function(t,e,n){for(t===void 0&&(t=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(v.braceL),t&&this.enterScope(0);this.type!==v.braceR;){var r=this.parseStatement(null);e.body.push(r)}return n&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")};V.parseFor=function(t,e){return t.init=e,this.expect(v.semi),t.test=this.type===v.semi?null:this.parseExpression(),this.expect(v.semi),t.update=this.type===v.parenR?null:this.parseExpression(),this.expect(v.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")};V.parseForIn=function(t,e){var n=this.type===v._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(v.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")};V.parseVar=function(t,e,n,r){for(t.declarations=[],t.kind=n;;){var s=this.startNode();if(this.parseVarId(s,n),this.eat(v.eq)?s.init=this.parseMaybeAssign(e):!r&&n==="const"&&!(this.type===v._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!r&&s.id.type!=="Identifier"&&!(e&&(this.type===v._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):s.init=null,t.declarations.push(this.finishNode(s,"VariableDeclarator")),!this.eat(v.comma))break}return t};V.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLValPattern(t.id,e==="var"?Ph:mi,!1)};var zs=1,Kl=2,Lg=4;V.parseFunction=function(t,e,n,r,s){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===v.star&&e&Kl&&this.unexpected(),t.generator=this.eat(v.star)),this.options.ecmaVersion>=8&&(t.async=!!r),e&zs&&(t.id=e&Lg&&this.type!==v.name?null:this.parseIdent(),t.id&&!(e&Kl)&&this.checkLValSimple(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?Ph:mi:Fg));var a=this.yieldPos,o=this.awaitPos,u=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Lh(t.async,t.generator)),e&zs||(t.id=this.type===v.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1,s),this.yieldPos=a,this.awaitPos=o,this.awaitIdentPos=u,this.finishNode(t,e&zs?"FunctionDeclaration":"FunctionExpression")};V.parseFunctionParams=function(t){this.expect(v.parenL),t.params=this.parseBindingList(v.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};V.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var r=this.enterClassBody(),s=this.startNode(),a=!1;for(s.body=[],this.expect(v.braceL);this.type!==v.braceR;){var o=this.parseClassElement(t.superClass!==null);o&&(s.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(a&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),a=!0):o.key&&o.key.type==="PrivateIdentifier"&&_k(r,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=n,this.next(),t.body=this.finishNode(s,"ClassBody"),this.exitClassBody(),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")};V.parseClassElement=function(t){if(this.eat(v.semi))return null;var e=this.options.ecmaVersion,n=this.startNode(),r="",s=!1,a=!1,o="method",u=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(v.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===v.star?u=!0:r="static"}if(n.static=u,!r&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===v.star)&&!this.canInsertSemicolon()?a=!0:r="async"),!r&&(e>=9||!a)&&this.eat(v.star)&&(s=!0),!r&&!a&&!s){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:r=l)}if(r?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=r,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),e<13||this.type===v.parenL||o!=="method"||s||a){var c=!n.static&&Yo(n,"constructor"),h=c&&t;c&&o!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=c?"constructor":o,this.parseClassMethod(n,s,a,h)}else this.parseClassField(n);return n};V.isClassElementNameStart=function(){return this.type===v.name||this.type===v.privateId||this.type===v.num||this.type===v.string||this.type===v.bracketL||this.type.keyword};V.parseClassElementName=function(t){this.type===v.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),t.computed=!1,t.key=this.parsePrivateIdent()):this.parsePropertyName(t)};V.parseClassMethod=function(t,e,n,r){var s=t.key;t.kind==="constructor"?(e&&this.raise(s.start,"Constructor can't be a generator"),n&&this.raise(s.start,"Constructor can't be an async method")):t.static&&Yo(t,"prototype")&&this.raise(s.start,"Classes may not have a static property named prototype");var a=t.value=this.parseMethod(e,n,r);return t.kind==="get"&&a.params.length!==0&&this.raiseRecoverable(a.start,"getter should have no params"),t.kind==="set"&&a.params.length!==1&&this.raiseRecoverable(a.start,"setter should have exactly one param"),t.kind==="set"&&a.params[0].type==="RestElement"&&this.raiseRecoverable(a.params[0].start,"Setter cannot use rest params"),this.finishNode(t,"MethodDefinition")};V.parseClassField=function(t){if(Yo(t,"constructor")?this.raise(t.key.start,"Classes can't have a field named 'constructor'"):t.static&&Yo(t,"prototype")&&this.raise(t.key.start,"Classes can't have a static field named 'prototype'"),this.eat(v.eq)){var e=this.currentThisScope(),n=e.inClassFieldInit;e.inClassFieldInit=!0,t.value=this.parseMaybeAssign(),e.inClassFieldInit=n}else t.value=null;return this.semicolon(),this.finishNode(t,"PropertyDefinition")};V.parseClassStaticBlock=function(t){t.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Aa|Bh);this.type!==v.braceR;){var n=this.parseStatement(null);t.body.push(n)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(t,"StaticBlock")};V.parseClassId=function(t,e){this.type===v.name?(t.id=this.parseIdent(),e&&this.checkLValSimple(t.id,mi,!1)):(e===!0&&this.unexpected(),t.id=null)};V.parseClassSuper=function(t){t.superClass=this.eat(v._extends)?this.parseExprSubscripts(null,!1):null};V.enterClassBody=function(){var t={declared:Object.create(null),used:[]};return this.privateNameStack.push(t),t.declared};V.exitClassBody=function(){var t=this.privateNameStack.pop(),e=t.declared,n=t.used;if(this.options.checkPrivateFields)for(var r=this.privateNameStack.length,s=r===0?null:this.privateNameStack[r-1],a=0;a<n.length;++a){var o=n[a];Ta(e,o.name)||(s?s.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function _k(t,e){var n=e.key.name,r=t[n],s="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(s=(e.static?"s":"i")+e.kind),r==="iget"&&s==="iset"||r==="iset"&&s==="iget"||r==="sget"&&s==="sset"||r==="sset"&&s==="sget"?(t[n]="true",!1):r?!0:(t[n]=s,!1)}function Yo(t,e){var n=t.computed,r=t.key;return!n&&(r.type==="Identifier"&&r.name===e||r.type==="Literal"&&r.value===e)}V.parseExportAllDeclaration=function(t,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseModuleExportName(),this.checkExport(e,t.exported,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==v.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration")};V.parseExport=function(t,e){if(this.next(),this.eat(v.star))return this.parseExportAllDeclaration(t,e);if(this.eat(v._default))return this.checkExport(e,"default",this.lastTokStart),t.declaration=this.parseExportDefaultDeclaration(),this.finishNode(t,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())t.declaration=this.parseExportDeclaration(t),t.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==v.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var n=0,r=t.specifiers;n<r.length;n+=1){var s=r[n];this.checkUnreserved(s.local),this.checkLocalExport(s.local),s.local.type==="Literal"&&this.raise(s.local.start,"A string literal cannot be used as an exported binding without `from`.")}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")};V.parseExportDeclaration=function(t){return this.parseStatement(null)};V.parseExportDefaultDeclaration=function(){var t;if(this.type===v._function||(t=this.isAsyncFunction())){var e=this.startNode();return this.next(),t&&this.next(),this.parseFunction(e,zs|Lg,!1,t)}else if(this.type===v._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var r=this.parseMaybeAssign();return this.semicolon(),r}};V.checkExport=function(t,e,n){t&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),Ta(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)};V.checkPatternExport=function(t,e){var n=e.type;if(n==="Identifier")this.checkExport(t,e,e.start);else if(n==="ObjectPattern")for(var r=0,s=e.properties;r<s.length;r+=1){var a=s[r];this.checkPatternExport(t,a)}else if(n==="ArrayPattern")for(var o=0,u=e.elements;o<u.length;o+=1){var l=u[o];l&&this.checkPatternExport(t,l)}else n==="Property"?this.checkPatternExport(t,e.value):n==="AssignmentPattern"?this.checkPatternExport(t,e.left):n==="RestElement"&&this.checkPatternExport(t,e.argument)};V.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1){var s=r[n];this.checkPatternExport(t,s.id)}};V.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};V.parseExportSpecifier=function(t){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(t,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};V.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(v.braceL);!this.eat(v.braceR);){if(n)n=!1;else if(this.expect(v.comma),this.afterTrailingComma(v.braceR))break;e.push(this.parseExportSpecifier(t))}return e};V.parseImport=function(t){return this.next(),this.type===v.string?(t.specifiers=vk,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===v.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")};V.parseImportSpecifier=function(){var t=this.startNode();return t.imported=this.parseModuleExportName(),this.eatContextual("as")?t.local=this.parseIdent():(this.checkUnreserved(t.imported),t.local=t.imported),this.checkLValSimple(t.local,mi),this.finishNode(t,"ImportSpecifier")};V.parseImportDefaultSpecifier=function(){var t=this.startNode();return t.local=this.parseIdent(),this.checkLValSimple(t.local,mi),this.finishNode(t,"ImportDefaultSpecifier")};V.parseImportNamespaceSpecifier=function(){var t=this.startNode();return this.next(),this.expectContextual("as"),t.local=this.parseIdent(),this.checkLValSimple(t.local,mi),this.finishNode(t,"ImportNamespaceSpecifier")};V.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===v.name&&(t.push(this.parseImportDefaultSpecifier()),!this.eat(v.comma)))return t;if(this.type===v.star)return t.push(this.parseImportNamespaceSpecifier()),t;for(this.expect(v.braceL);!this.eat(v.braceR);){if(e)e=!1;else if(this.expect(v.comma),this.afterTrailingComma(v.braceR))break;t.push(this.parseImportSpecifier())}return t};V.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===v.string){var t=this.parseLiteral(this.value);return dk.test(t.value)&&this.raise(t.start,"An export name cannot include a lone surrogate."),t}return this.parseIdent(!0)};V.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)};V.isDirectiveCandidate=function(t){return this.options.ecmaVersion>=5&&t.type==="ExpressionStatement"&&t.expression.type==="Literal"&&typeof t.expression.value=="string"&&(this.input[t.start]==='"'||this.input[t.start]==="'")};var Je=qt.prototype;Je.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&t.name==="await"&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,s=t.properties;r<s.length;r+=1){var a=s[r];this.toAssignable(a,e),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":t.kind!=="init"&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),t.argument.type==="AssignmentPattern"&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":t.operator!=="="&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t};Je.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var s=t[r];s&&this.toAssignable(s,e)}if(n){var a=t[n-1];this.options.ecmaVersion===6&&e&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return t};Je.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")};Je.parseRestBinding=function(){var t=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==v.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")};Je.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case v.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(v.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case v.braceL:return this.parseObj(!0)}return this.parseIdent()};Je.parseBindingList=function(t,e,n,r){for(var s=[],a=!0;!this.eat(t);)if(a?a=!1:this.expect(v.comma),e&&this.type===v.comma)s.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===v.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),s.push(o),this.type===v.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}else s.push(this.parseAssignableListItem(r))}return s};Je.parseAssignableListItem=function(t){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};Je.parseBindingListItem=function(t){return t};Je.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(v.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")};Je.checkLValSimple=function(t,e,n){e===void 0&&(e=Ho);var r=e!==Ho;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(r?"Binding ":"Assigning to ")+t.name+" in strict mode"),r&&(e===mi&&t.name==="let"&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),n&&(Ta(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),e!==Rg&&this.declareName(t.name,e,t.start));break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":r&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ParenthesizedExpression":return r&&this.raiseRecoverable(t.start,"Binding parenthesized expression"),this.checkLValSimple(t.expression,e,n);default:this.raise(t.start,(r?"Binding":"Assigning to")+" rvalue")}};Je.checkLValPattern=function(t,e,n){switch(e===void 0&&(e=Ho),t.type){case"ObjectPattern":for(var r=0,s=t.properties;r<s.length;r+=1){var a=s[r];this.checkLValInnerPattern(a,e,n)}break;case"ArrayPattern":for(var o=0,u=t.elements;o<u.length;o+=1){var l=u[o];l&&this.checkLValInnerPattern(l,e,n)}break;default:this.checkLValSimple(t,e,n)}};Je.checkLValInnerPattern=function(t,e,n){switch(e===void 0&&(e=Ho),t.type){case"Property":this.checkLValInnerPattern(t.value,e,n);break;case"AssignmentPattern":this.checkLValPattern(t.left,e,n);break;case"RestElement":this.checkLValPattern(t.argument,e,n);break;default:this.checkLValPattern(t,e,n)}};var Xe=function(e,n,r,s,a){this.token=e,this.isExpr=!!n,this.preserveSpace=!!r,this.override=s,this.generator=!!a},Bt={b_stat:new Xe("{",!1),b_expr:new Xe("{",!0),b_tmpl:new Xe("${",!1),p_stat:new Xe("(",!1),p_expr:new Xe("(",!0),q_tmpl:new Xe("`",!0,!0,function(t){return t.tryReadTemplateToken()}),f_stat:new Xe("function",!1),f_expr:new Xe("function",!0),f_expr_gen:new Xe("function",!0,!1,null,!0),f_gen:new Xe("function",!1,!1,null,!0)},vs=qt.prototype;vs.initialContext=function(){return[Bt.b_stat]};vs.curContext=function(){return this.context[this.context.length-1]};vs.braceIsBlock=function(t){var e=this.curContext();return e===Bt.f_expr||e===Bt.f_stat?!0:t===v.colon&&(e===Bt.b_stat||e===Bt.b_expr)?!e.isExpr:t===v._return||t===v.name&&this.exprAllowed?Qe.test(this.input.slice(this.lastTokEnd,this.start)):t===v._else||t===v.semi||t===v.eof||t===v.parenR||t===v.arrow?!0:t===v.braceL?e===Bt.b_stat:t===v._var||t===v._const||t===v.name?!1:!this.exprAllowed};vs.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if(e.token==="function")return e.generator}return!1};vs.updateContext=function(t){var e,n=this.type;n.keyword&&t===v.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr};vs.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)};v.parenR.updateContext=v.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var t=this.context.pop();t===Bt.b_stat&&this.curContext().token==="function"&&(t=this.context.pop()),this.exprAllowed=!t.isExpr};v.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?Bt.b_stat:Bt.b_expr),this.exprAllowed=!0};v.dollarBraceL.updateContext=function(){this.context.push(Bt.b_tmpl),this.exprAllowed=!0};v.parenL.updateContext=function(t){var e=t===v._if||t===v._for||t===v._with||t===v._while;this.context.push(e?Bt.p_stat:Bt.p_expr),this.exprAllowed=!0};v.incDec.updateContext=function(){};v._function.updateContext=v._class.updateContext=function(t){t.beforeExpr&&t!==v._else&&!(t===v.semi&&this.curContext()!==Bt.p_stat)&&!(t===v._return&&Qe.test(this.input.slice(this.lastTokEnd,this.start)))&&!((t===v.colon||t===v.braceL)&&this.curContext()===Bt.b_stat)?this.context.push(Bt.f_expr):this.context.push(Bt.f_stat),this.exprAllowed=!1};v.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};v.backQuote.updateContext=function(){this.curContext()===Bt.q_tmpl?this.context.pop():this.context.push(Bt.q_tmpl),this.exprAllowed=!1};v.star.updateContext=function(t){if(t===v._function){var e=this.context.length-1;this.context[e]===Bt.f_expr?this.context[e]=Bt.f_expr_gen:this.context[e]=Bt.f_gen}this.exprAllowed=!0};v.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==v.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var Z=qt.prototype;Z.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&t.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r=t.key,s;switch(r.type){case"Identifier":s=r.name;break;case"Literal":s=String(r.value);break;default:return}var a=t.kind;if(this.options.ecmaVersion>=6){s==="__proto__"&&a==="init"&&(e.proto&&(n?n.doubleProto<0&&(n.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),e.proto=!0);return}s="$"+s;var o=e[s];if(o){var u;a==="init"?u=this.strict&&o.init||o.get||o.set:u=o.init||o[a],u&&this.raiseRecoverable(r.start,"Redefinition of property")}else o=e[s]={init:!1,get:!1,set:!1};o[a]=!0}};Z.parseExpression=function(t,e){var n=this.start,r=this.startLoc,s=this.parseMaybeAssign(t,e);if(this.type===v.comma){var a=this.startNodeAt(n,r);for(a.expressions=[s];this.eat(v.comma);)a.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(a,"SequenceExpression")}return s};Z.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var r=!1,s=-1,a=-1,o=-1;e?(s=e.parenthesizedAssign,a=e.trailingComma,o=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new Au,r=!0);var u=this.start,l=this.startLoc;(this.type===v.parenL||this.type===v.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=t==="await");var c=this.parseMaybeConditional(t,e);if(n&&(c=n.call(this,c,u,l)),this.type.isAssign){var h=this.startNodeAt(u,l);return h.operator=this.value,this.type===v.eq&&(c=this.toAssignable(c,!1,e)),r||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===v.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(t),o>-1&&(e.doubleProto=o),this.finishNode(h,"AssignmentExpression")}else r&&this.checkExpressionErrors(e,!0);return s>-1&&(e.parenthesizedAssign=s),a>-1&&(e.trailingComma=a),c};Z.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,s=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return s;if(this.eat(v.question)){var a=this.startNodeAt(n,r);return a.test=s,a.consequent=this.parseMaybeAssign(),this.expect(v.colon),a.alternate=this.parseMaybeAssign(t),this.finishNode(a,"ConditionalExpression")}return s};Z.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,s=this.parseMaybeUnary(e,!1,!1,t);return this.checkExpressionErrors(e)||s.start===n&&s.type==="ArrowFunctionExpression"?s:this.parseExprOp(s,n,r,-1,t)};Z.parseExprOp=function(t,e,n,r,s){var a=this.type.binop;if(a!=null&&(!s||this.type!==v._in)&&a>r){var o=this.type===v.logicalOR||this.type===v.logicalAND,u=this.type===v.coalesce;u&&(a=v.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,f=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,s),c,h,a,s),d=this.buildBinary(e,n,t,f,l,o||u);return(o&&this.type===v.coalesce||u&&(this.type===v.logicalOR||this.type===v.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,e,n,r,s)}return t};Z.buildBinary=function(t,e,n,r,s,a){r.type==="PrivateIdentifier"&&this.raise(r.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(t,e);return o.left=n,o.operator=s,o.right=r,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")};Z.parseMaybeUnary=function(t,e,n,r){var s=this.start,a=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(r),e=!0;else if(this.type.prefix){var u=this.startNode(),l=this.type===v.incDec;u.operator=this.value,u.prefix=!0,this.next(),u.argument=this.parseMaybeUnary(null,!0,l,r),this.checkExpressionErrors(t,!0),l?this.checkLValSimple(u.argument):this.strict&&u.operator==="delete"&&u.argument.type==="Identifier"?this.raiseRecoverable(u.start,"Deleting local variable in strict mode"):u.operator==="delete"&&Pg(u.argument)?this.raiseRecoverable(u.start,"Private fields can not be deleted"):e=!0,o=this.finishNode(u,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===v.privateId)(r||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==v._in&&this.unexpected();else{if(o=this.parseExprSubscripts(t,r),this.checkExpressionErrors(t))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(s,a);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!n&&this.eat(v.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(s,a,o,this.parseMaybeUnary(null,!1,!1,r),"**",!1);else return o};function Pg(t){return t.type==="MemberExpression"&&t.property.type==="PrivateIdentifier"||t.type==="ChainExpression"&&Pg(t.expression)}Z.parseExprSubscripts=function(t,e){var n=this.start,r=this.startLoc,s=this.parseExprAtom(t,e);if(s.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return s;var a=this.parseSubscripts(s,n,r,!1,e);return t&&a.type==="MemberExpression"&&(t.parenthesizedAssign>=a.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=a.start&&(t.parenthesizedBind=-1),t.trailingComma>=a.start&&(t.trailingComma=-1)),a};Z.parseSubscripts=function(t,e,n,r,s){for(var a=this.options.ecmaVersion>=8&&t.type==="Identifier"&&t.name==="async"&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start===5&&this.potentialArrowAt===t.start,o=!1;;){var u=this.parseSubscript(t,e,n,r,a,o,s);if(u.optional&&(o=!0),u===t||u.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(e,n);l.expression=u,u=this.finishNode(l,"ChainExpression")}return u}t=u}};Z.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(v.arrow)};Z.parseSubscriptAsyncArrow=function(t,e,n,r){return this.parseArrowExpression(this.startNodeAt(t,e),n,!0,r)};Z.parseSubscript=function(t,e,n,r,s,a,o){var u=this.options.ecmaVersion>=11,l=u&&this.eat(v.questionDot);r&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(v.bracketL);if(c||l&&this.type!==v.parenL&&this.type!==v.backQuote||this.eat(v.dot)){var h=this.startNodeAt(e,n);h.object=t,c?(h.property=this.parseExpression(),this.expect(v.bracketR)):this.type===v.privateId&&t.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,u&&(h.optional=l),t=this.finishNode(h,"MemberExpression")}else if(!r&&this.eat(v.parenL)){var f=new Au,d=this.yieldPos,m=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var g=this.parseExprList(v.parenR,this.options.ecmaVersion>=8,!1,f);if(s&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=m,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(e,n,g,o);this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var y=this.startNodeAt(e,n);y.callee=t,y.arguments=g,u&&(y.optional=l),t=this.finishNode(y,"CallExpression")}else if(this.type===v.backQuote){(l||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var _=this.startNodeAt(e,n);_.tag=t,_.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(_,"TaggedTemplateExpression")}return t};Z.parseExprAtom=function(t,e,n){this.type===v.slash&&this.readRegexp();var r,s=this.potentialArrowAt===this.start;switch(this.type){case v._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),r=this.startNode(),this.next(),this.type===v.parenL&&!this.allowDirectSuper&&this.raise(r.start,"super() call outside constructor of a subclass"),this.type!==v.dot&&this.type!==v.bracketL&&this.type!==v.parenL&&this.unexpected(),this.finishNode(r,"Super");case v._this:return r=this.startNode(),this.next(),this.finishNode(r,"ThisExpression");case v.name:var a=this.start,o=this.startLoc,u=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!u&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(v._function))return this.overrideContext(Bt.f_expr),this.parseFunction(this.startNodeAt(a,o),0,!1,!0,e);if(s&&!this.canInsertSemicolon()){if(this.eat(v.arrow))return this.parseArrowExpression(this.startNodeAt(a,o),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===v.name&&!u&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(v.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(a,o),[l],!0,e)}return l;case v.regexp:var c=this.value;return r=this.parseLiteral(c.value),r.regex={pattern:c.pattern,flags:c.flags},r;case v.num:case v.string:return this.parseLiteral(this.value);case v._null:case v._true:case v._false:return r=this.startNode(),r.value=this.type===v._null?null:this.type===v._true,r.raw=this.type.keyword,this.next(),this.finishNode(r,"Literal");case v.parenL:var h=this.start,f=this.parseParenAndDistinguishExpression(s,e);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(f)&&(t.parenthesizedAssign=h),t.parenthesizedBind<0&&(t.parenthesizedBind=h)),f;case v.bracketL:return r=this.startNode(),this.next(),r.elements=this.parseExprList(v.bracketR,!0,!0,t),this.finishNode(r,"ArrayExpression");case v.braceL:return this.overrideContext(Bt.b_expr),this.parseObj(!1,t);case v._function:return r=this.startNode(),this.next(),this.parseFunction(r,0);case v._class:return this.parseClass(this.startNode(),!1);case v._new:return this.parseNew();case v.backQuote:return this.parseTemplate();case v._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};Z.parseExprAtomDefault=function(){this.unexpected()};Z.parseExprImport=function(t){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===v.parenL&&!t)return this.parseDynamicImport(e);if(this.type===v.dot){var n=this.startNodeAt(e.start,e.loc&&e.loc.start);return n.name="import",e.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};Z.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),!this.eat(v.parenR)){var e=this.start;this.eat(v.comma)&&this.eat(v.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")};Z.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),t.property.name!=="meta"&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")};Z.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};Z.parseParenExpression=function(){this.expect(v.parenL);var t=this.parseExpression();return this.expect(v.parenR),t};Z.shouldParseArrow=function(t){return!this.canInsertSemicolon()};Z.parseParenAndDistinguishExpression=function(t,e){var n=this.start,r=this.startLoc,s,a=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,u=this.startLoc,l=[],c=!0,h=!1,f=new Au,d=this.yieldPos,m=this.awaitPos,p;for(this.yieldPos=0,this.awaitPos=0;this.type!==v.parenR;)if(c?c=!1:this.expect(v.comma),a&&this.afterTrailingComma(v.parenR,!0)){h=!0;break}else if(this.type===v.ellipsis){p=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===v.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var g=this.lastTokEnd,y=this.lastTokEndLoc;if(this.expect(v.parenR),t&&this.shouldParseArrow(l)&&this.eat(v.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=m,this.parseParenArrowList(n,r,l,e);(!l.length||h)&&this.unexpected(this.lastTokStart),p&&this.unexpected(p),this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,l.length>1?(s=this.startNodeAt(o,u),s.expressions=l,this.finishNodeAt(s,"SequenceExpression",g,y)):s=l[0]}else s=this.parseParenExpression();if(this.options.preserveParens){var _=this.startNodeAt(n,r);return _.expression=s,this.finishNode(_,"ParenthesizedExpression")}else return s};Z.parseParenItem=function(t){return t};Z.parseParenArrowList=function(t,e,n,r){return this.parseArrowExpression(this.startNodeAt(t,e),n,!1,r)};var bk=[];Z.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===v.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);e.name="new",t.meta=this.finishNode(e,"Identifier"),this.next();var n=this.containsEsc;return t.property=this.parseIdent(!0),t.property.name!=="target"&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(t.start,"'new.target' can only be used in functions and class static block"),this.finishNode(t,"MetaProperty")}var r=this.start,s=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),r,s,!0,!1),this.eat(v.parenL)?t.arguments=this.parseExprList(v.parenR,this.options.ecmaVersion>=8,!1):t.arguments=bk,this.finishNode(t,"NewExpression")};Z.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===v.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===v.backQuote,this.finishNode(n,"TemplateElement")};Z.parseTemplate=function(t){t===void 0&&(t={});var e=t.isTagged;e===void 0&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===v.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(v.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(v.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")};Z.isAsyncProp=function(t){return!t.computed&&t.key.type==="Identifier"&&t.key.name==="async"&&(this.type===v.name||this.type===v.num||this.type===v.string||this.type===v.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===v.star)&&!Qe.test(this.input.slice(this.lastTokEnd,this.start))};Z.parseObj=function(t,e){var n=this.startNode(),r=!0,s={};for(n.properties=[],this.next();!this.eat(v.braceR);){if(r)r=!1;else if(this.expect(v.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(v.braceR))break;var a=this.parseProperty(t,e);t||this.checkPropClash(a,s,e),n.properties.push(a)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")};Z.parseProperty=function(t,e){var n=this.startNode(),r,s,a,o;if(this.options.ecmaVersion>=9&&this.eat(v.ellipsis))return t?(n.argument=this.parseIdent(!1),this.type===v.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,e),this.type===v.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(t||e)&&(a=this.start,o=this.startLoc),t||(r=this.eat(v.star)));var u=this.containsEsc;return this.parsePropertyName(n),!t&&!u&&this.options.ecmaVersion>=8&&!r&&this.isAsyncProp(n)?(s=!0,r=this.options.ecmaVersion>=9&&this.eat(v.star),this.parsePropertyName(n)):s=!1,this.parsePropertyValue(n,t,r,s,a,o,e,u),this.finishNode(n,"Property")};Z.parseGetterSetter=function(t){t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var e=t.kind==="get"?0:1;if(t.value.params.length!==e){var n=t.value.start;t.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else t.kind==="set"&&t.value.params[0].type==="RestElement"&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")};Z.parsePropertyValue=function(t,e,n,r,s,a,o,u){(n||r)&&this.type===v.colon&&this.unexpected(),this.eat(v.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),t.kind="init"):this.options.ecmaVersion>=6&&this.type===v.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r)):!e&&!u&&this.options.ecmaVersion>=5&&!t.computed&&t.key.type==="Identifier"&&(t.key.name==="get"||t.key.name==="set")&&this.type!==v.comma&&this.type!==v.braceR&&this.type!==v.eq?((n||r)&&this.unexpected(),this.parseGetterSetter(t)):this.options.ecmaVersion>=6&&!t.computed&&t.key.type==="Identifier"?((n||r)&&this.unexpected(),this.checkUnreserved(t.key),t.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=s),t.kind="init",e?t.value=this.parseMaybeDefault(s,a,this.copyNode(t.key)):this.type===v.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),t.value=this.parseMaybeDefault(s,a,this.copyNode(t.key))):t.value=this.copyNode(t.key),t.shorthand=!0):this.unexpected()};Z.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(v.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(v.bracketR),t.key;t.computed=!1}return t.key=this.type===v.num||this.type===v.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Z.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)};Z.parseMethod=function(t,e,n){var r=this.startNode(),s=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Lh(e,r.generator)|Bh|(n?Dg:0)),this.expect(v.parenL),r.params=this.parseBindingList(v.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0,!1),this.yieldPos=s,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(r,"FunctionExpression")};Z.parseArrowExpression=function(t,e,n,r){var s=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(Lh(n,!1)|Eg),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1,r),this.yieldPos=s,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,"ArrowFunctionExpression")};Z.parseFunctionBody=function(t,e,n,r){var s=e&&this.type!==v.braceL,a=this.strict,o=!1;if(s)t.body=this.parseMaybeAssign(r),t.expression=!0,this.checkParams(t,!1);else{var u=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);(!a||u)&&(o=this.strictDirective(this.end),o&&u&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(t,!a&&!o&&!e&&!n&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLValSimple(t.id,Rg),t.body=this.parseBlock(!1,void 0,o&&!a),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=l}this.exitScope()};Z.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(r.type!=="Identifier")return!1}return!0};Z.checkParams=function(t,e){for(var n=Object.create(null),r=0,s=t.params;r<s.length;r+=1){var a=s[r];this.checkLValInnerPattern(a,Ph,e?null:n)}};Z.parseExprList=function(t,e,n,r){for(var s=[],a=!0;!this.eat(t);){if(a)a=!1;else if(this.expect(v.comma),e&&this.afterTrailingComma(t))break;var o=void 0;n&&this.type===v.comma?o=null:this.type===v.ellipsis?(o=this.parseSpread(r),r&&this.type===v.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):o=this.parseMaybeAssign(!1,r),s.push(o)}return s};Z.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;if(this.inGenerator&&r==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&r==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&r==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(r==="arguments"||r==="await")&&this.raise(e,"Cannot use "+r+" in class static initialization block"),this.keywords.test(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,n).indexOf("\\")!==-1)){var s=this.strict?this.reservedWordsStrict:this.reservedWords;s.test(r)&&(!this.inAsync&&r==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))}};Z.parseIdent=function(t){var e=this.parseIdentNode();return this.next(!!t),this.finishNode(e,"Identifier"),t||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};Z.parseIdentNode=function(){var t=this.startNode();return this.type===v.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,(t.name==="class"||t.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=v.name):this.unexpected(),t};Z.parsePrivateIdent=function(){var t=this.startNode();return this.type===v.privateId?t.name=this.value:this.unexpected(),this.next(),this.finishNode(t,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(t.start,"Private field '#"+t.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(t)),t};Z.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===v.semi||this.canInsertSemicolon()||this.type!==v.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(v.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")};Z.parseAwait=function(t){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,t),this.finishNode(e,"AwaitExpression")};var Go=qt.prototype;Go.raise=function(t,e){var n=Mg(this.input,t);e+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r};Go.raiseRecoverable=Go.raise;Go.curPosition=function(){if(this.options.locations)return new oa(this.curLine,this.pos-this.lineStart)};var qi=qt.prototype,wk=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};qi.enterScope=function(t){this.scopeStack.push(new wk(t))};qi.exitScope=function(){this.scopeStack.pop()};qi.treatFunctionsAsVarInScope=function(t){return t.flags&gs||!this.inModule&&t.flags&ua};qi.declareName=function(t,e,n){var r=!1;if(e===mi){var s=this.currentScope();r=s.lexical.indexOf(t)>-1||s.functions.indexOf(t)>-1||s.var.indexOf(t)>-1,s.lexical.push(t),this.inModule&&s.flags&ua&&delete this.undefinedExports[t]}else if(e===Bg){var a=this.currentScope();a.lexical.push(t)}else if(e===Fg){var o=this.currentScope();this.treatFunctionsAsVar?r=o.lexical.indexOf(t)>-1:r=o.lexical.indexOf(t)>-1||o.var.indexOf(t)>-1,o.functions.push(t)}else for(var u=this.scopeStack.length-1;u>=0;--u){var l=this.scopeStack[u];if(l.lexical.indexOf(t)>-1&&!(l.flags&Og&&l.lexical[0]===t)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(t)>-1){r=!0;break}if(l.var.push(t),this.inModule&&l.flags&ua&&delete this.undefinedExports[t],l.flags&Rh)break}r&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")};qi.checkLocalExport=function(t){this.scopeStack[0].lexical.indexOf(t.name)===-1&&this.scopeStack[0].var.indexOf(t.name)===-1&&(this.undefinedExports[t.name]=t)};qi.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};qi.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&Rh)return e}};qi.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&Rh&&!(e.flags&Eg))return e}};var Cu=function(e,n,r){this.type="",this.start=n,this.end=0,e.options.locations&&(this.loc=new Tu(e,r)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[n,0])},Ca=qt.prototype;Ca.startNode=function(){return new Cu(this,this.start,this.startLoc)};Ca.startNodeAt=function(t,e){return new Cu(this,t,e)};function Vg(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}Ca.finishNode=function(t,e){return Vg.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)};Ca.finishNodeAt=function(t,e,n,r){return Vg.call(this,t,e,n,r)};Ca.copyNode=function(t){var e=new Cu(this,t.start,this.startLoc);for(var n in t)e[n]=t[n];return e};var Ug="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",$g=Ug+" Extended_Pictographic",jg=$g,zg=jg+" EBase EComp EMod EPres ExtPict",qg=zg,xk=qg,Sk={9:Ug,10:$g,11:jg,12:zg,13:qg,14:xk},Ik="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Tk={9:"",10:"",11:"",12:"",13:"",14:Ik},Hd="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Wg="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Hg=Wg+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Yg=Hg+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Gg=Yg+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Kg=Gg+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Ak=Kg+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",Ck={9:Wg,10:Hg,11:Yg,12:Gg,13:Kg,14:Ak},Qg={};function kk(t){var e=Qg[t]={binary:Ci(Sk[t]+" "+Hd),binaryOfStrings:Ci(Tk[t]),nonBinary:{General_Category:Ci(Hd),Script:Ci(Ck[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var fl=0,Yd=[9,10,11,12,13,14];fl<Yd.length;fl+=1){var Mk=Yd[fl];kk(Mk)}var B=qt.prototype,zn=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Qg[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};zn.prototype.reset=function(e,n,r){var s=r.indexOf("v")!==-1,a=r.indexOf("u")!==-1;this.start=e|0,this.source=n+"",this.flags=r,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=a&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=a&&this.parser.options.ecmaVersion>=9)};zn.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)};zn.prototype.at=function(e,n){n===void 0&&(n=!1);var r=this.source,s=r.length;if(e>=s)return-1;var a=r.charCodeAt(e);if(!(n||this.switchU)||a<=55295||a>=57344||e+1>=s)return a;var o=r.charCodeAt(e+1);return o>=56320&&o<=57343?(a<<10)+o-56613888:a};zn.prototype.nextIndex=function(e,n){n===void 0&&(n=!1);var r=this.source,s=r.length;if(e>=s)return s;var a=r.charCodeAt(e),o;return!(n||this.switchU)||a<=55295||a>=57344||e+1>=s||(o=r.charCodeAt(e+1))<56320||o>57343?e+1:e+2};zn.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)};zn.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)};zn.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)};zn.prototype.eat=function(e,n){return n===void 0&&(n=!1),this.current(n)===e?(this.advance(n),!0):!1};zn.prototype.eatChars=function(e,n){n===void 0&&(n=!1);for(var r=this.pos,s=0,a=e;s<a.length;s+=1){var o=a[s],u=this.at(r,n);if(u===-1||u!==o)return!1;r=this.nextIndex(r,n)}return this.pos=r,!0};B.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=!1,s=!1,a=0;a<n.length;a++){var o=n.charAt(a);e.indexOf(o)===-1&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(o,a+1)>-1&&this.raise(t.start,"Duplicate regular expression flag"),o==="u"&&(r=!0),o==="v"&&(s=!0)}this.options.ecmaVersion>=15&&r&&s&&this.raise(t.start,"Invalid regular expression flag")};B.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))};B.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var r=n[e];t.groupNames.indexOf(r)===-1&&t.raise("Invalid named capture referenced")}};B.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")};B.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););};B.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))?(this.regexp_eatQuantifier(t),!0):!1};B.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1};B.regexp_eatQuantifier=function(t,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(t,e)?(t.eat(63),!0):!1};B.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)};B.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,s=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(s=t.lastIntValue),t.eat(125)))return s!==-1&&s<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1};B.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)};B.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1};B.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1};B.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):t.current()===63&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1};B.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)};B.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1};B.regexp_eatSyntaxCharacter=function(t){var e=t.current();return Jg(e)?(t.lastIntValue=e,t.advance(),!0):!1};function Jg(t){return t===36||t>=40&&t<=43||t===46||t===63||t>=91&&t<=94||t>=123&&t<=125}B.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;(n=t.current())!==-1&&!Jg(n);)t.advance();return t.pos!==e};B.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(t.advance(),!0):!1};B.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t)){t.groupNames.indexOf(t.lastStringValue)!==-1&&t.raise("Duplicate capture group name"),t.groupNames.push(t.lastStringValue);return}t.raise("Invalid group")}};B.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1};B.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=Pi(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=Pi(t.lastIntValue);return!0}return!1};B.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),r===92&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),Nk(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)};function Nk(t){return ui(t,!0)||t===36||t===95}B.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),r===92&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),Ek(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)};function Ek(t){return rs(t,!0)||t===36||t===95||t===8204||t===8205}B.regexp_eatAtomEscape=function(t){return this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t)?!0:(t.switchU&&(t.current()===99&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)};B.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1};B.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1};B.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)};B.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1};B.regexp_eatZero=function(t){return t.current()===48&&!ku(t.lookahead())?(t.lastIntValue=0,t.advance(),!0):!1};B.regexp_eatControlEscape=function(t){var e=t.current();return e===116?(t.lastIntValue=9,t.advance(),!0):e===110?(t.lastIntValue=10,t.advance(),!0):e===118?(t.lastIntValue=11,t.advance(),!0):e===102?(t.lastIntValue=12,t.advance(),!0):e===114?(t.lastIntValue=13,t.advance(),!0):!1};B.regexp_eatControlLetter=function(t){var e=t.current();return Xg(e)?(t.lastIntValue=e%32,t.advance(),!0):!1};function Xg(t){return t>=65&&t<=90||t>=97&&t<=122}B.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){e===void 0&&(e=!1);var n=t.pos,r=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var s=t.lastIntValue;if(r&&s>=55296&&s<=56319){var a=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var o=t.lastIntValue;if(o>=56320&&o<=57343)return t.lastIntValue=(s-55296)*1024+(o-56320)+65536,!0}t.pos=a,t.lastIntValue=s}return!0}if(r&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&Ok(t.lastIntValue))return!0;r&&t.raise("Invalid unicode escape"),t.pos=n}return!1};function Ok(t){return t>=0&&t<=1114111}B.regexp_eatIdentityEscape=function(t){if(t.switchU)return this.regexp_eatSyntaxCharacter(t)?!0:t.eat(47)?(t.lastIntValue=47,!0):!1;var e=t.current();return e!==99&&(!t.switchN||e!==107)?(t.lastIntValue=e,t.advance(),!0):!1};B.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do t.lastIntValue=10*t.lastIntValue+(e-48),t.advance();while((e=t.current())>=48&&e<=57);return!0}return!1};var Zg=0,li=1,He=2;B.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(Dk(e))return t.lastIntValue=-1,t.advance(),li;var n=!1;if(t.switchU&&this.options.ecmaVersion>=9&&((n=e===80)||e===112)){t.lastIntValue=-1,t.advance();var r;if(t.eat(123)&&(r=this.regexp_eatUnicodePropertyValueExpression(t))&&t.eat(125))return n&&r===He&&t.raise("Invalid property name"),r;t.raise("Invalid property name")}return Zg};function Dk(t){return t===100||t===68||t===115||t===83||t===119||t===87}B.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,r),li}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var s=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,s)}return Zg};B.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){Ta(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")};B.regexp_validateUnicodePropertyNameOrValue=function(t,e){if(t.unicodeProperties.binary.test(e))return li;if(t.switchV&&t.unicodeProperties.binaryOfStrings.test(e))return He;t.raise("Invalid property name")};B.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";t1(e=t.current());)t.lastStringValue+=Pi(e),t.advance();return t.lastStringValue!==""};function t1(t){return Xg(t)||t===95}B.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";Fk(e=t.current());)t.lastStringValue+=Pi(e),t.advance();return t.lastStringValue!==""};function Fk(t){return t1(t)||ku(t)}B.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)};B.regexp_eatCharacterClass=function(t){if(t.eat(91)){var e=t.eat(94),n=this.regexp_classContents(t);return t.eat(93)||t.raise("Unterminated character class"),e&&n===He&&t.raise("Negated character class may contain strings"),!0}return!1};B.regexp_classContents=function(t){return t.current()===93?li:t.switchV?this.regexp_classSetExpression(t):(this.regexp_nonEmptyClassRanges(t),li)};B.regexp_nonEmptyClassRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;t.switchU&&(e===-1||n===-1)&&t.raise("Invalid character class"),e!==-1&&n!==-1&&e>n&&t.raise("Range out of order in character class")}}};B.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(n===99||i1(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return r!==93?(t.lastIntValue=r,t.advance(),!0):!1};B.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)};B.regexp_classSetExpression=function(t){var e=li,n;if(!this.regexp_eatClassSetRange(t))if(n=this.regexp_eatClassSetOperand(t)){n===He&&(e=He);for(var r=t.pos;t.eatChars([38,38]);){if(t.current()!==38&&(n=this.regexp_eatClassSetOperand(t))){n!==He&&(e=li);continue}t.raise("Invalid character in character class")}if(r!==t.pos)return e;for(;t.eatChars([45,45]);)this.regexp_eatClassSetOperand(t)||t.raise("Invalid character in character class");if(r!==t.pos)return e}else t.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(t)){if(n=this.regexp_eatClassSetOperand(t),!n)return e;n===He&&(e=He)}};B.regexp_eatClassSetRange=function(t){var e=t.pos;if(this.regexp_eatClassSetCharacter(t)){var n=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassSetCharacter(t)){var r=t.lastIntValue;return n!==-1&&r!==-1&&n>r&&t.raise("Range out of order in character class"),!0}t.pos=e}return!1};B.regexp_eatClassSetOperand=function(t){return this.regexp_eatClassSetCharacter(t)?li:this.regexp_eatClassStringDisjunction(t)||this.regexp_eatNestedClass(t)};B.regexp_eatNestedClass=function(t){var e=t.pos;if(t.eat(91)){var n=t.eat(94),r=this.regexp_classContents(t);if(t.eat(93))return n&&r===He&&t.raise("Negated character class may contain strings"),r;t.pos=e}if(t.eat(92)){var s=this.regexp_eatCharacterClassEscape(t);if(s)return s;t.pos=e}return null};B.regexp_eatClassStringDisjunction=function(t){var e=t.pos;if(t.eatChars([92,113])){if(t.eat(123)){var n=this.regexp_classStringDisjunctionContents(t);if(t.eat(125))return n}else t.raise("Invalid escape");t.pos=e}return null};B.regexp_classStringDisjunctionContents=function(t){for(var e=this.regexp_classString(t);t.eat(124);)this.regexp_classString(t)===He&&(e=He);return e};B.regexp_classString=function(t){for(var e=0;this.regexp_eatClassSetCharacter(t);)e++;return e===1?li:He};B.regexp_eatClassSetCharacter=function(t){var e=t.pos;if(t.eat(92))return this.regexp_eatCharacterEscape(t)||this.regexp_eatClassSetReservedPunctuator(t)?!0:t.eat(98)?(t.lastIntValue=8,!0):(t.pos=e,!1);var n=t.current();return n<0||n===t.lookahead()&&Bk(n)||Rk(n)?!1:(t.advance(),t.lastIntValue=n,!0)};function Bk(t){return t===33||t>=35&&t<=38||t>=42&&t<=44||t===46||t>=58&&t<=64||t===94||t===96||t===126}function Rk(t){return t===40||t===41||t===45||t===47||t>=91&&t<=93||t>=123&&t<=125}B.regexp_eatClassSetReservedPunctuator=function(t){var e=t.current();return Lk(e)?(t.lastIntValue=e,t.advance(),!0):!1};function Lk(t){return t===33||t===35||t===37||t===38||t===44||t===45||t>=58&&t<=62||t===64||t===96||t===126}B.regexp_eatClassControlLetter=function(t){var e=t.current();return ku(e)||e===95?(t.lastIntValue=e%32,t.advance(),!0):!1};B.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1};B.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;ku(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e};function ku(t){return t>=48&&t<=57}B.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;e1(n=t.current());)t.lastIntValue=16*t.lastIntValue+n1(n),t.advance();return t.pos!==e};function e1(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function n1(t){return t>=65&&t<=70?10+(t-65):t>=97&&t<=102?10+(t-97):t-48}B.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=e*64+n*8+t.lastIntValue:t.lastIntValue=e*8+n}else t.lastIntValue=e;return!0}return!1};B.regexp_eatOctalDigit=function(t){var e=t.current();return i1(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)};function i1(t){return t>=48&&t<=55}B.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var r=0;r<e;++r){var s=t.current();if(!e1(s))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+n1(s),t.advance()}return!0};var Uh=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new Tu(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},ut=qt.prototype;ut.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Uh(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};ut.getToken=function(){return this.next(),new Uh(this)};typeof Symbol<"u"&&(ut[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===v.eof,value:e}}}});ut.nextToken=function(){var t=this.curContext();if((!t||!t.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(v.eof);if(t.override)return t.override(this);this.readToken(this.fullCharCodeAtPos())};ut.readToken=function(t){return ui(t,this.options.ecmaVersion>=6)||t===92?this.readWord():this.getTokenFromCode(t)};ut.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?t:(t<<10)+e-56613888};ut.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var r=void 0,s=e;(r=Ag(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=r;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,n),e,this.pos,t,this.curPosition())};ut.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!ys(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())};ut.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(t>8&&t<14||t>=5760&&Cg.test(String.fromCharCode(t)))++this.pos;else break t}}};ut.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)};ut.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&t===46&&e===46?(this.pos+=3,this.finishToken(v.ellipsis)):(++this.pos,this.finishToken(v.dot))};ut.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):t===61?this.finishOp(v.assign,2):this.finishOp(v.slash,1)};ut.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=t===42?v.star:v.modulo;return this.options.ecmaVersion>=7&&t===42&&e===42&&(++n,r=v.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(v.assign,n+1):this.finishOp(r,n)};ut.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);if(e===t){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(v.assign,3)}return this.finishOp(t===124?v.logicalOR:v.logicalAND,2)}return e===61?this.finishOp(v.assign,2):this.finishOp(t===124?v.bitwiseOR:v.bitwiseAND,1)};ut.readToken_caret=function(){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(v.assign,2):this.finishOp(v.bitwiseXOR,1)};ut.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Qe.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(v.incDec,2):e===61?this.finishOp(v.assign,2):this.finishOp(v.plusMin,1)};ut.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=t===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(v.assign,n+1):this.finishOp(v.bitShift,n)):e===33&&t===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(n=2),this.finishOp(v.relational,n))};ut.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(v.equality,this.input.charCodeAt(this.pos+2)===61?3:2):t===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(v.arrow)):this.finishOp(t===61?v.eq:v.prefix,1)};ut.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(v.questionDot,2)}if(e===63){if(t>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(v.assign,3)}return this.finishOp(v.coalesce,2)}}return this.finishOp(v.question,1)};ut.readToken_numberSign=function(){var t=this.options.ecmaVersion,e=35;if(t>=13&&(++this.pos,e=this.fullCharCodeAtPos(),ui(e,!0)||e===92))return this.finishToken(v.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Pi(e)+"'")};ut.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(v.parenL);case 41:return++this.pos,this.finishToken(v.parenR);case 59:return++this.pos,this.finishToken(v.semi);case 44:return++this.pos,this.finishToken(v.comma);case 91:return++this.pos,this.finishToken(v.bracketL);case 93:return++this.pos,this.finishToken(v.bracketR);case 123:return++this.pos,this.finishToken(v.braceL);case 125:return++this.pos,this.finishToken(v.braceR);case 58:return++this.pos,this.finishToken(v.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(v.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(v.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Pi(t)+"'")};ut.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)};ut.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(Qe.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if(r==="[")e=!0;else if(r==="]"&&e)e=!1;else if(r==="/"&&!e)break;t=r==="\\"}++this.pos}var s=this.input.slice(n,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var u=this.regexpState||(this.regexpState=new zn(this));u.reset(n,s,o),this.validateRegExpFlags(u),this.validateRegExpPattern(u);var l=null;try{l=new RegExp(s,o)}catch{}return this.finishToken(v.regexp,{pattern:s,flags:o,value:l})};ut.readInt=function(t,e,n){for(var r=this.options.ecmaVersion>=12&&e===void 0,s=n&&this.input.charCodeAt(this.pos)===48,a=this.pos,o=0,u=0,l=0,c=e??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),f=void 0;if(r&&h===95){s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),u===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),u=h;continue}if(h>=97?f=h-97+10:h>=65?f=h-65+10:h>=48&&h<=57?f=h-48:f=1/0,f>=t)break;u=h,o=o*t+f}return r&&u===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||e!=null&&this.pos-a!==e?null:o};function Pk(t,e){return e?parseInt(t,8):parseFloat(t.replace(/_/g,""))}function r1(t){return typeof BigInt!="function"?null:BigInt(t.replace(/_/g,""))}ut.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return n==null&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=r1(this.input.slice(e,this.pos)),++this.pos):ui(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(v.num,n)};ut.readNumber=function(t){var e=this.pos;!t&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var n=this.pos-e>=2&&this.input.charCodeAt(e)===48;n&&this.strict&&this.raise(e,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&r===110){var s=r1(this.input.slice(e,this.pos));return++this.pos,ui(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(v.num,s)}n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1),r===46&&!n&&(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),(r===69||r===101)&&!n&&(r=this.input.charCodeAt(++this.pos),(r===43||r===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),ui(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=Pk(this.input.slice(e,this.pos),n);return this.finishToken(v.num,a)};ut.readCodePoint=function(){var t=this.input.charCodeAt(this.pos),e;if(t===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else e=this.readHexChar(4);return e};ut.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===t)break;r===92?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):r===8232||r===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(ys(r)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(v.string,e)};var s1={};ut.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t===s1)this.readInvalidTemplateToken();else throw t}this.inTemplateElement=!1};ut.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw s1;this.raise(t,e)};ut.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===v.template||this.type===v.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(v.dollarBraceL)):(++this.pos,this.finishToken(v.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(v.template,t));if(n===92)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(ys(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:t+=`
`;break;default:t+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};ut.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(v.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")};ut.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Pi(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],s=parseInt(r,8);return s>255&&(r=r.slice(0,-1),s=parseInt(r,8)),this.pos+=r.length-1,e=this.input.charCodeAt(this.pos),(r!=="0"||e===56||e===57)&&(this.strict||t)&&this.invalidStringToken(this.pos-1-r.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(s)}return ys(e)?"":String.fromCharCode(e)}};ut.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return n===null&&this.invalidStringToken(e,"Bad character escape sequence"),n};ut.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var s=this.fullCharCodeAtPos();if(rs(s,r))this.pos+=s<=65535?1:2;else if(s===92){this.containsEsc=!0,t+=this.input.slice(n,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?ui:rs)(o,r)||this.invalidStringToken(a,"Invalid Unicode escape"),t+=Pi(o),n=this.pos}else break;e=!1}return t+this.input.slice(n,this.pos)};ut.readWord=function(){var t=this.readWord1(),e=v.name;return this.keywords.test(t)&&(e=Dh[t]),this.finishToken(e,t)};var Vk="8.11.3";qt.acorn={Parser:qt,version:Vk,defaultOptions:Gl,Position:oa,SourceLocation:Tu,getLineInfo:Mg,Node:Cu,TokenType:gt,tokTypes:v,keywordTypes:Dh,TokContext:Xe,tokContexts:Bt,isIdentifierChar:rs,isIdentifierStart:ui,Token:Uh,isNewLine:ys,lineBreak:Qe,lineBreakG:ck,nonASCIIwhitespace:Cg};function Uk(t,e){return qt.parse(t,e)}const $h={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},$k={ecmaVersion:11},Gd="$",jk="d",zk="d1",qk="d2",Jt=t=>(e,n)=>n.error(e,t+" not allowed"),Wk=Jt("Aggregate function"),Hk=Jt("Window function"),Yk="Invalid argument",jh="Invalid column reference",Gk=jh+" (must be input to an aggregate function)",a1="Invalid function call",Kk="Invalid member expression",Qk="Invalid operator parameter",Jk="Invalid param reference",Xk="Invalid variable reference",Zk="Variable not accessible in operator call",tM="Unsupported variable declaration",eM="Unsupported destructuring pattern",o1="Table expressions do not support closures",u1="Use aq.escape(fn) to use a function as-is (including closures)",nM="use table.params({ name: value }) to define dynamic parameters",iM="use aq.addFunction(name, fn) to add new op functions",rM=`
Note: ${o1}. ${u1}, or ${nM}.`,l1=`
Note: ${o1}. ${u1}, or ${iM}.`,sM=`The ${l0} method is not valid in multi-table expressions.`;function aM(t,e){const n=oM(e);let r=t.root=n;return t.spec=e,t.tuple=null,t.tuple1=null,t.tuple2=null,t.$param=null,t.$op=0,t.scope=new Set,t.paramsRef=new Map,t.columnRef=new Map,tk(r)?(lM(r,t),r=r.body):t.join?(t.scope.add(t.tuple1=zk),t.scope.add(t.tuple2=qk),t.scope.add(t.$param=Gd)):(t.scope.add(t.tuple=jk),t.scope.add(t.$param=Gd)),pt(r,t,zh),t.root}function oM(t){try{const e=t.field?uM(t):bt(t)?Bn(t):t;return Uk(`expr=(${e})`,$k).body[0].expression.right}catch{it(`Expression parse error: ${t+""}`)}}function uM(t){const e=JSON.stringify(t+"");return t.table?`(a,b)=>b[${e}]`:`d=>d[${e}]`}const zh={FunctionDeclaration:Jt("Function definitions"),ForStatement:Jt("For loops"),ForOfStatement:Jt("For-of loops"),ForInStatement:Jt("For-in loops"),WhileStatement:Jt("While loops"),DoWhileStatement:Jt("Do-while loops"),AwaitExpression:Jt("Await expressions"),ArrowFunctionExpression:Jt("Function definitions"),AssignmentExpression:Jt("Assignments"),FunctionExpression:Jt("Function definitions"),NewExpression:Jt('Use of "new"'),UpdateExpression:Jt("Update expressions"),VariableDeclarator(t,e){Xl(t.id,e)},Identifier(t,e,n){f1(t,e,n)&&!e.scope.has(t.name)&&e.error(t,Xk,rM)},CallExpression(t,e){const n=c1(t.callee),r=a0(n)||o0(n);if(r){if((e.join||e.aggregate===!1)&&Oc(n)&&Wk(t,e),(e.join||e.window===!1)&&Dc(n)&&Hk(t,e),e.$op=1,e.ast)Jl(t,n,e),t.arguments.forEach(s=>pt(s,e,Ql));else{const s=e.op(cM(e,r,n,t.arguments));Object.assign(t,{type:e0,name:s.id})}return e.$op=0,!1}else s0(n)?Jl(t,n,e):e.error(t,a1,l1)},MemberExpression(t,e,n){const{object:r,property:s}=t;if(!zt(ki,r))return;const{name:a}=r;if(h1(t)&&zt(ki,s)&&hn($h,s.name)){m1(t,s.name);return}const o=a===e.tuple?0:a===e.tuple1?1:a===e.tuple2?2:-1;if(o>=0)return Kd(t,o,e,d1,n);if(a===e.$param)return Kd(t,o,e,fM);e.paramsRef.has(a)?la(t,e.paramsRef.get(a)):e.columnRef.has(a)?p1(r,a,e,t):hn(e.params,a)&&la(r,a)}};function Kd(t,e,n,r,s){const{property:a,computed:o}=t;let u;if(!o)u=a.name;else if(zt(hs,a))u=a.value;else try{pt(a,n,zh,t),u=n.param(a)}catch{n.error(t,Kk)}return r(t,u,e,n,s),!1}const Ql={...zh,VariableDeclarator:Jt("Variable declaration in operator call"),Identifier(t,e,n){f1(t,e,n)&&e.error(t,Zk)},CallExpression(t,e){const n=c1(t.callee);s0(n)?Jl(t,n,e):e.error(t,a1,l1)}};function lM(t,e){t.generator&&Jt("Generator functions")(t,e),t.async&&Jt("Async functions")(t,e);const{params:n}=t,r=n.length,s=o=>(u,l)=>e.columnRef.set(u,[l,o]),a=(o,u)=>e.paramsRef.set(o,u);r&&(e.join?(Es(e,n[0],"tuple1",s(1)),r>1&&Es(e,n[1],"tuple2",s(2)),r>2&&Es(e,n[2],"$param",a)):(Es(e,n[0],"tuple",s(0)),r>1&&Es(e,n[1],"$param",a))),e.root=t.body}function Es(t,e,n,r){zt(ki,e)?(t.scope.add(e.name),t[n]=e.name):zt(Zm,e)&&e.properties.forEach(s=>{const a=zt(ki,s.key)?s.key.name:zt(hs,s.key)?s.key.value:t.error(s,Yk);zt(ki,s.value)||t.error(s.value,eM),r(s.value.name,a)})}function cM(t,e,n,r){const s=[],a=[],o=e.param[0]||0,u=o+(e.param[1]||0);return r.forEach((l,c)=>{c<o?(pt(l,t,Ql),s.push(t.field(l))):c<u?(pt(l,t,Ql),a.push(t.param(l))):t.error(l,Qk)}),{name:n,fields:s,params:a,...t.spec.window||{}}}function c1(t){return zt(ki,t)?t.name:zt(Xm,t)?h1(t)?hM(t.property.name):t.property.name:null}function h1(t){return zt(ki,t.object)&&t.object.name==="Math"}function hM(t){return t==="max"?"greatest":t==="min"?"least":t}function f1(t,e,n){const{name:r}=t;if(!(zt(Xm,n)&&n.property===t)){if(!(zt(t0,n)&&n.key===t))if(e.paramsRef.has(r))la(t,e.paramsRef.get(r));else if(e.columnRef.has(r))p1(t,r,e,n);else if(hn(e.params,r))la(t,r);else if(hn($h,r))m1(t,r);else return!0}}function d1(t,e,n,r,s){const a=n===0?r.table:n>0?r.join[n-1]:null,o=a&&a.column(e);a&&!o&&r.error(t,jh),r.aggronly&&!r.$op&&r.error(t,Gk),u0(t,e,n,o,s)}function p1(t,e,n,r){const[s,a]=n.columnRef.get(e);d1(t,s,a,n,r)}function fM(t,e,n,r){r.params&&!hn(r.params,e)&&r.error(t,Jk),la(t,e)}function la(t,e){t.type=eT,t.name=e}function m1(t,e){t.type=XI,t.name=e,t.raw=$h[e]}function Jl(t,e,n){if(e===l0){const r=n.table;r||n.error(t,sM),c0(t,t.arguments.length?t.arguments.map(s=>{const a=n.param(s),o=ce(a)?r.columnName(a):a;return r.column(o)||n.error(s,jh),o}):r.columnNames())}else t.callee={type:tT,name:e}}function Xl(t,e){zt(ki,t)?e.scope.add(t.name):zt(GI,t)?t.elements.forEach(n=>Xl(n,e)):zt(Zm,t)?t.properties.forEach(n=>Xl(n.value,e)):e.error(t.id,tM)}const dM={[_a]:1,[e0]:1};function ke(t,e={}){const n=e.generate||Ao,r=e.compiler||Fc,s=mM(e),a={},o={},u=[],l=[];let c=0,h=-1;const f=e.join?r.join:e.index==1?r.expr2:r.expr,d={op(g){const y=pM(g);return o[y]||(g.id=++h,o[y]=g)},field(g){const y=n(g);return a[y]||(a[y]=++c)},param(g){return zt(hs,g)?g.value:r.param(n(g),s)},value(g,y){u.push(g);const _=y.escape||(e.ast?ZC(y):f(n(y),s));l.push(_),dM[y.type]&&_!==y&&re(_)&&(_.field=y.name)},error(g,y,_=""){const b=g.start-6,A=g.end-6,S=String(d.spec).slice(b,A);it(`${y}: "${S}"${_}`)}};Object.assign(d,e,{params:s});for(const[g,y]of hu(t))d.value(g+"",y.escape?ik(d,y,s):aM(d,y));if(e.ast)return{names:u,exprs:l};const m=[];for(const g in a)m[a[g]]=r.expr(g,s);const p=Object.values(o);return p.forEach(g=>g.fields=g.fields.map(y=>m[y])),{names:u,exprs:l,ops:p}}function pM(t){let e=`${t.name}(${t.fields.concat(t.params).join(",")})`;if(t.frame){const n=t.frame.map(r=>Number.isFinite(r)?Math.abs(r):-1);e+=`[${n},${!!t.peers}]`}return e}function mM(t){return(t.table?dl(t.table):t.join?{...dl(t.join[1]),...dl(t.join[0])}:{})||{}}function dl(t){return t&&Ot(t.params)?t.params():{}}const y1="Expr",Ze="ExprList",g1="ExprNumber",Ls="ExprObject",Cr="JoinKeys",Ko="JoinValues",je="Options",qh="OrderKeys",wi="SelectionList",Gi="TableRef",kr="TableRefList",yM="Descending",gM="Query",vM="Selection",_M="Verb",bM="Window";function Mu(t,e){return t&&t.expr?new Qd({...t,...e}):new Qd(e,t)}class Qd{constructor(e,n){this.expr=n,Object.assign(this,e)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Ot(this.expr)?{func:!0}:{}}}}function wM(t){return Mu(t,{desc:!0})}function cr(t,e,n=0){const r=n?{field:!0,table:n}:{field:!0};return Mu(t,e?{expr:e,...r}:r)}function xM(t,e,n){return Mu(t,{window:{frame:e||[-1/0,0],peers:!!n}})}function SM(t){const e=n=>n;return e.toString=()=>t,e}function Jd(t,e){return e=e&&Ot(e.query)?e.query():e,e&&Ot(e.evaluate)?e.evaluate(null,t):t(e)}function v1(t){return re(t)&&(bt(t.all)||bt(t.matches)||bt(t.not)||bt(t.range))}function ca(t){return t&&Ot(t.toObject)?t.toObject():Ot(t)?{expr:String(t),func:!0}:bt(t)?t.map(ca):re(t)?Su(t,e=>ca(e)):t}function Wh(t){return bt(t)?t.map(Wh):re(t)?bt(t.verbs)?ka.from(t):bt(t.all)?is():bt(t.range)?GC(...t.range):bt(t.match)?KC(RegExp(...t.match)):bt(t.not)?xg(t.not.map(ca)):IM(t):t}function IM(t){let e=t,n=t.expr;if(n!=null){if(t.field===!0?e=n=cr(n):t.func===!0&&(e=n=SM(n)),re(t.window)){const{frame:r,peers:s}=t.window;e=n=xM(n,r,s)}t.desc===!0&&(e=wM(n))}return t===e?Su(t,r=>Wh(r)):e}function TM(t){return bt(t)?t.map(AM):t}function AM(t){const e=[];return Te(t).forEach(n=>{ce(n)?e.push(n):te(n)?e.push(cr(n,null)):re(n)&&n.expr||Ot(n)?e.push(n):it(`Invalid key value: ${n+""}`)}),e}function CM(t){return bt(t)?t.map(kM):t}function kM(t,e){return e<2?Te(t):t}function MM(t){const e=[];return t.forEach(n=>{const r=n.expr!=null?n.expr:n;if(re(r)&&!Ot(r))for(const s in r)e.push(r[s]);else n=ce(r)?r:te(r)?cr(n):Ot(r)?n:it(`Invalid orderby field: ${n+""}`),e.push(n)}),e}const NM={[y1]:x1,[Ze]:ss,[g1]:RM,[Ls]:Vi,[Cr]:LM,[Ko]:PM,[qh]:ss,[wi]:FM};function EM(t,e,n){return e===Gi?Xd(t):e===kr?t.map(Xd):_1(ca(t),e,n)}function _1(t,e,n){return e===je?t&&OM(t,n):NM[e](t)}function OM(t,e={}){const n={};for(const r in t){const s=t[r];n[r]=e[r]?_1(s,e[r]):s}return n}function DM(t,e){return ke({expr:t},{...e,ast:!0}).exprs[0]}function Hh(t){return{type:_a,name:t}}function b1(t){return{type:_a,index:t}}function Vi(t,e){if(te(t))return DM(t,e);if(t.expr){let n;if(t.field===!0?n=Hh(t.expr):t.func===!0&&(n=Vi(t.expr,e)),n)return t.desc&&(n={type:yM,expr:n}),t.window&&(n={type:bM,expr:n,...t.window}),n}return Object.keys(t).map(n=>({...Vi(t[n],e),as:n}))}function w1(t){const e=vM;return t.all?{type:e,operator:"all"}:t.not?{type:e,operator:"not",arguments:ss(t.not)}:t.range?{type:e,operator:"range",arguments:ss(t.range)}:t.matches?{type:e,operator:"matches",arguments:t.matches}:it("Invalid input")}function FM(t){return Te(t).map(BM).flat()}function BM(t){return v1(t)?w1(t):ce(t)?b1(t):te(t)?Hh(t):re(t)?Object.keys(t).map(e=>({type:_a,name:e,as:t[e]})):it("Invalid input")}function x1(t){return v1(t)?w1(t):ce(t)?b1(t):te(t)?Hh(t):re(t)?Vi(t):it("Invalid input")}function ss(t){return Te(t).map(x1).flat()}function RM(t){return ce(t)?t:Vi(t)}function LM(t){return bt(t)?t.map(ss):Vi(t,{join:!0})}function PM(t){return bt(t)?t.map((e,n)=>n<2?ss(e):Vi(e,{join:!0})):Vi(t,{join:!0})}function Xd(t){return t&&Ot(t.toAST)?t.toAST():t}class S1{constructor(e,n=[],r=[]){this.verb=e,this.schema=n,n.forEach((s,a)=>{const o=s.type,u=r[a],l=o===Cr?TM(u):o===Ko?CM(u):o===qh?MM(u):u;this[s.name]=l!==void 0?l:s.default})}static from(e){const n=Zl[e.verb],r=(n.schema||[]).map(({name:s})=>Wh(e[s]));return n(...r)}evaluate(e,n){const r=this.schema.map(({name:s,type:a})=>{const o=this[s];return a===Gi?Jd(n,o):a===kr?o.map(u=>Jd(n,u)):o});return e[this.verb](...r)}toObject(){const e={verb:this.verb};return this.schema.forEach(({name:n})=>{e[n]=ca(this[n])}),e}toAST(){const e={type:_M,verb:this.verb};return this.schema.forEach(({name:n,type:r,props:s})=>{e[n]=EM(this[n],r,s)}),e}}function Ct(t,e){return Object.assign((...n)=>new S1(t,e,n),{schema:e})}const Zl={count:Ct("count",[{name:"options",type:je}]),derive:Ct("derive",[{name:"values",type:Ls},{name:"options",type:je,props:{before:wi,after:wi}}]),filter:Ct("filter",[{name:"criteria",type:Ls}]),groupby:Ct("groupby",[{name:"keys",type:Ze}]),orderby:Ct("orderby",[{name:"keys",type:qh}]),relocate:Ct("relocate",[{name:"columns",type:wi},{name:"options",type:je,props:{before:wi,after:wi}}]),rename:Ct("rename",[{name:"columns",type:wi}]),rollup:Ct("rollup",[{name:"values",type:Ls}]),sample:Ct("sample",[{name:"size",type:g1},{name:"options",type:je,props:{weight:y1}}]),select:Ct("select",[{name:"columns",type:wi}]),ungroup:Ct("ungroup"),unorder:Ct("unorder"),reify:Ct("reify"),dedupe:Ct("dedupe",[{name:"keys",type:Ze,default:[]}]),impute:Ct("impute",[{name:"values",type:Ls},{name:"options",type:je,props:{expand:Ze}}]),fold:Ct("fold",[{name:"values",type:Ze},{name:"options",type:je}]),pivot:Ct("pivot",[{name:"keys",type:Ze},{name:"values",type:Ze},{name:"options",type:je}]),spread:Ct("spread",[{name:"values",type:Ze},{name:"options",type:je}]),unroll:Ct("unroll",[{name:"values",type:Ze},{name:"options",type:je,props:{drop:Ze}}]),lookup:Ct("lookup",[{name:"table",type:Gi},{name:"on",type:Cr},{name:"values",type:Ze}]),join:Ct("join",[{name:"table",type:Gi},{name:"on",type:Cr},{name:"values",type:Ko},{name:"options",type:je}]),cross:Ct("cross",[{name:"table",type:Gi},{name:"values",type:Ko},{name:"options",type:je}]),semijoin:Ct("semijoin",[{name:"table",type:Gi},{name:"on",type:Cr}]),antijoin:Ct("antijoin",[{name:"table",type:Gi},{name:"on",type:Cr}]),concat:Ct("concat",[{name:"tables",type:kr}]),union:Ct("union",[{name:"tables",type:kr}]),intersect:Ct("intersect",[{name:"tables",type:kr}]),except:Ct("except",[{name:"tables",type:kr}])};class ka extends Vm{constructor(e,n,r){super(n),this._verbs=e||[],this._table=r}static from({verbs:e,table:n,params:r}){return new ka(e.map(S1.from),r,n)}get[Symbol.toStringTag](){return this._verbs?`Query: ${this._verbs.length} verbs`+(this._table?` on '${this._table}'`:""):"Object"}get length(){return this._verbs.length}get tableName(){return this._table}params(e){return arguments.length?(this._params={...this._params,...e},this):this._params}evaluate(e,n){e=e||n(this._table);for(const r of this._verbs)e=r.evaluate(e.params(this._params),n);return e}toObject(){return Zd(this,"toObject")}toJSON(){return this.toObject()}toAST(){return Zd(this,"toAST",{type:gM})}}function Zd(t,e,n){return{...n,verbs:t._verbs.map(r=>r[e]()),...t._params?{params:t._params}:null,...t._table?{table:t._table}:null}}function VM(t,e){return new ka(t._verbs.concat(e),t._params,t._table)}for(const t in Zl){const e=Zl[t];ka.prototype["__"+t]=function(n,...r){return VM(n,e(...r))}}function _s(t,e,...n){const r=["_","$"],s=r.slice(0,n.length);return s.push('"use strict"; const '+n.map((a,o)=>a.map((u,l)=>`${r[o]}${l} = ${r[o]}[${l}]`).join(", ")).join(", ")+`; return (${t}) => ${e};`),Function(...s)(...n)}function UM(t,e=[]){return t.groupby(e.length?e:t.columnNames()).filter("row_number() === 1").ungroup().reify()}function Yh(t,e){const n=Le();return e.forEach((r,s)=>{const a=te(r)?r:s;if(a){const o=t.column(s)||it(`Unrecognized column: ${s}`);n.add(a,o)}}),t.create(n)}function I1(t,e,{before:n,after:r}={}){const s=n!=null,a=r!=null;s||a||it("relocate requires a before or after option."),s&&a&&it("relocate accepts only one of the before or after options."),e=oi(t,e);const o=[...oi(t,s?n:r).keys()],u=s?o[0]:o.pop(),l=new Map;return t.columnNames().forEach(c=>{const h=!e.has(c);if(c===u){a&&h&&l.set(c,c);for(const[f,d]of e)l.set(f,d);if(a)return}h&&l.set(c,c)}),Yh(t,l)}function Ma(t,e=r=>r,n=""){const r=t.length;if(!r)return"";let s=e(t[0],0);for(let a=1;a<r;++a)s+=n+e(t[a],a);return s}function Gh(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function $M(t,e=0,n=t.length){let r=n?t[e++]:vt;for(let s=e;s<n;++s)r>t[s]&&(r=t[s]);return r}function jM(t,e=0,n=t.length){let r=n?t[e++]:vt;for(let s=e;s<n;++s)r<t[s]&&(r=t[s]);return r}function Wa(t){return ta(t)?t:+t}function zM(t,e){const n=t.length;if(!n)return vt;if((e=+e)<=0||n<2)return Wa(t[0]);if(e>=1)return Wa(t[n-1]);const r=(n-1)*e,s=Math.floor(r),a=Wa(t[s]);return ta(a)?a:a+(Wa(t[s+1])-a)*(r-s)}class qM{constructor(e){this._values=e||[],this._sorted=null,this._start=0}values(e){return this._start&&(this._values=this._values.slice(this._start),this._start=0),e?this._values.slice():this._values}add(e){this._values.push(e),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:$M(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:jM(this._values,this._start)}quantile(e){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(Gh)),zM(this._sorted,e)}}const Qo=(t,e,n)=>_s(e,"{"+Ma(t,(r,s)=>`_${s}.${n}(${e});`)+"}",t);function WM(t,e){const{ops:n,output:r}=HM(t,e),s=t[0].fields,a=s.length,o=a===0?Kh:a===1?YM:a===2?GM:it("Unsupported field count: "+a);return new o(s,n,r,e)}function HM(t,e){const n={},r=[];function s(o,u=[]){const l=o+":"+u;if(n[l])return n[l];const c=a0(o),h=c.create(...u);return e<0&&c.stream&&c.stream.forEach(f=>s(f,[])),c.req&&c.req.forEach(f=>s(f,[])),n[l]=h,r.push(h),h}const a=t.map(o=>{const u=s(o.name,o.params);return u.output=o.id,u});return{ops:r,output:a}}class Kh extends JC{constructor(e,n,r,s){super(r),this._op=n,this._fields=e,this._stream=!!s}init(){const e={count:0,valid:0,stream:this._stream};return this._op.forEach(n=>n.init(e)),e.values&&(e.list=new qM),e}write(e,n,r){const s=this._outputs,a=s.length;for(let o=0;o<a;++o)n[s[o].output][r]=s[o].value(e);return 1}_add(){}_rem(){}add(e){++e.count}rem(e){--e.count}}class YM extends Kh{constructor(e,n,r,s){super(e,n,r,s);const a=["state","v1","v2"];this._add=Qo(n,a,"add"),this._rem=Qo(n,a,"rem")}add(e,n,r){const s=this._fields[0](n,r);++e.count,un(s)&&(++e.valid,e.list&&e.list.add(s),this._add(e,s))}rem(e,n,r){const s=this._fields[0](n,r);--e.count,un(s)&&(--e.valid,e.list&&e.list.rem(),this._rem(e,s))}}class GM extends Kh{constructor(e,n,r,s){super(e,n,r,s);const a=["state","v1","v2"];this._add=Qo(n,a,"add"),this._rem=Qo(n,a,"rem")}add(e,n,r){const s=this._fields[0](n,r),a=this._fields[1](n,r);++e.count,un(s)&&un(a)&&(++e.valid,e.list&&e.list.add([s,a]),this._add(e,s,a))}rem(e,n,r){const s=this._fields[0](n,r),a=this._fields[1](n,r);--e.count,un(s)&&un(a)&&(--e.valid,e.list&&e.list.rem(),this._rem(e,s,a))}}function mr(t,e,n){if(e.length){const r=t.data(),{keys:s}=t.groups()||{},a=bs(t,e),o=s?(u,l)=>a[u][s[l]]:u=>a[u][0];n=n.map(u=>l=>u(l,r,o))}return n}function bs(t,e,n){if(!e.length)return n;const r=T1(e),s=t.groups(),a=s?s.size:1;return n=n||lu(e.length,()=>Array(a)),a>1?r.forEach(o=>{const u=C1(t,o,s);for(let l=0;l<a;++l)o.write(u[l],n,l)}):r.forEach(o=>{const u=A1(t,o);o.write(u,n,0)}),n}function T1(t,e){const n=[],r={};for(const s of t){const a=s.fields.map(o=>o+"").join(",");(r[a]||(r[a]=[])).push(s)}for(const s in r)n.push(WM(r[s],e));return n}function A1(t,e){const n=e.init(),r=t.totalRows(),s=t.data(),a=t.mask();if(t.isOrdered()){const o=t.indices();for(let u=0;u<r;++u)e.add(n,o[u],s)}else if(a)for(let o=a.next(0);o>=0;o=a.next(o+1))e.add(n,o,s);else for(let o=0;o<r;++o)e.add(n,o,s);return n}function C1(t,e,n){const{keys:r,size:s}=n,a=lu(s,()=>e.init()),o=t.data();if(t.isOrdered()){const u=t.indices(),l=u.length;for(let c=0;c<l;++c){const h=u[c];e.add(a[r[h]],h,o)}}else if(t.isFiltered()){const u=t.mask();for(let l=u.next(0);l>=0;l=u.next(l+1))e.add(a[r[l]],l,o)}else{const u=t.totalRows();for(let l=0;l<u;++l)e.add(a[r[l]],l,o)}return a}function k1(t,e){const{get:n,names:r,rows:s,size:a}=e,o=r.length;for(let u=0;u<o;++u){const l=t.add(r[u],Array(a)),c=n[u];for(let h=0;h<a;++h)l[h]=c(s[h])}}function M1(t){return{left(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){const a=r+s>>>1;t(e[a],n)<0?r=a+1:s=a}return r},right(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){const a=r+s>>>1;t(e[a],n)>0?s=a:r=a+1}return r}}}const tp=M1(Gh);function KM(t,e,n,r,s){let a,o,u,l,c;const h=g=>o[g-1]===o[g],f=r.length,d=s.length,m=r.length?_s(["w","r","k"],"{"+Ma(r,(g,y)=>`r[_${y}.id][k]=_${y}.value(w,_${y}.get);`)+"}",r):()=>{},p={i0:0,i1:0,index:0,size:0,peer:h,init(g,y,_,b){p.index=p.i0=p.i1=0,p.size=y.length,a=g,o=y,l=_,c=b,u=s?s.map(A=>A.init()):null;for(let A=0;A<f;++A)r[A].init();return p},value(g,y){return y(a[g],t)},step(g){const[y,_]=e,b=p.size,A=p.i0,S=p.i1;p.i0=y!=null?Math.max(0,g-Math.abs(y)):0,p.i1=_!=null?Math.min(b,g+Math.abs(_)+1):b,p.index=g,n&&(p.i0>0&&h(p.i0)&&(p.i0=tp.left(o,o[p.i0])),p.i1<b&&h(p.i1)&&(p.i1=tp.right(o,o[p.i1-1])));for(let I=0;I<d;++I){const x=s[I],C=u[I];for(let T=A;T<p.i0;++T)x.rem(C,a[T],t);for(let T=S;T<p.i1;++T)x.add(C,a[T],t);x.write(C,l,c)}return m(p,l,c),l}};return p}const QM=t=>(t.frame||[null,null]).map(e=>Number.isFinite(e)?Math.abs(e):null),JM=t=>!!t.peers;function XM(t){const{id:e,name:n,fields:r=[],params:s=[]}=t,a=o0(n).create(...s);return r.length&&(a.get=r[0]),a.id=e,a}function ZM(t,e,n,r={},s){const a=t.data(),o=t6(s,a),u=o.length,l=_s(["r","d","op"],"{"+Ma(e,(c,h)=>`_${h}[r] = $${h}(r, d, op);`)+"}",e,n);t.partitions().forEach((c,h)=>{const f=c.length,d=e6(t,c);for(let p=0;p<u;++p)o[p].init(c,d,r,h);const m=p=>r[p][h];for(let p=0;p<f;++p){for(let g=0;g<u;++g)o[g].step(p);l(c[p],a,m)}})}function t6(t,e){const n={};return t.forEach(r=>{const s=QM(r),a=JM(r),o=`${s},${a}`,{aggOps:u,winOps:l}=n[o]||(n[o]={frame:s,peers:a,aggOps:[],winOps:[]});Oc(r.name)?u.push(r):l.push(XM(r))}),Object.values(n).map(r=>KM(e,r.frame,r.peers,r.winOps,T1(r.aggOps,r.frame[0]!=null?-1:1)))}function e6(t,e){if(t.isOrdered()){const n=t.comparator(),r=t.data(),s=e.length,a=new Uint32Array(s);for(let o=1,u=0;o<s;++o)a[o]=n(e[o-1],e[o],r)?++u:u;return a}else return e}function n6(t){return Dc(t.name)||t.frame&&(Number.isFinite(t.frame[0])||Number.isFinite(t.frame[1]))}function Qh(t,{names:e,exprs:n,ops:r},s={}){const a=t.totalRows(),o=Le(s.drop?null:t),u=e.map(d=>o.add(d,Array(a))),[l,c]=i6(r),h=t.isGrouped()?t.groups().size:1,f=bs(t,l,lu(r.length,()=>Array(h)));return c.length?ZM(t,u,n,f,c):r6(t,u,n,f),t.create(o)}function i6(t){const e=[],n=[],r=t.length;for(let s=0;s<r;++s){const a=t[s];a.id=s,(n6(a)?n:e).push(a)}return[e,n]}function r6(t,e,n,r){const s=t.mask(),a=t.data(),{keys:o}=t.groups()||{},u=o?(c,h)=>r[c][o[h]]:c=>r[c][0],l=e.length;for(let c=0;c<l;++c){const h=n[c],f=e[c];if(s)for(let d=s.next(0);d>=0;d=s.next(d+1))f[d]=h(d,a,u);else{const d=t.totalRows();for(let m=0;m<d;++m)f[m]=h(m,a,u)}}}function s6(t,e,n={}){const r=Qh(t,ke(e,{table:t}),n);return n.drop||n.before==null&&n.after==null?r:I1(r,Object.keys(e).filter(s=>!t.column(s)),n)}function a6(t,e){if(e.length===0)return t;const n=t.columnNames();return e.reduce((r,s)=>r.antijoin(s.select(n)),t).dedupe()}const Ha=2147483648,o6=4294967295;class N1{constructor(e){this._size=e,this._bits=new Uint32Array(Math.ceil(e/32))}get length(){return this._size}count(){const e=this._bits.length;let n=0;for(let r=0;r<e;++r)for(let s=this._bits[r];s;++n)s&=s-1;return n}get(e){return this._bits[e>>5]&Ha>>>e}set(e){this._bits[e>>5]|=Ha>>>e}clear(e){this._bits[e>>5]&=~(Ha>>>e)}scan(e){for(let n=this.next(0);n>=0;n=this.next(n+1))e(n)}next(e){const n=this._bits,r=n.length;let s=e>>5,a=n[s]&o6>>>e;for(;s<r;a=n[++s])if(a!==0)return(s<<5)+Math.clz32(a);return-1}nth(e){let n=this.next(0);for(;e--&&n>=0;)n=this.next(n+1);return n}not(){const e=this._bits,n=e.length;for(let s=0;s<n;++s)e[s]=~e[s];const r=this._size%32;return r&&(e[n-1]&=Ha>>r-1),this}and(e){if(e){const n=this._bits,r=e._bits,s=n.length;for(let a=0;a<s;++a)n[a]&=r[a]}return this}or(e){if(e){const n=this._bits,r=e._bits,s=n.length;for(let a=0;a<s;++a)n[a]|=r[a]}return this}}function u6(t,e){const n=t.totalRows(),r=t.mask(),s=t.data(),a=new N1(n);if(r)for(let o=r.next(0);o>=0;o=r.next(o+1))e(o,s)&&a.set(o);else for(let o=0;o<n;++o)e(o,s)&&a.set(o);return t.create({filter:a})}function l6(t,e){const n=ke({p:e},{table:t});let r=n.exprs[0];if(n.ops.length){const{data:s}=Qh(t,n,{drop:!0}).column("p");r=a=>s[a]}return u6(t,r)}function E1(t,{names:e=[],exprs:n=[],ops:r=[]},s={}){if(!e.length)return t;const a=s.limit>0?+s.limit:1/0,o=s.index?s.index===!0?"index":s.index+"":null,u=new Set(s.drop),l=mr(t,r,n),c=Le(),h=new Set(e),f=[],d=[],m=[];t.columnNames().forEach(S=>{if(!u.has(S)){const I=c.add(S,[]);h.has(S)||(f.push(t.column(S)),d.push(I))}}),e.forEach(S=>{u.has(S)||(c.has(S)||c.add(S,[]),m.push(c.data[S]))});const p=o?c.add(o,[]):null;let g=0;const y=f.length,_=m.length,b=(S,I)=>{for(let x=0;x<y;++x)d[x].length=g+I,d[x].fill(f[x].get(S),g,g+I)},A=p?(S,I)=>{for(let x=0;x<I;++x)p[S+x]=x}:()=>{};if(_===1){const S=l[0],I=m[0];t.scan((x,C)=>{const T=Te(S(x,C)),N=Math.min(T.length,a);b(x,N);for(let E=0;E<N;++E)I[g+E]=T[E];A(g,N),g+=N})}else t.scan((S,I)=>{let x=0;const C=l.map(T=>{const N=Te(T(S,I));return x=Math.min(Math.max(x,N.length),a),N});b(S,x);for(let T=0;T<_;++T){const N=m[T],E=C[T];for(let k=0;k<x;++k)N[g+k]=E[k]}A(g,x),g+=x});return t.create(c.new())}function c6(t,{names:e=[],exprs:n=[],ops:r=[]},s={}){if(e.length===0)return t;const[a="key",o="value"]=s.as||[],u=mr(t,r,n);return E1(t,{names:[a,o],exprs:[()=>e,(l,c)=>u.map(h=>h(l,c))]},{...s,drop:e})}function dn(t,e,n,r={window:!1}){const s=new Map,a=o=>{o=ce(o)?e.columnName(o):o,te(o)?s.set(o,cr(o)):Ot(o)?oi(e,o).forEach(a):re(o)?bg(s,o):it(`Invalid ${t} value: ${o+""}`)};return Te(n).forEach(a),r.preparse&&r.preparse(s),ke(s,{table:e,...r})}function h6(t,e,n){return c6(t,dn("fold",t,e),n)}function ep(t,e,n,r){const s=n&&n.length;return f6(s?d6(t,n,r):t,e,s)}function f6(t,{names:e,exprs:n,ops:r},s){const a=mr(t,r,n),o=s?null:Le(t),u=t.totalRows();return e.forEach((l,c)=>{const h=t.column(l),f=s?h.data:o.add(l,Array(u)),d=a[c];t.scan(m=>{const p=h.get(m);f[m]=un(p)?p:d(m)})}),s?t:t.create(o)}function d6(t,e,n){const r=t.groups(),s=t.data(),a=(r?r.names:[]).concat(e),o=(r?r.get:[]).concat(e.map(p=>t.getter(p))),u=new Set,l=Co(o);t.scan((p,g)=>u.add(l(p,g)));const c=t.columnNames(),h=Le(),f=c.map(p=>h.add(p,[]));c.forEach((p,g)=>{const y=s[p],_=f[g];t.scan(b=>_.push(y.get(b)))});const d=Co(o.map((p,g)=>y=>y[g])),m=_s("v","{"+f.map((p,g)=>`_${g}.push(v[$${g}]);`).join("")+"}",f,c.map(p=>a.indexOf(p)));if(r){let p=r.keys.length;const g=n.reduce((_,b)=>_*b.length,r.size),y=new Uint32Array(g+(p-u.size));y.set(r.keys),np(r,n,(_,b)=>{u.has(d(_))||(m(_),y[p++]=b[0])}),h.groupby({...r,keys:y})}else np(r,n,p=>{u.has(d(p))||m(p)});return t.create(h.new())}function np(t,e,n){const r=t?t.get.length:0,s=t?1:0,a=s+e.length,o=new Int32Array(a),u=new Int32Array(a),l=[];if(t){const{get:h,rows:f,size:d}=t;o[0]=d,l.push((m,p)=>{const g=f[p];for(let y=0;y<r;++y)m[y]=h[y](g)})}e.forEach((h,f)=>{const d=f+r;o[f+s]=h.length,l.push((m,p)=>m[d]=h[p])});const c=Array(r+e.length);for(let h=0;h<a;++h)l[h](c,0);n(c,u);for(let h=a-1;h>=0;){const f=++u[h];f<o[h]?(l[h](c,f),n(c,u),h=a-1):(u[h]=0,l[h](c,0),--h)}}function Jh(t,{names:e,exprs:n,ops:r}){const s=Le(),a=t.groups();return a&&k1(s,a),p6(e,n,a,bs(t,r),s),t.create(s.new())}function p6(t,e,n,r=[],s){if(!e.length)return;const a=n?n.size:1,o=(l,c)=>r[l][c],u=t.length;for(let l=0;l<u;++l){const c=e[l];if(c.field!=null)s.add(t[l],r[c.field]);else if(a>1){const h=s.add(t[l],Array(a));for(let f=0;f<a;++f)h[f]=c(f,null,o)}else s.add(t[l],[c(0,null,o)])}}function m6(t,e,n={}){if(e=ke(e,{table:t}),e.names.forEach(r=>t.column(r)?0:it(`Invalid impute column ${Bn(r)}`)),n.expand){const r={preparse:y6,aggronly:!0},s=dn("impute",t,n.expand,r),a=Jh(t.ungroup(),s);return ep(t,e,s.names,s.names.map(o=>a.get(o,0)))}else return ep(t,e)}function y6(t){t.forEach((e,n)=>e.field?t.set(n,Gm(e+"")):0)}function g6(t,e){const n=t.columnNames();return e.length?e.reduce((r,s)=>r.semijoin(s.select(n)),t).dedupe():t.reify([])}function O1(t,e){const n=new Map;return t.scan((r,s)=>{const a=e(r,s);a!=null&&a===a&&n.set(a,r)}),n}function v6(t,e,n){const r=new Map,s=t.length;for(let a=0;a<s;++a){const o=t[a],u=n(o,e);u!=null&&u===u&&(r.has(u)?r.get(u).push(a):r.set(u,[a]))}return r}function _6(t,e){const n=["i","a","j","b"];return _s(n,"{"+Ma(t,(r,s)=>`_${s}.push($${s}(${n}));`)+"}",t,e)}function b6(t,e,n,{names:r,exprs:s},a={}){const o=t.data(),u=t.indices(!1),l=u.length,c=new Int32Array(l),h=e.data(),f=e.indices(!1),d=f.length,m=new Int32Array(d),p=r.length,g=Le(),y=Array(p),_=Array(p);for(let S=0;S<r.length;++S)y[S]=g.add(r[S],[]),_[S]=s[S];const b=_6(y,_);if((bt(n)?x6:w6)(b,n,o,h,u,f,c,m,l,d),a.left)for(let S=0;S<l;++S)c[S]||b(u[S],o,-1,h);if(a.right)for(let S=0;S<d;++S)m[S]||b(-1,o,f[S],h);return t.create(g.new())}function w6(t,e,n,r,s,a,o,u,l,c){for(let h=0;h<l;++h){const f=s[h];for(let d=0;d<c;++d){const m=a[d];e(f,n,m,r)&&(t(f,n,m,r),o[h]=1,u[d]=1)}}}function x6(t,[e,n],r,s,a,o,u,l,c,h){let f,d,m,p,g,y,_,b,A=t;c>=h?(f=r,d=e,m=u,p=a,g=s,y=n,_=l,b=o):(f=s,d=n,m=l,p=o,g=r,y=e,_=u,b=a,A=(x,C,T,N)=>t(T,N,x,C));const S=v6(b,g,y),I=p.length;for(let x=0;x<I;++x){const C=p[x],T=S.get(d(C,f));if(T){const N=T.length;for(let E=0;E<N;++E){const k=T[E];A(C,f,b[k],g),_[k]=1}m[x]=1}}}function Jo(t,e,n){const r=new Map;Te(n).forEach((a,o)=>{a=ce(a)?e.columnName(a):a,te(a)?r.set(o,cr(a)):Ot(a)||re(a)&&a.expr?r.set(o,a):it(`Invalid ${t} key value: ${a+""}`)});const s=ke(r,{table:e,aggregate:!1,window:!1});return Co(s.exprs,!0)}function S6(t,e){const n=new Set(e);return t.filter(r=>n.has(r))}function Xh(t,e,n){if(n)te(n)?n=[n,n]:bt(n)&&n.length===1&&(n=[n[0],n[0]]);else{const r=S6(t.columnNames(),e.columnNames());r.length||it("Natural join requires shared column names."),n=[r,r]}return n}function D1(t,e,n,r){return n.length!==r.length&&it("Mismatched number of join keys"),[Jo("join",t,n),Jo("join",e,r)]}const I6={aggregate:!1,window:!1},T6={...I6,index:1};function ip(t,e,n,r,s={}){n=Xh(t,e,n);const a={join:[t,e]};let o;if(bt(n)){const[u,l]=n.map(Te);o=D1(t,e,u,l),r||(r=A6(t,u,l,s))}else o=ke({on:n},a).exprs[0],r||(r=[is(),is()]);return b6(t,e,o,C6(t,e,r,a,s&&s.suffix),s)}function A6(t,e,n,r){const s=[];e.forEach((o,u)=>te(o)&&o===n[u]?s.push(o):0);const a=xg(s);if(r.left&&r.right){const o=new Set(s);return[t.columnNames().map(u=>{const l=`[${Bn(u)}]`;return o.has(u)?{[u]:`(a, b) => a${l} == null ? b${l} : a${l}`}:u}),a]}return r.right?[a,is()]:[is(),a]}function C6(t,e,n,r,s=[]){if(bt(n)){let a,o,u,l=n.length;a=o=u={names:[],exprs:[]},l--&&(a=dn("join",t,n[0],r)),l--&&(o=dn("join",e,n[1],T6)),l--&&(u=ke(n[2],r));const c=new Set,h=new Set(a.names);return o.names.forEach(f=>{h.has(f)&&c.add(f)}),c.size&&(s[0]!==""&&rp(a.names,c,s[0]||"_1"),s[1]!==""&&rp(o.names,c,s[1]||"_2")),{names:a.names.concat(o.names,u.names),exprs:a.exprs.concat(o.exprs,u.exprs)}}else return ke(n,r)}function rp(t,e,n){t.forEach((r,s)=>e.has(r)?t[s]=r+n:0)}function k6(t,e,n,r={}){const s=new N1(t.totalRows());return(bt(n)?M6:N6)(s,t,e,n),r.anti&&s.not().and(t.mask()),t.create({filter:s})}function M6(t,e,n,[r,s]){const a=O1(n,s);e.scan((o,u)=>{a.get(r(o,u))>=0&&t.set(o)})}function N6(t,e,n,r){const s=e.numRows(),a=n.numRows(),o=e.data(),u=n.data();if(e.isFiltered()||n.isFiltered()){const l=e.indices(!1),c=n.indices(!1);for(let h=0;h<s;++h){const f=l[h];for(let d=0;d<a;++d)if(r(f,o,c[d],u)){t.set(f);break}}}else for(let l=0;l<s;++l)for(let c=0;c<a;++c)if(r(l,o,c,u)){t.set(l);break}}function sp(t,e,n,r){n=Xh(t,e,n);const s=bt(n)?D1(t,e,...n.map(Te)):ke({on:n},{join:[t,e]}).exprs[0];return k6(t,e,s,r)}function E6(t,e,[n,r],{names:s,exprs:a,ops:o}){const u=Le(t),l=t.totalRows();s.forEach(d=>u.add(d,Array(l).fill(vt)));const c=O1(e,r),h=_s(["lr","rr","data"],"{"+Ma(s,(d,m)=>`_[${m}][lr] = $[${m}](rr, data);`)+"}",s.map(d=>u.data[d]),mr(e,o,a)),f=e.data();return t.scan((d,m)=>{const p=c.get(n(d,m));p>=0&&h(d,p,f)}),t.create(u)}function O6(t,e,n,r){return n=Xh(t,e,n),E6(t,e,[Jo("lookup",t,n[0]),Jo("lookup",e,n[1])],dn("lookup",e,r))}const tc=(t,e)=>t??e;function D6(t,e,n,r={}){const{keys:s,keyColumn:a}=F6(t,e,r),o=tc(r.valueSeparator,"_"),u=n.names.length>1?(c,h)=>h+o+s[c]:c=>s[c],l=s.map(c=>bs(t,n.ops.map(h=>{if(h.name==="count"){const d=m=>c===a[m]?1:NaN;return d.toString=()=>c+":1",{...h,name:"sum",fields:[d]}}const f=h.fields.map(d=>{const m=(p,g)=>c===a[p]?d(p,g):NaN;return m.toString=()=>c+":"+d,m});return{...h,fields:f}})));return t.create(B6(n,u,t.groups(),l))}function F6(t,e,n){const r=n.limit>0?+n.limit:1/0,s=tc(n.sort,!0),a=tc(n.keySeparator,"_"),o=mr(t,e.ops,e.exprs),u=o.length===1?o[0]:(f,d)=>o.map(m=>m(f,d)).join(a),l=Array(t.totalRows());t.scan((f,d)=>l[f]=u(f,d));const c=bs(t.ungroup(),[{id:0,name:"array_agg_distinct",fields:[f=>l[f]],params:[]}])[0][0],h=s?c.sort():c;return{keys:Number.isFinite(r)?h.slice(0,r):h,keyColumn:l}}function B6({names:t,exprs:e},n,r,s){const a=r?r.size:1,o=Le(),u=s.length,l=t.length;let c;const h=(f,d)=>c[f][d];r&&k1(o,r);for(let f=0;f<l;++f){const d=e[f];if(d.field!=null)for(let m=0;m<u;++m)o.add(n(m,t[f]),s[m][d.field]);else if(a>1)for(let m=0;m<u;++m){c=s[m];const p=o.add(n(m,t[f]),Array(a));for(let g=0;g<a;++g)p[g]=d(g,null,h)}else for(let m=0;m<u;++m)c=s[m],o.add(n(m,t[f]),[d(0,null,h)])}return o.new()}function R6(t,e,n,r){return D6(t,dn("fold",t,e),dn("fold",t,n,{preparse:L6,aggronly:!0}),r)}function L6(t){t.forEach((e,n)=>e.field?t.set(n,Wm(e+"")):0)}function P6(t,e){const n=new Map;return t.columnNames(r=>(n.set(r,r),0)),Yh(t,oi(t,e,n))}function ap(t,e){return Jh(t,ke(e,{table:t,aggronly:!0,window:!1}))}function V6(t,e,n,r){return(e?r?$6:U6:r?z6:j6)(t.length,t,n,r)}function U6(t,e,n){const r=n.length;for(let s=0;s<t;++s)e[s]=n[r*cs()|0];return e}function $6(t,e,n,r){const s=n.length,a=new Float64Array(s);let o=0;for(let l=0;l<s;++l)a[l]=o+=r(n[l]);const u=M1(Gh).right;for(let l=0;l<t;++l)e[l]=n[u(a,o*cs())];return e}function j6(t,e,n){const r=n.length;if(t>=r)return n;for(let s=0;s<t;++s)e[s]=n[s];for(let s=t;s<r;++s){const a=s*cs();a<t&&(e[a|0]=n[s])}return e}function z6(t,e,n,r){const s=n.length;if(t>=s)return n;const a=new Float32Array(s),o=new Uint32Array(s);for(let u=0;u<s;++u)o[u]=u,a[u]=-Math.log(cs())/r(n[u]);o.sort((u,l)=>a[u]-a[l]);for(let u=0;u<t;++u)e[u]=n[o[u]];return e}function q6(t,e=0,n=t.length){let r=n-(e=+e);for(;r;){const s=cs()*r--|0,a=t[r+e];t[r+e]=t[s+e],t[s+e]=a}return t}function W6(t,e,n,r={}){const{replace:s,shuffle:a}=r,o=t.partitions(!1);let u=0;e=o.map((h,f)=>{let d=e(f);return u+=d=s?d:Math.min(h.length,d),d});const l=new Uint32Array(u);let c=0;return o.forEach((h,f)=>{const d=e[f],m=l.subarray(c,c+=d);!s&&d===h.length?m.set(h):V6(m,s,h,n)}),a!==!1&&(o.length>1||!s)&&q6(l),t.reify(l)}function H6(t,e,n={}){return W6(t,Y6(t,e),G6(t,n.weight),n)}const F1=t=>e=>t.get(e)||0;function Y6(t,e){return ce(e)?()=>e:F1(Jh(t,ke({size:e},{table:t,window:!1})).column("size"))}function G6(t,e){return e==null?null:(e=ce(e)?t.columnName(e):e,F1(te(e)?t.column(e):Qh(t,ke({w:e},{table:t}),{drop:!0}).column("w")))}function K6(t,e){return Yh(t,oi(t,e))}function Q6(t,{names:e,exprs:n,ops:r=[]},s={}){if(e.length===0)return t;const a=e.length===1&&s.as||[],o=s.drop==null?!0:!!s.drop,u=s.limit==null?a.length||1/0:Math.max(1,+s.limit||1),l=mr(t,r,n),c=Le(),h=e.reduce((d,m,p)=>d.set(m,p),new Map),f=(d,m)=>{const p=J6(t,l[d],u),g=p.length;for(let y=0;y<g;++y)c.add(a[y]||`${m}_${y+1}`,p[y])};return t.columnNames().forEach(d=>{h.has(d)?(o||c.add(d,t.column(d)),f(h.get(d),d),h.delete(d)):c.add(d,t.column(d))}),h.forEach(f),t.create(c)}function J6(t,e,n){const r=t.totalRows(),s=[];return t.scan((a,o)=>{const u=Te(e(a,o)),l=Math.min(u.length,n);for(;s.length<l;)s.push(Array(r).fill(vt));for(let c=0;c<l;++c)s[c][a]=u[c]}),s}function X6(t,e,n){return Q6(t,dn("spread",t,e),n)}function Z6(t,e){return t.concat(e).dedupe()}function tN(t,e,n){return E1(t,dn("unroll",t,e),n&&n.drop?{...n,drop:dn("unroll",t,n.drop).names}:n)}function eN(t,e){return t.create({groups:nN(t,e)})}function nN(t,{names:e=[],exprs:n=[],ops:r=[]}){const s=e.length;if(s===0)return null;if(s===1&&!t.isFiltered()&&n[0].field){const m=t.column(n[0].field);if(m.groups)return m.groups(e)}let a=mr(t,r,n);const o=Co(a),u=t.totalRows(),l=new Uint32Array(u),c={},h=[],f=t.data(),d=t.mask();if(d)for(let m=d.next(0);m>=0;m=d.next(m+1)){const p=o(m,f)+"",g=c[p];l[m]=g??(c[p]=h.push(m)-1)}else for(let m=0;m<u;++m){const p=o(m,f)+"",g=c[p];l[m]=g??(c[p]=h.push(m)-1)}return r.length||(a=a.map(m=>p=>m(p,f))),{keys:l,get:a,names:e,rows:h,size:h.length}}function iN(t,e){return eN(t,dn("groupby",t,e))}function rN(t,e){return t.create({order:e})}const sN=(t,e,n,r)=>`((u = ${t}) < (v = ${e}) || u == null) && v != null ? ${n}
    : (u > v || v == null) && u != null ? ${r}
    : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
    : v !== v && u === u ? ${r} : `;function aN(t,e){const n=[],r=[],s=[];let a=null,o="0",u="0";t.isGrouped()&&(a=t.groups().keys,o="ka",u="kb");const{ops:l}=ke(e,{table:t,value:(m,p)=>{if(n.push(m),p.escape){const g=y=>`fn[${s.length}](${y}, data)`;r.push([g("a"),g("b")]),s.push(p.escape)}else r.push([Ao(p,{index:"a",op:o}),Ao(p,{index:"b",op:u})])},window:!1}),c=bs(t,l),h=(m,p)=>c[m][p],f=n.length;let d="return (a, b) => {"+(h&&t.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let m=0;m<f;++m){const p=e.get(n[m]).desc?-1:1,[g,y]=r[m];d+=sN(g,y,-p,p)}return d+="0;};",Function("op","keys","fn","data",d)(h,a,s,t.data())}function oN(t,e){return rN(t,uN(t,e))}function uN(t,e){let n=-1;const r=new Map,s=a=>r.set(++n+"",a);return e.forEach(a=>{const o=a.expr!=null?a.expr:a;if(re(o)&&!Ot(o))for(const u in o)s(o[u]);else s(ce(o)?cr(a,t.columnName(o)):te(o)?cr(a):Ot(o)?a:it(`Invalid orderby field: ${a+""}`))}),aN(t,r)}function lN(t,e){const n=t.numRows(),r=n+e.reduce((o,u)=>o+u.numRows(),0);if(n===r)return t;const s=[t,...e],a=Le();return t.columnNames().forEach(o=>{const u=Array(r);let l=0;s.forEach(c=>{const h=c.column(o)||{get:()=>vt};c.scan(f=>u[l++]=h.get(f))}),a.add(o,u)}),t.create(a.new())}function cN(t,e){const n=Le(),r=t.groups(),{get:s,names:a=[],rows:o,size:u=1}=r||{},l=new Uint32Array(u+1);a.forEach(d=>n.add(d,null));const c=r?C1(t,e,r):[A1(t,e)];e.outputs().map(d=>n.add(d,[]));const h=l.length-1;let f=0;for(let d=0;d<h;++d)f+=l[d+1]=e.write(c[d],n.data,l[d]);if(r){const d=t.data();a.forEach((m,p)=>{const g=n.data[m]=Array(f),y=s[p];for(let _=0,b=0;_<u;++_)g.fill(y(o[_],d),b,b+=l[_+1])})}return t.create(n.new())}function hN(t){return t.isGrouped()?t.create({groups:null}):t}function fN(t){return t.isOrdered()?t.create({order:null}):t}const dN={__antijoin:(t,e,n)=>sp(t,e,n,{anti:!0}),__count:(t,e={})=>ap(t,{[e.as||"count"]:Hm()}),__cross:(t,e,n,r)=>ip(t,e,()=>!0,n,{...r,left:!0,right:!0}),__concat:lN,__dedupe:UM,__derive:s6,__except:a6,__filter:l6,__fold:h6,__impute:m6,__intersect:g6,__join:ip,__lookup:O6,__pivot:R6,__relocate:I1,__rename:P6,__rollup:ap,__sample:H6,__select:K6,__semijoin:sp,__spread:X6,__union:Z6,__unroll:tN,__groupby:iN,__orderby:oN,__ungroup:hN,__unorder:fN,__reduce:cN};Object.assign(En.prototype,dN);function pN(t,e){return En.new(t,e)}function mN(t,e){return En.from(t,e)}function yN(t){return Mu(t,{escape:!0,toString(){it("Escaped values can not be serialized.")}})}En.prototype;function*gN(t,e){if(e==null)for(let n of t)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function vN(t,e,n){const r=Float64Array.from(gN(t,n));return r.sort(Er),e.map(s=>E_(r,s))}function _N(t,e){return vN(t,[.25,.5,.75],e)}function bN(t,e){const n=t.length,r=v_(t,e),s=_N(t,e),a=(s[2]-s[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(s[0])||1)*Math.pow(n,-.2)}var ec=Math.random;const wN=Math.sqrt(2*Math.PI),xN=Math.SQRT2;let Os=NaN;function SN(t,e){t=t||0,e=e??1;let n=0,r=0,s,a;if(Os===Os)n=Os,Os=NaN;else{do n=ec()*2-1,r=ec()*2-1,s=n*n+r*r;while(s===0||s>1);a=Math.sqrt(-2*Math.log(s)/s),n*=a,Os=r*a}return t+n*e}function IN(t,e,n){n=n??1;const r=(t-(e||0))/n;return Math.exp(-.5*r*r)/(n*wN)}function TN(t,e,n){e=e||0,n=n??1;const r=(t-e)/n,s=Math.abs(r);let a;if(s>37)a=0;else{const o=Math.exp(-s*s/2);let u;s<7.07106781186547?(u=.0352624965998911*s+.700383064443688,u=u*s+6.37396220353165,u=u*s+33.912866078383,u=u*s+112.079291497871,u=u*s+221.213596169931,u=u*s+220.206867912376,a=o*u,u=.0883883476483184*s+1.75566716318264,u=u*s+16.064177579207,u=u*s+86.7807322029461,u=u*s+296.564248779674,u=u*s+637.333633378831,u=u*s+793.826512519948,u=u*s+440.413735824752,a=a/u):(u=s+.65,u=s+4/u,u=s+3/u,u=s+2/u,u=s+1/u,a=o/u/2.506628274631)}return r>0?1-a:a}function AN(t,e,n){return t<0||t>1?NaN:(e||0)+(n??1)*xN*CN(2*t-1)}function CN(t){let e=-Math.log((1-t)*(1+t)),n;return e<6.25?(e-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*e,n=128584807152564e-32+n*e,n=11157877678025181e-33+n*e,n=-1333171662854621e-31+n*e,n=20972767875968562e-33+n*e,n=6637638134358324e-30+n*e,n=-4054566272975207e-29+n*e,n=-8151934197605472e-29+n*e,n=26335093153082323e-28+n*e,n=-12975133253453532e-27+n*e,n=-5415412054294628e-26+n*e,n=10512122733215323e-25+n*e,n=-4112633980346984e-24+n*e,n=-29070369957882005e-24+n*e,n=42347877827932404e-23+n*e,n=-13654692000834679e-22+n*e,n=-13882523362786469e-21+n*e,n=.00018673420803405714+n*e,n=-.000740702534166267+n*e,n=-.006033670871430149+n*e,n=.24015818242558962+n*e,n=1.6536545626831027+n*e):e<16?(e=Math.sqrt(e)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*e,n=-27517406297064545e-23+n*e,n=18239629214389228e-24+n*e,n=15027403968909828e-22+n*e,n=-4013867526981546e-21+n*e,n=29234449089955446e-22+n*e,n=12475304481671779e-21+n*e,n=-47318229009055734e-21+n*e,n=6828485145957318e-20+n*e,n=24031110387097894e-21+n*e,n=-.0003550375203628475+n*e,n=.0009532893797373805+n*e,n=-.0016882755560235047+n*e,n=.002491442096107851+n*e,n=-.003751208507569241+n*e,n=.005370914553590064+n*e,n=1.0052589676941592+n*e,n=3.0838856104922208+n*e):Number.isFinite(e)?(e=Math.sqrt(e)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*e,n=15076572693500548e-25+n*e,n=-3789465440126737e-24+n*e,n=761570120807834e-23+n*e,n=-1496002662714924e-23+n*e,n=2914795345090108e-23+n*e,n=-6771199775845234e-23+n*e,n=22900482228026655e-23+n*e,n=-99298272942317e-20+n*e,n=4526062597223154e-21+n*e,n=-1968177810553167e-20+n*e,n=7599527703001776e-20+n*e,n=-.00021503011930044477+n*e,n=-.00013871931833623122+n*e,n=1.0103004648645344+n*e,n=4.849906401408584+n*e):n=1/0,n*t}function kN(t,e){let n,r;const s={mean(a){return arguments.length?(n=a||0,s):n},stdev(a){return arguments.length?(r=a??1,s):r},sample:()=>SN(n,r),pdf:a=>IN(a,n,r),cdf:a=>TN(a,n,r),icdf:a=>AN(a,n,r)};return s.mean(t).stdev(e)}function op(t,e){const n=kN();let r=0;const s={data(a){return arguments.length?(t=a,r=a?a.length:0,s.bandwidth(e)):t},bandwidth(a){return arguments.length?(e=a,!e&&t&&(e=bN(t)),s):e},sample(){return t[~~(ec()*r)]+e*n.sample()},pdf(a){let o=0,u=0;for(;u<r;++u)o+=n.pdf((a-t[u])/e);return o/e/r},cdf(a){let o=0,u=0;for(;u<r;++u)o+=n.cdf((a-t[u])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return s.data(t)}const MN=.5*Math.PI/180;function up(t,e,n,r){n=n||25,r=Math.max(n,r||200);const s=g=>[g,t(g)],a=e[0],o=e[1],u=o-a,l=u/r,c=[s(a)],h=[];if(n===r){for(let g=1;g<r;++g)c.push(s(a+g/n*u));return c.push(s(o)),c}else{h.push(s(o));for(let g=n;--g>0;)h.push(s(a+g/n*u))}let f=c[0],d=h[h.length-1];const m=1/u,p=NN(f[1],h);for(;d;){const g=s((f[0]+d[0])/2);g[0]-f[0]>=l&&EN(f,g,d,m,p)>MN?h.push(g):(f=d,c.push(d),h.pop()),d=h[h.length-1]}return c}function NN(t,e){let n=t,r=t;const s=e.length;for(let a=0;a<s;++a){const o=e[a][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}function EN(t,e,n,r,s){const a=Math.atan2(s*(n[1]-t[1]),r*(n[0]-t[0])),o=Math.atan2(s*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(a-o)}const Xo=mN,ON=yN,DN=pN;function nc(t,e,n){let r=Xo(t),s={};if((e==null?void 0:e.constructor.name)==="Array"&&e.length>0)for(const o of e)if(o.bin){let u=o.bin,l=o.as||u+"__bin";if(r.column(l))continue;let c=o.end||u+"__bin_end";n.includes(l)||n.push(l),n.includes(c)||n.push(c);let{start:h,end:f,nBuckets:d,equiBin:m}=FN(r.column(u).data,o),p=DN({[l]:h,[c]:f});r=r.assign(p),r=r.filter(ON(g=>g[l]!==void 0&&g[c]!==void 0)),s.bin||(s.bin={}),s.bin[u]={nBuckets:d,equiBin:m}}else if(o.aggregate){let u=o.aggregate,l=o.groupby||[];l===Dl&&(l=n.filter(c=>r.columnNames().includes(c))),r=BN(r,u,l),s.aggregate||(s.aggregate={});for(const c of u){let h=c.field,f=c.op;f==="count"?s.aggregate.__count={method:f,groupby:l}:s.aggregate[h]={method:f,groupby:l}}}else if(o.calculate){let u=o.groupby||{};u===Dl&&(u=n),r=LN(r,o,u)}else o.fold?r=PN(r,o.fold,o.by,o.exclude,o.as):o.density?r=zN(r,o.density,o.groupby,o.cumulative,o.counts,o.bandwidth,o.extent,o.minsteps,o.maxsteps,o.steps,o.as):o.filter&&(r=WN(r,o.filter));let a=r.objects();return a.tableInfo=s,a}function FN(t,e){let n=e.nice;n===void 0&&(n=!0);let r=e.maxbins||10,s=e.step,a=e.exact,o=N_(),u,l,c;n&&r&&!s?(o=o.thresholds(r),u=o(t),c=!0):s?(r=Math.ceil(Or(t)/s),o=o.thresholds(r),u=o(t),c=!0):a&&(o=o.thresholds(a),u=o(t),c=!1),l=m=>{var g;let p=(g=u.map(y=>y.includes(m)?{x0:y.x0,x1:y.x1}:void 0).filter(y=>y!=null))==null?void 0:g[0];return{start:p==null?void 0:p.x0,end:p==null?void 0:p.x1}};let h=t.map(l),f=h.map(m=>m.start),d=h.map(m=>m.end);return{start:f,end:d,nBukcets:u.length,equiBin:c}}function BN(t,e,n){let r=RN(e);return t.groupby(n).rollup(r)}function RN(t){let e={};for(const n of t){let r=n.as,s=n.field,a=n.op;if(a==="mean"||a==="average")e[r]=`d => op.mean(d['${s}'])`;else if(a==="valid")e[r]=`d => op.valid(d['${s}'])`;else if(a==="invalid")e[r]=`d => op.invalid(d['${s}'])`;else if(a==="max")e[r]=`d => op.max(d['${s}'])`;else if(a==="min")e[r]=`d => op.min(d['${s}'])`;else if(a==="distinct")e[r]=`d => op.distinct(d['${s}'])`;else if(a==="sum")e[r]=`d => op.sum(d['${s}'])`;else if(a==="product")e[r]=`d => op.product(d['${s}'])`;else if(a==="mode")e[r]=`d => op.mode(d['${s}'])`;else if(a==="median")e[r]=`d => op.median(d['${s}'])`;else if(a==="quantile"){let o=n.p||.5;e[r]=`d => op.quantile(d['${s}'], ${o})`}else a==="stdev"?e[r]=`d => op.stdev(d['${s}'])`:a==="stdevp"?e[r]=`d => op.stdevp(d['${s}'])`:a==="variance"?e[r]=`d => op.variance(d['${s}'])`:a==="variancep"?e[r]=`d => op.variancep(d['${s}'])`:a==="count"?e[r]="d => op.count()":a==="corr"?e[r]=`d => op.corr(d['${s[0]}'], d['${s[1]}'])`:a==="covariance"?e[r]=`d => op.covariance(d['${s[0]}'], d['${s[1]}'])`:a==="covariancep"&&(e[r]=`d => op.covariancep(d['${s[0]}'], d['${s[1]}'])`)}return e}function LN(t,e,n){let r=e.calculate,s=e.as;return r=r.replace(/datum\./gi,"d."),t.groupby(n).derive({[s]:r})}function PN(t,e,n,r,s){let a=t.fold(e);if(r&&(a=a.select(n,"key","value")),s){let o=s[0]||"key",u=s[1]||"value";a=a.rename({key:o,value:u})}return a}function VN(t,e){let n,r=[];for(const s of e){let a=s.key,o=s.order;if(s.order){let u=UN(a,o);r.push(u)}else if(s.sort==="ascending"||s.sort===!0||s.sort==="asc"){let u=$N(a);r.push(u)}else if(s.sort==="descending"||s.sort==="desc"){let u=jN(a);r.push(u)}}return r.reverse(),r.length>0&&(n=t.toSorted((s,a)=>{for(const o of r){if(o(s,a)>0)return 1;if(o(s,a)<0)return-1}return 1})),n||t}function UN(t,e){return(n,r)=>{let s=e.indexOf(n[t])-e.indexOf(r[t]);return s!=0?s:0}}function $N(t){return(e,n)=>qs(e[t],n[t])}function jN(t){return(e,n)=>tv(e[t],n[t])}function zN(t,e,n,r,s,a,o,u,l,c,h){let f=r?"cdf":"pdf";h=h||["value","density"];let d=a,m=[],p=o,g=c||u||25,y=c||l||200;if(n||(n==null?void 0:n.length)>0){let{groups:_,names:b}=qN(t,n);return _.forEach((A,S)=>{let I=A.array(e);const x=op(I,d)[f],C=s?I.length:1,T=p||Or(I);up(x,T,g,y).forEach(E=>{const k={[h[0]]:E[0],[h[1]]:E[1]*C};if(n)for(let R=0;R<n.length;++R)k[n[R]]=b[S][R];m.push(k)})}),Xo(m).groupby(n)}else{let _=t.array(e);const b=op(_,d)[f],A=s?_.length:1,S=p||Or(_);return up(b,S,g,y).forEach(x=>{const C={[h[0]]:x[0],[h[1]]:x[1]*A};if(n)for(let T=0;T<n.length;++T)C[n[T]]=names[i][T];m.push(C)}),Xo(m)}}function qN(t,e){let n=t.groupby(e),r=n.groups(),s=r.size;r.rows.slice(1,s).push(t.numRows());let u=n.partitions(),l=n.objects(),c=[],h=[];return u.forEach(f=>{let d=Xo(l.filter((m,p)=>f.includes(p)));c.push(d),h.push(e.map(m=>d.get(m)))}),{groups:c,names:h}}function WN(t,e){return t.ungroup().filter(`d => ${e.replace(/datum\./gi,"d.")}`).reify()}async function lp(t,e,n,r,s){var Dt,Pt,Q,_t,L,Kt,yn,Pe,Wi,yi,Hi,Yi,Na,F,st,lt,M,Qt;let a={name:t.name,encoding:t.encoding,tone:t.tone||{type:Pm}},o=((Dt=t.tone)==null?void 0:Dt.filter)||null;if(o&&(o=[...o]),!e||!a.encoding){console.warn("No proper layer spec provided.");return}let u=Object.keys(a.encoding).map(O=>{let $=a.encoding[O];if([Ur,as,os].includes($.type))return $.field;if(O===ve)return $.field;if(!$.aggregate)return $.field}).filter(O=>O).flat(),l;t.common_transform?l=nc(e,[...t.common_transform||[],...t.transform||[]],u):l=nc(e,t.transform||[],u);let c=P(l.tableInfo),h=a.encoding,f=a.tone;f.type==="default"&&(f={type:"default",continued:f.continued});let d=Object.keys(h).filter(O=>![at,Ti,ue].includes(O)),m=h[at]&&h[Ti],p=h[ve]!==void 0,g=p&&h[ve].speech;g===void 0&&(g=!0);let y=p?h[ve].field:void 0;y&&ot(y)!=="Array"&&(y=[y]);let _=(Pt=h[ve])==null?void 0:Pt.by;p&&(_===void 0&&(_=ro),ot(_)!=="Array"&&(_=[_]),y.length!==_.length&&(_.length==1?_=y.map(()=>_[0]):console.error("The repeat direction is not matched with the repeat field(s)")));let b=[];at in h&&((Q=h[at].scale)!=null&&Q.order)?b.push({key:h[at].field,order:[(_t=h[at].scale)==null?void 0:_t.order]}):at in h&&((L=h[at].scale)!=null&&L.sort)?b.push({key:h[at].field,sort:(Kt=h[at].scale)==null?void 0:Kt.sort}):at in h&&b.push({key:h[at].field,order:ln(l.map(O=>O[h[at].field])).toSorted(qs)}),p&&((yn=h[ve].scale)!=null&&yn.order)?b.push({key:y,order:(Pe=h[ve].scale)==null?void 0:Pe.order}):p&&((Wi=h[ve].scale)!=null&&Wi.sort)?b.push({key:y,sort:(yi=h[ve].scale)==null?void 0:yi.sort}):p&&y.toReversed().forEach(O=>{let $=ln(l.map(U=>U[O])).toSorted(qs);b.push({key:O,order:$})}),l=VN(l,b),delete l.tableInfo;let A=[],S=[],I={},x,C=0;p&&(C=y.length,x=ln(l.map(O=>y.map($=>O[$]).join("_$_"))).map(O=>O.split("_$_")),x.forEach(O=>{let $=[];$.name=Xs(O,", ",!0),$.membership=[],y.forEach((U,dt)=>{$.membership.push({key:U,value:O[dt]})}),O.membership=$.membership,S.push($),I[O.join("&")]=S.length-1}));let T={};for(const O in h){let $=h[O];T[O]=s[$.scale.id]}let N=h[at].scale.timing===Us||((Yi=(Hi=T.time)==null?void 0:Hi.properties)==null?void 0:Yi.timing)===Us,E={};for(const O in h)E[O]=h[O].ramp;let k=h[at].tick!==void 0,R;if(k){let O=h[at].tick;O.name&&r[O.name]?R=r[O.name]:R=O,R=P(R),s.__beat?(R.interval=R.interval?s.__beat.converter(R.interval):nv,R.band=R.band?s.__beat.converter(R.band):rv):(R.interval||(R.interval=ev),R.band||(R.band=iv))}if(s){let O=(n==null?void 0:n.scaleDescriptionOrder)||Jv,$=P(n);$.isRepeated=p,$.repeatField=y;for(const U of O)T[U]&&($.aggregated=!!h[U].aggregate,$.binned=h[U].binned,T[U].description=eI(T[U],h[U],c,R,f,$,s.__beat))}for(const O in l){if(O==="tableInfo")continue;let $=l[O],U=p&&I[y.map(se=>$[se]).join("&")],dt=T.time($[h[at].field]!==void 0?$[h[at].field]:parseInt(O),m?$[h[Ti].field]!==void 0?$[h[Ti].field]:parseInt(O)+1:void 0);if(f.continued&&!m&&(delete dt.end,dt.duration=0),dt.start===void 0)continue;dt.timbre=T.timbre?T.timbre($[h[ue].field]):f.type;let Mt,pe;for(const se of d)T[se]&&(dt[se]=T[se]($[h[se].field])),Bp.includes(se)&&(dt.duration=dt[se].totalLength);dt[oe]&&(Mt={speech:dt[oe],start:dt.start,end:dt.end,language:(Na=h[oe])!=null&&Na.language?(F=h[oe])==null?void 0:F.language:(st=document==null?void 0:document.documentElement)==null?void 0:st.lang}),dt[tn]&&(pe={speech:dt[tn],start:dt.start,end:dt.end,language:(lt=h[oe])!=null&&lt.language?(M=h[oe])==null?void 0:M.language:(Qt=document==null?void 0:document.documentElement)==null?void 0:Qt.lang}),Mt&&(p?S[U].push(Mt):A.push(Mt)),dt.__datum=$,p?S[U].push(dt):A.push(dt),pe&&(p?S[U].push(pe):A.push(pe))}let D=f.continued===void 0?!1:f.continued,X=f.type||"default",ft;if(p){let O=Rm(0,x,_);S.forEach((U,dt)=>{let Mt=new El(X,U,T,{is_continued:D,relative:N});Object.keys(n||{}).forEach(se=>{Mt.setConfig(se,n==null?void 0:n[se])}),U.name&&Mt.setName(U.name),g&&Mt.setConfig("playRepeatSequenceName",!0),dt>0&&(Mt.setConfig("skipScaleSpeech",!0),Mt.setConfig("skipStartSpeech",!0)),dt<S.length-1&&Mt.setConfig("skipFinishSpeech",!0),k&&Mt.setConfig("tick",R),Mt.setRamp(E);let pe=O;for(let se=0;se<C;se++){pe=pe.nodes;let U1=U.membership[se];for(let Ea=0;Ea<pe.length;Ea++)if(pe[Ea].parent_value==U1.value){pe=pe[Ea];break}}pe.node.push(Mt)});let $=cI(O);$.forEach((U,dt)=>{U||console.warn("empty repeat stream",U),g&&U.setConfig&&U.setConfig("playRepeatSequenceName",!0),dt>0?(U.setConfig("skipScaleSpeech",!0),U.setConfig("skipStartSpeech",!0)):U.setConfig(Fm,Bm),dt<$.length-1&&U.setConfig("skipFinishSpeech",!0),k&&U.setConfig("tick",R),ot(U)===Zs.name&&(Object.assign(U.config,U.overlays[0].config),U.overlays.forEach((Mt,pe)=>{Mt.setConfig&&(Mt.setConfig("playRepeatSequenceName",!1),pe==0?(Mt.setConfig("skipScaleSpeech",!1),Mt.setConfig("skipStartSpeech",!1)):(Mt.setConfig("skipScaleSpeech",!0),Mt.setConfig("skipStartSpeech",!0)),Mt.setConfig("skipFinishSpeech",!0))}),U.setConfig&&(U.setConfig("skipScaleSpeech",!0),U.setConfig("skipTitle",!0),U.setConfig("skipStartSpeech",!0),U.setConfig("playRepeatSequenceName",!0)),U.setName(Xs(U.overlays.map(Mt=>Mt.name),", ",!0))),o&&U.setFilters(o)}),ft=$}else ft=new El(X,A,T,{is_continued:D,relative:N}),Object.keys(n||{}).forEach(O=>{ft.setConfig(O,n==null?void 0:n[O])}),k&&ft.setConfig("tick",R),a.name&&ft.setName(a.name),o&&ft.setFilters(o),ft.setRamp(E),t.description&&ft.setDescription(t.description);return{stream:ft,scales:T}}async function cp(t,e,n){let r;return t.values?P(t.values):(t.name?(e[t.name]||(e[t.name]=await hp(n[t.name])),r=P(e[t.name])):r=await hp(t.name),r)}async function hp(t){if(t!=null&&t.values)return t.values;if(t!=null&&t.csv)return Bf(t==null?void 0:t.csv);if(t!=null&&t.tsv)return Rf(t.tsv);if(t!=null&&t.url){let e=await(await fetch(t.url)).text();if(s_(e))return JSON.parse(e);if(l_(e))return Bf(e);if(o_(e))return Rf(e)}else return console.error("wrong data format provided"),[]}function ic(t,e){let n=Object.keys(e.encoding).map(r=>{let s=e.encoding[r];if([Ur,as,os].includes(s.type))return s.field;if(r===ve)return s.field;if(!s.aggregate)return s.field}).filter(r=>r);return t=nc(t,[...e.common_transform||[],...e.transform||[]],ln(n)),t}const Zo={[at]:[0,5],[Zt]:[200,1e3],[fr]:[0,1],[on]:[-1,1],[hr]:[0,1.5],[us]:[0,2],[De]:[0,20],[Fe]:[0,5]},rc={[Zt]:["C3","C4","C5","C6","G3","G4","G5","G6","D3","D4","D5","D6","A3","A4","A5","A6","E3","E4","E5","E6","B3","B4","B5","B6","F3","F4","F5","F6"].map(da),[fr]:[1,.8,.6,.4,.2,.9,.7,.5,.1],[hr]:[1,.5,1.5,2,1.3,.8,.3],[us]:[1,.5,1.5,2,1.3,.8,.3],[De]:[2,4,6,8,10,12,14,16,18,20],[Fe]:[1,2,3,4],[ue]:["piano","pianoElec","violin","metal","guitar","hithat","snare","highKick","lowKick","clap"]};function B1(t,e){let n=t==null?void 0:t.length;if(n>=e)return t.slice(0,e);{let r=Math.floor(n/e),s=e-r*n,a=[];for(let o=0;o<r;o++)a.push(...t);return a.push(...t.slice(0,s)),a}}function R1(t,e,n,r){var S,I,x,C,T;let{polarity:s,maxDistinct:a,times:o,zero:u,domainMax:l,domainMin:c,nice:h}=r,f=(S=tu[t])==null?void 0:S.type;const d=((I=ie[t])==null?void 0:I.max)||((x=ie[f])==null?void 0:x.max),m=((C=ie[t])==null?void 0:C.min)||((T=ie[f])==null?void 0:T.min);let p=e==null?void 0:e.scale,g={channel:t},y=P((p==null?void 0:p.domain)||null);y||(y=ln(n)),g.domain=y;let _=P((p==null?void 0:p.range)||null),b=(p==null?void 0:p.range)!==void 0;o&&!b&&(_=y.map(N=>N*o),scale.properties.times=o),!b&&t!==ve?_=B1(rc[t]||rc[f],y.length):t===ve?_=y.map((N,E)=>E):g.rangeProvided=b,(t===Zt||f===Zt)&&!_.every(N=>ot(N)==="Number")&&(_=_.map(da)),_=_.map((N,E)=>t===ue||f===ue?N:N<m?(console.warn(`The range value of ${N} is less than the possible ${t} value ${m}. The scale is capped to the minimum possible value.`),m):N>d?(console.warn(`The range value of ${N} is greater than the possible ${t} value ${d}. The scale is capped to the maximum possible value.`),d):N),g.range=_;let A=wc().domain(y).range(_);return A.properties=g,A}function Zh(t,e,n,r){var k,R,D,X,ft,Dt,Pt,Q,_t;let{polarity:s,maxDistinct:a,times:o,zero:u,domainMax:l,domainMin:c,nice:h}=r,f=(k=tu[t])==null?void 0:k.type;const d=((R=Ye[t])==null?void 0:R.max)||((D=Ye[f])==null?void 0:D.max),m=((X=Ye[t])==null?void 0:X.min)||((ft=Ye[f])==null?void 0:ft.min),p=((Dt=ie[t])==null?void 0:Dt.max)||((Pt=ie[f])==null?void 0:Pt.max),g=((Q=ie[t])==null?void 0:Q.min)||((_t=ie[f])==null?void 0:_t.min);let y=e==null?void 0:e.scale,_={channel:t,polarity:s},b=e.sort,A;b==="descending"||b==="desc"?(A=Wp,_.sort="descending"):(A=Er,_.sort="ascending");let S=P((y==null?void 0:y.domain)||null);S||(S=ln(n).toSorted(A)),_.domain=S;let I=P((y==null?void 0:y.range)||null),x=(y==null?void 0:y.range)!==void 0;o&&!x&&(I=S.map(L=>L*o),x=!0,_.times=o);let C=y==null?void 0:y.rangeMin,T=y==null?void 0:y.rangeMax;(t===ue||f===ue)&&(I=B1(rc[ue],S.length),x=!0);let N;if(!x&&a)N=[C!==void 0?C:m,T!==void 0?T:d];else if(!x&&!a){let L=QuantPreferredRange[t];N=[Vr(C,L[0],m),Vr(T,L[1],d)]}N&&!x&&(I=HN(N,S.length)),(t===Zt||f===Zt)&&!I.every(L=>ot(L)==="Number")&&(I=I.map(noteToFreq)),I=I.map((L,Kt)=>t===ue||f===ue?L:L<g?(console.warn(`The range value of ${L} is less than the possible ${t} value ${g}. The scale is capped to the minimum possible value.`),g):L>p?(console.warn(`The range value of ${L} is greater than the possible ${t} value ${p}. The scale is capped to the maximum possible value.`),p):L),x||(S[0]<S[1]&&s===lc||S[0]>S[1]&&s===POS)&&(I=I.reverse()),_.range=I;let E=wc().domain(S).range(I);return E.properties=_,E}function HN(t,e){if(e<1)return[];if(e==1)return(t[0]+t[1])/2;let n=e,r=t[1],s=t[0];s!=0&&(n=e-1);let a=(r-s)/n,o=[];for(let u=s;u<=r;u+=a)o.push(u);return o.slice(e==n?1:0,n+1)}function L1(t,e,n,r){var E,k,R,D,X,ft,Dt,Pt,Q,_t;let{polarity:s,maxDistinct:a,times:o,zero:u,domainMax:l,domainMin:c,nice:h}=r,f=(E=tu[t])==null?void 0:E.type;const d=((k=Ye[t])==null?void 0:k.max)||((R=Ye[f])==null?void 0:R.max),m=((D=Ye[t])==null?void 0:D.min)||((X=Ye[f])==null?void 0:X.min),p=((ft=ie[t])==null?void 0:ft.max)||((Dt=ie[f])==null?void 0:Dt.max),g=((Pt=ie[t])==null?void 0:Pt.min)||((Q=ie[f])==null?void 0:Q.min);let y=e==null?void 0:e.scale,_={channel:t,polarity:s};if(t===ue||f===ue){console.error("Timber channel can't be quantitatively scaled.");return}let b=P((y==null?void 0:y.domain)||null),A=!1;(e==null?void 0:e.domainMin)!==void 0||(e==null?void 0:e.domainMax)!==void 0||(e==null?void 0:e.domainMid)!==void 0?(b=[(e==null?void 0:e.domainMin)!==void 0?e==null?void 0:e.domainMin:c,(e==null?void 0:e.domainMax)!==void 0?e==null?void 0:e.domainMax:l],t==="pan"&&(y==null?void 0:y.domainMid)!==void 0?(b.splice(1,0,y==null?void 0:y.domainMid),A=[(e==null?void 0:e.domainMin)!==void 0,(e==null?void 0:e.domainMid)!==void 0,(e==null?void 0:e.domainMax)!==void 0]):A=[(e==null?void 0:e.domainMin)!==void 0,(e==null?void 0:e.domainMax)!==void 0]):b?A=!0:(b=[c,l],u&&(b=[0,l]),A=!1),_.domain=b,_.domainSpecified=A;let S=P((y==null?void 0:y.range)||null),I=(y==null?void 0:y.range)!==void 0;o&&!I&&(S=b.map(L=>L*o),I=!0);let x=y==null?void 0:y.rangeMin,C=y==null?void 0:y.rangeMax;if(!I&&a)S=[x!==void 0?x:m,C!==void 0?C:d];else if(!I&&!a){let L=Zo[t]||Zo[f];S=[Vr(x,L[0],m),Vr(C,L[1],d)]}(t===on||f===on)&&!I&&b.length==3&&S.splice(1,0,0),(t===Zt||f===Zt)&&!S.every(L=>ot(L)==="Number")&&(S=S.map(da)),S=S.map(L=>L<g?(console.warn(`The range value of ${L} is less than the possible ${t} value ${g}. The scale is capped to the minimum possible value.`),g):L>p?(console.warn(`The range value of ${L} is greater than the possible ${t} value ${p}. The scale is capped to the maximum possible value.`),p):L),(b[0]<b[1]&&s===lc||b[0]>b[1]&&s===uc)&&(S=S.reverse()),_.range=S,!((_t=e==null?void 0:e.scale)!=null&&_t.domain)&&b.length==2&&I&&b.length<S.length&&(console.warn("The domain is not provided while the range is provided. Erie fixed domain to match with the range. This fix is linear, so if you are using other scale types, make sure to provide the specific domain cuts."),b=S.map((L,Kt)=>Kt==0?c:Kt==S.length-1?l:c+(l-c)*(Kt/(S.length-1))));let T,N=y==null?void 0:y.type;if(N===Gv){(y==null?void 0:y.base)==0&&console.warn("The log base can't be 0. It is converted to 10.");let L=(y==null?void 0:y.base)||10;T=Am().base(L)}else if(N===Kv){let L=(y==null?void 0:y.constant)||1;T=Cm().constant(L)}else if(N===Hv)T=NS();else if(N===Yv){let L=(y==null?void 0:y.exponent)!==void 0?y.exponent:2;T=Ic().exponent(L)}else T=Sc();return _.scaleType=N||"linear",T=T.domain(b),h&&(T=T.nice()),T=T.range(S),T.properties=_,window["scale_"+t]=T,T}function YN(t,e,n,r){let s,a={channel:t};if(e.format){let o=Hr(e.format);o?s=u=>o(u):s=u=>fp(u)}else s=o=>fp(o);return s.properties=a,s}function fp(t){return t??"null"}function P1(t,e,n,r){var u;let s=e.value,a=P(e.condition||[]),o={channel:t};if(a){let l=[];a.constructor.name==="Object"?l.push(a):l.push(...a),l=l.filter(f=>f.test!==void 0);let c=[];o.conditions=[];for(const f of l){let d;if(f.test!==void 0){let m=f.test;d={},(m==null?void 0:m.constructor.name)==="Array"?d.test=p=>m.includes(p):((u=m==null?void 0:m.not)==null?void 0:u.constructor.name)==="Array"?d.test=p=>!m.not.includes(p):d.test=c_(m)}d!==void 0&&(d.value=f.value,c.push(d)),o.conditions.push([test,f.value])}let h=f=>{let d;for(const m of c)d=m.test(f)?m.value:d;return d===void 0&&(d=s),d};return h.properties=o,h}else{let l=c=>s;return l.properties=o,l}}function V1(t,e,n,r){var k,R,D,X,ft,Dt,Pt,Q,_t;let{polarity:s,maxDistinct:a,times:o,zero:u,domainMax:l,domainMin:c,nice:h}=r,f=(k=tu[t])==null?void 0:k.type;const d=((R=Ye[t])==null?void 0:R.max)||((D=Ye[f])==null?void 0:D.max),m=((X=Ye[t])==null?void 0:X.min)||((ft=Ye[f])==null?void 0:ft.min),p=((Dt=ie[t])==null?void 0:Dt.max)||((Pt=ie[f])==null?void 0:Pt.max),g=((Q=ie[t])==null?void 0:Q.min)||((_t=ie[f])==null?void 0:_t.min);let y=e==null?void 0:e.scale,_={channel:t,polarity:s};if(t===ue||f===ue){console.error("Timber channel can't be scaled for a temporal encoding.");return}if(e!=null&&e.timeUnit){let L=Zh(t,{domain:QN(y==null?void 0:y.domain,e==null?void 0:e.timeUnit,e==null?void 0:e.dayName),range:y.range,polarity:s,maxDistinct:a,nice:h},n,r),Kt=KN(e==null?void 0:e.timeUnit,e==null?void 0:e.dayName);Object.assign(_,L.properties),_.timeUnit=e==null?void 0:e.timeUnit,_.dayName=P(e==null?void 0:e.dayName);let yn=Pe=>L(Kt(Pe));return yn.properties=_,yn}let b=GN(e==null?void 0:e.timeLevel);_.timeLevel=e==null?void 0:e.timeLevel;let A,S;y!=null&&y.domain&&(A=P(y==null?void 0:y.domain).map(L=>b(L))),(e==null?void 0:e.domainMin)!==void 0||(e==null?void 0:e.domainMax)!==void 0||(e==null?void 0:e.domainMid)!==void 0?(A=[b((e==null?void 0:e.domainMin)!==void 0?e==null?void 0:e.domainMin:c),b((e==null?void 0:e.domainMax)!==void 0?e==null?void 0:e.domainMax:l)],(t===on||f===on)&&(y==null?void 0:y.domainMid)!==void 0?(A.splice(1,0,b(y==null?void 0:y.domainMid)),S=[(e==null?void 0:e.domainMin)!==void 0,(e==null?void 0:e.domainMid)!==void 0,(e==null?void 0:e.domainMax)!==void 0]):S=[(e==null?void 0:e.domainMin)!==void 0,(e==null?void 0:e.domainMax)!==void 0]):A?S=!0:(A=[b(c),b(l)],S=!1),_.domain=e==null?void 0:e.domain,_.domainSpecified=S;let I=P((y==null?void 0:y.range)||null),x=(y==null?void 0:y.range)!==void 0;o&&!x&&(I=A.map(L=>L*o),x=!0);let C=y==null?void 0:y.rangeMin,T=y==null?void 0:y.rangeMax;if(!x&&a)I=[C!==void 0?C:m,T!==void 0?T:d];else if(!x&&!a){let L=Zo[t]||Zo[f];I=[Vr(C,L[0],m),Vr(T,L[1],d)]}(t===on||f===on)&&!x&&A.length==3&&I.splice(1,0,0),(t===Zt||f===Zt)&&!I.every(L=>ot(L)==="Number")&&(I=I.map(da)),I=I.map(L=>L<g?(console.warn(`The range value of ${L} is less than the possible ${t} value ${g}. The scale is capped to the minimum possible value.`),g):L>p?(console.warn(`The range value of ${L} is greater than the possible ${t} value ${p}. The scale is capped to the maximum possible value.`),p):L),x||(A[0]<A[1]&&s===lc||A[0]>A[1]&&s===uc)&&(I=I.reverse()),_.range=e==null?void 0:e.range;let N=K2().domain(A).range(I),E=L=>N(b(L));return E.properties=_,E}function GN(t){return t?t==="year"?e=>{let n=new Date(e);return new Date(n.getFullYear(),0,0,0,0,0,0)}:t==="month"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),0,0,0,0,0)}:t==="date"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)}:t==="hour"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),0,0,0)}:t==="minute"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),0,0)}:t==="second"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),0)}:t==="millisecond"?e=>{let n=new Date(e);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())}:e=>new Date(e):e=>new Date(e)}function KN(t,e){return t?t==="year"?n=>new Date(n).getFullYear():t==="month"?(e=e||"number",e=="number"?e=Et.monthNumber:e=="number1"?e=Et.monthNumber1:e=="short"?e=Et.monthShort:e=="long"&&(e=Et.month),n=>e[new Date(n).getMonth()]):t==="day"?(e=e||Et.dayLong,e=="number"?e=Et.dayNumber:e=="number1"?e=Et.dayNumber1:e=="numberFromMon"?e=Et.dayNumberFromMon:e=="numberFromMon1"?e=Et.dayNumberFromMon1:e=="short"&&(e=Et.dayShort),n=>e[new Date(n).getDay()]):t==="date"?n=>new Date(n).getDate():t==="hour"?n=>new Date(n).getHours():t==="hour12"?n=>new Date(n).getHours()%12:t==="minute"?n=>new Date(n).getMinutes():t==="second"?n=>new Date(n).getSeconds():t==="millisecond"?n=>new Date(n).getMilliseconds():n=>new Date(n):n=>new Date(n)}function QN(t,e,n){if(e==="year")return[new Date(t[0]).getDay(),new Date(t[1]).getDay()];if(e==="month")return n=n||"number",n=="number"?n=Et.monthNumber:n=="number1"?n=Et.monthNumber1:n=="short"?n=Et.monthShort:n=="long"&&(n=Et.month),n;if(e==="day")return n=n||Et.dayLong,n=="number"?n=Et.dayNumber:n=="number1"?n=Et.dayNumber1:n=="numberFromMon"?n=Et.dayNumberFromMon:n=="numberFromMon1"?n=Et.dayNumberFromMon1:n=="short"&&(n=Et.dayShort),n;if(e==="date")return Et.date;if(e==="hour")return Et.hour;if(e==="hour12")return Et.hour;if(e==="minute")return Et.minute;if(e==="second")return Et.second;if(e==="millisecond")return Et.millisecond}const Et={monthNumber:[0,1,2,3,4,5,6,7,8,9,10],monthNumber1:[1,2,3,4,5,6,7,8,9,10,11,12],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthLong:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNumber:[0,1,2,3,4,5,6],dayNumber1:[1,2,3,4,5,6,7],dayNumberFromMon:[6,0,1,2,3,4,5],dayNumberFromMon1:[7,1,2,3,4,5,6],dayLong:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"],date:yr(0,31,!0),hour:yr(0,24,!1),hour12:yr(0,12,!1),minute:yr(0,60,!1),second:yr(0,60,!1),millisecond:yr(0,100,!1)};function JN(t,e,n,r,s,a){var p,g;let o=P(e),u=o==null?void 0:o.scale;o.type===Ur&&!u.timing&&(u.timing=Us);let l=u.timing===Us,c=u.timing===pl,h=(u==null?void 0:u.band)||Vv,f=(u==null?void 0:u.length)||5;a!=null&&a.converter&&(h=a.converter((u==null?void 0:u.band)||1),f=a.converter(f)),((p=o==null?void 0:o.scale)==null?void 0:p.range)===void 0&&(u==null?void 0:u.band)!==void 0?o.scale.range=[0,f-h]:((g=o==null?void 0:o.scale)==null?void 0:g.range)===void 0&&(o.scale.range=[0,f]);let d;l?(d=y=>"after_previous",d.properties={channel:t,timing:Us}):c?(d=y=>0,d.properties={channel:t,timing:pl}):(s==null?void 0:s.encodingType)===rr?d=L1(at,o,n,r):(s==null?void 0:s.encodingType)===os?d=V1(at,o,n,r):(s==null?void 0:s.encodingType)===as?d=Zh(at,o,n,r):(s==null?void 0:s.encodingType)===Ur?d=R1(at,o,n,r):(s==null?void 0:s.encodingType)===Mi&&(d=P1(at,o)),d||console.error("Wrong scale definition for the time channel",u);let m=(y,_)=>_!==void 0?{start:a!=null&&a.roundStart?a==null?void 0:a.roundStart(d(y)):d(y),end:a!=null&&a.roundDuration?a==null?void 0:a.roundDuration(d(_)):d(_)}:{start:a!=null&&a.roundStart?a==null?void 0:a.roundStart(d(y)):d(y),duration:a!=null&&a.roundDuration?a==null?void 0:a.roundDuration(h):h};return m.properties=d.properties,m.properties.length=f,m}function XN(t,e,n,r,s){let a={channel:t},o={},u=e.scale.range.field,l=e.field[0];for(const h of s){let f=h[u];t===Zt&&ot(f)!=="Number"&&(f=da(f)),o[h[l]]=f}a.rangeProvided=!0,a.domain=Object.keys(o),a.range=Object.values(o);let c=h=>o[h];return c.properties=a,c}function ZN(t,e,n,r,s){var y,_,b,A,S,I,x,C,T,N,E,k,R,D,X,ft,Dt,Pt;let a=((y=e.scale)==null?void 0:y.polarity)||uc,o=(_=e.scale)==null?void 0:_.maxDistinct;o===void 0&&(o=!0);let u=e.id,l=(b=e.scale)==null?void 0:b.times,c=((A=e.scale)==null?void 0:A.zero)!==void 0?(S=e.scale)==null?void 0:S.zero:!1,h,f;if(ot(t)!=="Array"&&n){let Q=n.toSorted(qs);h=Q[Q.length-1],f=Q[0]}else if(n){let Q=n[0].concat(n[1]).toSorted(qs);h=Q[Q.length-1],f=Q[0]}let d=(I=e.scale)==null?void 0:I.nice,m={polarity:a,maxDistinct:o,times:l,zero:c,domainMax:h,domainMin:f,nice:d},p,g=tE(t,e,n);if(g.fieldRange?p=XN(t,e,n,m,s):g.isTime?p=JN(t,e,n,m,g,r):g.isSpeech?p=YN(t,e):g.encodingType===rr?p=L1(t,e,n,m):g.encodingType===os?p=V1(t,e,n,m):g.encodingType===as?p=Zh(t,e,n,m):g.encodingType===Ur?p=R1(t,e,n,m):g.encodingType===Mi&&(p=P1(t,e)),p){let Q;if(t===Zt&&e.roundToNote)Q=_t=>K1(p(_t));else if(Bp.includes(t)){let _t={rate:((x=e.scale)==null?void 0:x.pauseRate)!==void 0?(C=e.scale)==null?void 0:C.pauseRate:ml};if((T=e.scale)!=null&&T.pauseLength&&(_t={length:(N=e.scale)==null?void 0:N.pauseLength}),t===De)Q=L=>{var Kt;return{value:p(L),tapLength:(Kt=e.scale)==null?void 0:Kt.band,pause:_t,beat:r}};else if(t===Fe){let L=n.map(yi=>p(yi)),Kt=((E=e.scale)==null?void 0:E.band)||(r?Pp:Lp),yn=ge(Math.max(...L)*Kt,0),Pe=Kt/(yn+(yn-1)*(_t.rate!==void 0?_t.rate:ml)),Wi=((k=e.scale)==null?void 0:k.maxTappingLength)!==void 0?(R=e.scale)==null?void 0:R.maxTappingLength:r?yl:Qv;Pe>Wi&&(Pe=Wi),Pe=ge(Pe,-2),Q=yi=>{var Hi,Yi;return{value:p(yi),tapDuration:(Hi=e.scale)==null?void 0:Hi.band,tappingUnit:Pe,singleTappingPosition:((Yi=e.scale)==null?void 0:Yi.singleTappingPosition)||Vp,beat:r}}}}else t===hr&&r?Q=_t=>r.converter(p(_t)):Q=p;return Q.properties?Object.assign(Q.properties,g):p.properties&&(Q.properties={},Object.assign(Q.properties,p.properties),Object.assign(Q.properties,g)),(D=e.scale)!=null&&D.description||((X=e.scale)==null?void 0:X.description)===void 0?Q.properties.descriptionDetail=(ft=e.scale)==null?void 0:ft.description:Q.properties.descriptionDetail=null,(Dt=e.scale)!=null&&Dt.title?Q.properties.title=(Pt=e.scale)==null?void 0:Pt.title:Q.properties.title=Xs(ln(Q.properties.field),", ",!1),e.format&&(Q.properties.format=e.format),e.formatType?Q.properties.formatType=e.formatType:e.format&&(Q.properties.formatType="number"),u&&(Q.scaleId=u),Q}else return console.error(`The encoding definition for ${t} channel is illegal:`,e),null}function tE(t,e,n){var h,f;let r=sf.includes(t)||sf.includes(t[0]),s=Wv.includes(t),a=e.type;a||(e.value?a=Mi:a=vl(n));let o=e.original_field||e.field,u=e.binned,l=e.aggregate,c=((f=(h=e.scale)==null?void 0:h.range)==null?void 0:f.field)||null;return{isTime:r,isSpeech:s,encodingType:a,field:o,binned:u,aggregate:l,fieldRange:c}}function eE(t){return e=>e*60/t}function dp(t,e){return n=>{if(n.constructor.name!=="Number")return n;let r=n/t*60;return Math.round(r/e)*e}}function pp(t,e,n){var o,u;let r=(n==null?void 0:n.sequenceScaleConsistency)||{},s=(n==null?void 0:n.forceSequenceScaleConsistency)||{},a=[];for(const l of e)if(l.stream)Object.keys(l.stream.encoding).forEach(c=>{let h;r[c]&&!s[c]?h=_r(t,l.stream.encoding[c],!1,!s[c]):s[c]&&(h=_r(t,l.stream.encoding[c],!1,s[c])),h&&h.id!==l.stream.encoding[c].scale.id&&(h.field.push(l.stream.encoding[c].field),a.push(l.stream.encoding[c].scale.id),Object.keys(l.stream.encoding[c].scale).forEach(f=>{h.scale[f]||(h.scale[f]=l.stream.encoding[c].scale[f])}),l.stream.encoding[c].scale.id=h.id)});else if(l.overlay)for(const c of l.overlay){let h=((o=l==null?void 0:l.config)==null?void 0:o.overlayScaleConsistency)||(n==null?void 0:n.overlayScaleConsistency)||{},f=((u=l==null?void 0:l.config)==null?void 0:u.forceOverlayScaleConsistency)||(n==null?void 0:n.forceOverlayScaleConsistency)||{};Object.keys(c.encoding).forEach(d=>{let m;r[d]&&!s[d]?m=_r(t,c.encoding[d],!0,!s[d]):s[d]?m=_r(t,c.encoding[d],!0,s[d]):h[d]&&!f[d]?m=_r(t,c.encoding[d],!1,!f[d]):f[d]&&(m=_r(t,c.encoding[d],!1,f[d])),m&&m.id!==c.encoding[d].scale.id&&(m.field.push(c.encoding[d].field),a.push(c.encoding[d].scale.id),Object.keys(c.encoding[d].scale).forEach(p=>{m.scale[p]||(m.scale[p]=c.encoding[d].scale[p])}),c.encoding[d].scale.id=m.id)})}return a}function _r(t,e,n,r){let s;for(const a of t)a.id===e.scale.id&&(s=a);for(const a of t){if(a.channel===s.channel&&a.type===s.type){if(a.channel===at&&a.scale.timing!==s.scale.timing)continue;if(r&&n){if(a.dataName===s.dataName&&a.parentID===s.parentID)return a}else if(!r&&n){if(a.parentID===s.parentID)return a}else if(r&&!n){if(a.dataName===s.dataName)return a}else return a}if(a.id===e.scale.id)return a}return null}async function mp(t,e,n){let r=t[e.data.name];if(!r||!e.encoding){console.error("No proper layer spec provided.");return}for(const s of Object.keys(e.encoding))!e.encoding[s].type&&e.encoding[s].value!==void 0?e.encoding[s].type=Mi:e.encoding[s].type||(e.encoding[s].type=vl(r.map(a=>a[e.encoding[s].field])));r=ic(r,e);for(const s of Object.keys(e.encoding))!e.encoding[s].type&&e.encoding[s].value!==void 0?e.encoding[s].type=Mi:e.encoding[s].type||(e.encoding[s].type=vl(r.map(a=>a[e.encoding[s].field])))}async function nE(t,e,n,r){let s=P(t);Object.keys(s).forEach(u=>{s[u].collected=[]});let a;if(r!=null&&r.timeUnit&&r.timeUnit.unit==="beat"){a={converter:eE(r.timeUnit.tempo||100)};let u=!0,l=!1;r.timeUnit.rounding&&(u=r.timeUnit.rounding!=="never",l=r.timeUnit.rounding==="always"),u&&(a.roundStart=dp(r.timeUnit.tempo||100,r.timeUnit.roundingBy||1)),l&&(a.roundDuration=dp(r.timeUnit.tempo||100,r.timeUnit.roundingBy||1))}for(const u of e)if(u.stream){let l=n[u.stream.data.name];l=ic(l,u.stream);let c=u.stream.encoding;for(const h of Object.keys(c)){let f=c[h].scale.id;if(s[f].data=l,c[h].field){let d=u.stream.data.name+"_"+c[h].field;s[f].collected.includes(d)||(yp(c[h],s,l),s[f].collected.push(d))}else c[h].value!==void 0&&(s[f].type=Mi,s[f].value=c[h].value);c[h].format&&(s[f].format=c[h].format),c[h].formatType&&(s[f].formatType=c[h].formatType)}}else if(u.overlay)for(const l of u.overlay){let c=n[l.data.name];c=ic(c,l);let h=l.encoding;for(const f of Object.keys(h)){let d=h[f].scale.id;if(s[d].data=c,h[f].field){let m=l.data.name+"_"+h[f].field;s[d].collected.includes(m)||(yp(h[f],s,c),s[d].collected.push(m))}else h[f].value!==void 0&&(s[d].type=Mi,s[d].value=h[f].value);h[f].format&&(s[d].format=h[f].format),h[f].formatType&&(s[d].formatType=h[f].formatType)}}let o={};for(const u of Object.keys(s)){let l=s[u],c=l.channel,h={};Object.assign(h,l),o[u]=ZN(c,h,l.values,a,l.data)}return a&&(o.__beat=a),o}function yp(t,e,n){let r=t.field,s=t.scale.id;if(e[s]){e[s].values||(e[s].values=[]);let a=[];ot(r)==="Array"?r.forEach(o=>{a.push(...n.map((u,l)=>u[o]))}):a.push(...n.map((o,u)=>o[r])),e[s].type===os&&(a=a.map(o=>new Date(o))),e[s].values.push(...a)}}let gp=!1;async function iE(t,e){var g;let{normalized:n,datasets:r,tick:s,scaleDefinitions:a,sequenceConfig:o,synths:u,samplings:l,waves:c}=await Lm(t),h={},f=[];for(const y of n)if(y.stream){await cp(y.stream.data,h,r);let _=[];Object.keys(y.stream.encoding).forEach(b=>{y.stream.encoding[b].type||_.push(b)}),_.length>0&&await mp(h,y.stream),f.push(...pp(a,n,o))}else if(y.overlay){for(const b of y.overlay){await cp(b.data,h,r);let A=[];Object.keys(b.encoding).forEach(S=>{b.encoding[S].type||A.push(S)}),A.length>0&&await mp(h,b)}let _={};Object.assign(_,o),Object.assign(_,y.config||{}),f.push(...pp(a,n,_))}let d=Tr(a,"id");for(const y of f)delete d[y];let m=await nE(d,n,h,o),p=new oI;(g=t==null?void 0:t.config)!=null&&g.recording&&p.setConfig("recording",!0),p.setSampling(Tr(l,"name")),p.setSynths(Tr(u,"name")),p.setWaves(Tr(c,"name")),t.config.sequenceScaleConsistency!==void 0&&t.config.sequenceScaleConsistency,(n==null?void 0:n.length)>1;for(const y of n)if(y.intro){let _=[y.intro.title,y.intro.description].filter(A=>A!==void 0),b=new uI(_.map(A=>({speech:A})));t.config&&Object.keys(t.config).forEach(A=>{b.setConfig(A,t.config[A])}),p.setIntroStream(b)}else if(y.stream){let _=hI(y.stream),b=P(h[y.stream.data.name]),A=await lp(y.stream,b,t.config,s,m);_?p.addStreams(A.stream):p.addStream(A.stream),t.config&&Object.keys(t.config).forEach(S=>{p.setConfig(S,t.config[S])}),y.stream.config&&Object.keys(y.stream.config).forEach(S=>{p.setConfig(S,y.stream.config[S])}),y.stream.title&&p.setTitle(y.stream.title),y.stream.description&&p.setDescription(y.stream.description)}else if(y.overlay){let _=new Zs;for(const b of y.overlay){let A=P(h[b.data.name]),S=P(t.config);Object.assign(S,b.config);let I=await lp(b,A,S,s,m);b.name&&I.stream.setName(b.name),b.title&&I.stream.setTitle(b.title),b.description&&I.stream.setDescription(b.description),_.addStream(I.stream)}_.setName(y.name),_.setTitle(y.title),_.setDescription(y.description),t.config&&Object.keys(t.config).forEach(b=>{_.setConfig(b,t.config[b])}),y.overlay.config&&Object.keys(y.overlay.config).forEach(b=>{_.setConfig(b,y.overlay.config[b])}),p.addStream(_)}return t.config&&Object.keys(t.config).forEach(y=>{p.setConfig(y,t.config[y])}),window!=null&&window.erieRecorderReady&&(gp=!0),p.setConfig("isRecorded",gp),p.setConfig("options",e),p}function rE(t){const e=iE;let n,r={description:"Mean and standard deviation of Miles_per_Gallon by Origin",data:{url:"data/cars.json"},transform:[{aggregate:[{op:"mean",field:"Miles_per_Gallon",as:"Miles_per_Gallon_mean"},{op:"stdevp",field:"Miles_per_Gallon",as:"Miles_per_Gallon_stdevp"}],groupby:["Origin"]},{calculate:"datum.Miles_per_Gallon_mean - datum.Miles_per_Gallon_stdevp",as:"Miles_per_Gallon_lower"},{calculate:"datum.Miles_per_Gallon_mean + datum.Miles_per_Gallon_stdevp",as:"Miles_per_Gallon_upper"},{fold:["Miles_per_Gallon_lower","Miles_per_Gallon_mean","Miles_per_Gallon_upper"],by:"Origin",exclude:!0,as:["measure","statistics"]}],sampling:[{name:"low",sample:{mono:"external_audio/low.mp3"}},{name:"mean",sample:{mono:"external_audio/mean.mp3"}},{name:"high",sample:{mono:"external_audio/high.mp3"}},{name:"bird",sample:{mono:"external_audio/bird.mp3"}},{name:"rain",sample:{mono:"external_audio/rain.mp3"}}],tone:{continued:!1},encoding:{time:{field:"measure",type:"nominal",scale:{band:.5,order:["Miles_per_Gallon_lower","Miles_per_Gallon_men","Miles_per_Gallon_upper"]}},pan:{field:"statistics",type:"quantitative",scale:{polarity:"positive",maxDistinct:!0,title:"value"},format:".4"},pitch:{field:"statistics",type:"quantitative",scale:{polarity:"positive",range:["C1","C7"],title:"value"},format:".4"},timbre:{field:"measure",type:"nominal",scale:{domain:["Miles_per_Gallon_lower","Miles_per_Gallon_mean","Miles_per_Gallon_upper"],range:["piano","piano","piano"]}},repeat:{field:"Origin",type:"nominal",speech:!0,scale:{description:"skip"}}},config:{speechRate:1.75,skipScaleSpeech:!0,skipDescription:!0,skipSquenceIntro:!0,skipSequenceDescription:!0}};j1(()=>{console.log("odnMout"),e(r).then(o=>{n=o,console.log(n),n.prerender(),window.audioPlayer=n}).then(()=>{s()}).catch(o=>{specError=!0,console.warn(o)});{let o=function(u){u.key=="x"&&a()};window.addEventListener("keypress",o)}});function s(){n?n.playQueue():console.warn("Audio not ready")}function a(){n==null||n.stopQueue(),_f("#timer").interrupt(),_f("#timer").style("left",0)}return[]}class wE extends z1{constructor(e){super(),q1(this,e,rE,null,$1,{})}}export{wE as component};
